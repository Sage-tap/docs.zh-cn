---
description: 了解详细信息： Visual Basic 中的 LINQ 简介
title: LINQ 介绍
ms.date: 08/28/2018
helpviewer_keywords:
- queries [LINQ in Visual Basic], about LINQ in Visual Basic queries
- query execution [LINQ in Visual Basic]
- range variables [Visual Basic]
- LINQ [Visual Basic]
- LINQ [Visual Basic], about LINQ in Visual Basic
- query expressions [LINQ in Visual Basic]
- LINQ
- deferred execution
- iteration variables [Visual Basic]
ms.assetid: 3047d86e-0d49-40e2-928b-dc02e46c7984
ms.openlocfilehash: 6dc260f7c7305dc3380cbd7c7c9f2402e000b986
ms.sourcegitcommit: 10e719780594efc781b15295e499c66f316068b8
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/14/2021
ms.locfileid: "100438796"
---
# <a name="introduction-to-linq-in-visual-basic"></a><span data-ttu-id="2080f-103">Visual Basic 中的 LINQ 简介</span><span class="sxs-lookup"><span data-stu-id="2080f-103">Introduction to LINQ in Visual Basic</span></span>

<span data-ttu-id="2080f-104">Language-Integrated 查询 (LINQ) 将查询功能添加到 Visual Basic，并在使用各种数据时提供简单而强大的功能。</span><span class="sxs-lookup"><span data-stu-id="2080f-104">Language-Integrated Query (LINQ) adds query capabilities to Visual Basic and provides simple and powerful capabilities when you work with all kinds of data.</span></span> <span data-ttu-id="2080f-105">LINQ 会引入查询作为 Visual Basic 语言的一部分，而不是将查询发送到要处理的数据库，或对要搜索的每个数据类型使用不同的查询语法。</span><span class="sxs-lookup"><span data-stu-id="2080f-105">Rather than sending a query to a database to be processed, or working with different query syntax for each type of data that you are searching, LINQ introduces queries as part of the Visual Basic language.</span></span> <span data-ttu-id="2080f-106">它使用统一语法，而不考虑数据的类型。</span><span class="sxs-lookup"><span data-stu-id="2080f-106">It uses a unified syntax regardless of the type of data.</span></span>  
  
 <span data-ttu-id="2080f-107">LINQ 使你能够从 SQL Server 数据库、XML、内存中数组和集合、ADO.NET 数据集或支持 LINQ 的任何其他远程或本地数据源查询数据。</span><span class="sxs-lookup"><span data-stu-id="2080f-107">LINQ enables you to query data from a SQL Server database, XML, in-memory arrays and collections, ADO.NET datasets, or any other remote or local data source that supports LINQ.</span></span> <span data-ttu-id="2080f-108">您可以通过常用 Visual Basic 语言元素来执行所有这些操作。</span><span class="sxs-lookup"><span data-stu-id="2080f-108">You can do all this with common Visual Basic language elements.</span></span> <span data-ttu-id="2080f-109">因为查询是用 Visual Basic 语言编写的，所以查询结果以强类型对象的形式返回。</span><span class="sxs-lookup"><span data-stu-id="2080f-109">Because your queries are written in the Visual Basic language, your query results are returned as strongly typed objects.</span></span> <span data-ttu-id="2080f-110">这些对象支持 IntelliSense，这使你能够更快地编写代码，并在编译时（而不是在运行时）捕获查询中的错误。</span><span class="sxs-lookup"><span data-stu-id="2080f-110">These objects support IntelliSense, which enables you to write code faster and catch errors in your queries at compile time instead of at run time.</span></span> <span data-ttu-id="2080f-111">可将 LINQ 查询用作其他查询的源，以便缩小结果的范围。</span><span class="sxs-lookup"><span data-stu-id="2080f-111">LINQ queries can be used as the source of additional queries to refine results.</span></span> <span data-ttu-id="2080f-112">还可将它们绑定到控件，使用户能够轻松地查看和修改查询结果。</span><span class="sxs-lookup"><span data-stu-id="2080f-112">They can also be bound to controls so that users can easily view and modify your query results.</span></span>  
  
 <span data-ttu-id="2080f-113">例如，下面的代码示例显示一个 LINQ 查询，它从集合返回一个客户列表并根据位置对其进行分组。</span><span class="sxs-lookup"><span data-stu-id="2080f-113">For example, the following code example shows a LINQ query that returns a list of customers from a collection and groups them based on their location.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#1)]  
  
## <a name="running-the-examples"></a><span data-ttu-id="2080f-114">运行示例</span><span class="sxs-lookup"><span data-stu-id="2080f-114">Running the examples</span></span>  

 <span data-ttu-id="2080f-115">若要运行简介和 [LINQ 查询](#structure-of-a-linq-query) 部分的结构中的示例，请包含以下代码，该代码将返回客户和订单的列表。</span><span class="sxs-lookup"><span data-stu-id="2080f-115">To run the examples in the introduction and in the [Structure of a LINQ Query](#structure-of-a-linq-query) section, include the following code, which returns lists of customers and orders.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#31](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#31)]  
  
## <a name="linq-providers"></a><span data-ttu-id="2080f-116">LINQ 提供程序</span><span class="sxs-lookup"><span data-stu-id="2080f-116">LINQ providers</span></span>  

 <span data-ttu-id="2080f-117">*Linq 提供程序* 将 Visual Basic LINQ 查询映射到要查询的数据源。</span><span class="sxs-lookup"><span data-stu-id="2080f-117">A *LINQ provider* maps your Visual Basic LINQ queries to the data source being queried.</span></span> <span data-ttu-id="2080f-118">编写 LINQ 查询时，该提供程序将接受该查询，并将其转换为数据源能够执行的命令。</span><span class="sxs-lookup"><span data-stu-id="2080f-118">When you write a LINQ query, the provider takes that query and translates it into commands that the data source will be able to execute.</span></span> <span data-ttu-id="2080f-119">该提供程序还将来自源的数据转换为构成查询结果的对象。</span><span class="sxs-lookup"><span data-stu-id="2080f-119">The provider also converts data from the source to the objects that make up your query result.</span></span> <span data-ttu-id="2080f-120">最后，当你将更新发送至数据源时，它又将这些对象转换为数据。</span><span class="sxs-lookup"><span data-stu-id="2080f-120">Finally, it converts objects to data when you send updates to the data source.</span></span>  
  
 <span data-ttu-id="2080f-121">Visual Basic 包括以下 LINQ 提供程序。</span><span class="sxs-lookup"><span data-stu-id="2080f-121">Visual Basic includes the following LINQ providers.</span></span>  
  
|<span data-ttu-id="2080f-122">提供程序</span><span class="sxs-lookup"><span data-stu-id="2080f-122">Provider</span></span>|<span data-ttu-id="2080f-123">描述</span><span class="sxs-lookup"><span data-stu-id="2080f-123">Description</span></span>|  
|---|---|  
|<span data-ttu-id="2080f-124">LINQ to Objects</span><span class="sxs-lookup"><span data-stu-id="2080f-124">LINQ to Objects</span></span>|<span data-ttu-id="2080f-125">通过 LINQ to Objects 提供程序，可以查询内存中集合和数组。</span><span class="sxs-lookup"><span data-stu-id="2080f-125">The LINQ to Objects provider enables you to query in-memory collections and arrays.</span></span> <span data-ttu-id="2080f-126">如果对象支持 <xref:System.Collections.IEnumerable> 或 <xref:System.Collections.Generic.IEnumerable%601> 接口，则可以通过 LINQ to Objects 提供程序对其进行查询。</span><span class="sxs-lookup"><span data-stu-id="2080f-126">If an object supports either the <xref:System.Collections.IEnumerable> or <xref:System.Collections.Generic.IEnumerable%601> interface, the LINQ to Objects provider enables you to query it.</span></span><br /><br /> <span data-ttu-id="2080f-127">可以通过导入命名空间来启用 LINQ to Objects 提供程序 <xref:System.Linq> ，默认情况下，将为所有 Visual Basic 项目导入该命名空间。</span><span class="sxs-lookup"><span data-stu-id="2080f-127">You can enable the LINQ to Objects provider by importing the <xref:System.Linq> namespace, which is imported by default for all Visual Basic projects.</span></span><br /><br /> <span data-ttu-id="2080f-128">有关 LINQ to Objects 提供程序的详细信息，请参阅 [LINQ to Objects](../../concepts/linq/linq-to-objects.md)。</span><span class="sxs-lookup"><span data-stu-id="2080f-128">For more information about the LINQ to Objects provider, see [LINQ to Objects](../../concepts/linq/linq-to-objects.md).</span></span>|  
|<span data-ttu-id="2080f-129">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="2080f-129">LINQ to SQL</span></span>|<span data-ttu-id="2080f-130">通过 LINQ to SQL 提供程序，可以查询和修改 SQL Server 数据库中的数据。</span><span class="sxs-lookup"><span data-stu-id="2080f-130">The LINQ to SQL provider enables you to query and modify data in a SQL Server database.</span></span> <span data-ttu-id="2080f-131">这样就可以轻松将应用程序的对象模型映射到数据库中的表和对象。</span><span class="sxs-lookup"><span data-stu-id="2080f-131">This makes it easy to map the object model for an application to the tables and objects in a database.</span></span><br /><br /> <span data-ttu-id="2080f-132">Visual Basic 通过包含对象关系设计器 (O/R 设计器) 来更轻松地使用 LINQ to SQL。</span><span class="sxs-lookup"><span data-stu-id="2080f-132">Visual Basic makes it easier to work with LINQ to SQL by including the Object Relational Designer (O/R Designer).</span></span> <span data-ttu-id="2080f-133">此设计器用于在应用程序中创建映射到数据库中的对象的对象模型。</span><span class="sxs-lookup"><span data-stu-id="2080f-133">This designer is used to create an object model in an application that maps to objects in a database.</span></span> <span data-ttu-id="2080f-134">O/R 设计器还提供了将存储过程和函数映射到对象的功能 <xref:System.Data.Linq.DataContext> ，该对象管理与数据库的通信并存储开放式并发检查的状态。</span><span class="sxs-lookup"><span data-stu-id="2080f-134">The O/R Designer also provides functionality to map stored procedures and functions to the <xref:System.Data.Linq.DataContext> object, which manages communication with the database and stores state for optimistic concurrency checks.</span></span><br /><br /> <span data-ttu-id="2080f-135">有关 LINQ to SQL 提供程序的详细信息，请参阅 [LINQ to SQL](../../../../framework/data/adonet/sql/linq/index.md)。</span><span class="sxs-lookup"><span data-stu-id="2080f-135">For more information about the LINQ to SQL provider, see [LINQ to SQL](../../../../framework/data/adonet/sql/linq/index.md).</span></span> <span data-ttu-id="2080f-136">有关对象关系设计器的详细信息，请参阅 [Visual Studio 中的 LINQ to SQL 工具](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2)。</span><span class="sxs-lookup"><span data-stu-id="2080f-136">For more information about the Object Relational Designer, see [LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2).</span></span>|  
|<span data-ttu-id="2080f-137">LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="2080f-137">LINQ to XML</span></span>|<span data-ttu-id="2080f-138">通过 LINQ to XML 提供程序，可以查询和修改 XML。</span><span class="sxs-lookup"><span data-stu-id="2080f-138">The LINQ to XML provider enables you to query and modify XML.</span></span> <span data-ttu-id="2080f-139">可以修改内存中 XML，也可以从文件加载 XML 以及将 XML 保存到文件。</span><span class="sxs-lookup"><span data-stu-id="2080f-139">You can modify in-memory XML, or you can load XML from and save XML to a file.</span></span><br /><br /> <span data-ttu-id="2080f-140">此外，LINQ to XML 提供程序启用 XML 文本和 XML 轴属性，使你能够直接在 Visual Basic 代码中编写 XML。</span><span class="sxs-lookup"><span data-stu-id="2080f-140">Additionally, the LINQ to XML provider enables XML literals and XML axis properties that enable you to write XML directly in your Visual Basic code.</span></span> <span data-ttu-id="2080f-141">有关详细信息，请参阅 [XML](../xml/index.md)。</span><span class="sxs-lookup"><span data-stu-id="2080f-141">For more information, see [XML](../xml/index.md).</span></span>|  
|<span data-ttu-id="2080f-142">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="2080f-142">LINQ to DataSet</span></span>|<span data-ttu-id="2080f-143">使用 LINQ to DataSet 提供程序可以查询和更新 ADO.NET 数据集中的数据。</span><span class="sxs-lookup"><span data-stu-id="2080f-143">The LINQ to DataSet provider enables you to query and update data in an ADO.NET dataset.</span></span> <span data-ttu-id="2080f-144">可以将 LINQ 的强大功能添加到使用数据集的应用程序，以便简化和扩展查询、聚合和更新数据集中数据的功能。</span><span class="sxs-lookup"><span data-stu-id="2080f-144">You can add the power of LINQ to applications that use datasets in order to simplify and extend your capabilities for querying, aggregating, and updating the data in your dataset.</span></span><br /><br /> <span data-ttu-id="2080f-145">有关详细信息，请参阅 [LINQ to DataSet](../../../../framework/data/adonet/linq-to-dataset.md)。</span><span class="sxs-lookup"><span data-stu-id="2080f-145">For more information, see [LINQ to DataSet](../../../../framework/data/adonet/linq-to-dataset.md).</span></span>|  
  
## <a name="structure-of-a-linq-query"></a><span data-ttu-id="2080f-146">LINQ 查询的结构</span><span class="sxs-lookup"><span data-stu-id="2080f-146">Structure of a LINQ query</span></span>  

 <span data-ttu-id="2080f-147">LINQ 查询（通常称为 *查询表达式*）由用于标识查询的数据源和迭代变量的查询子句组合而成。</span><span class="sxs-lookup"><span data-stu-id="2080f-147">A LINQ query, often referred to as a *query expression*, consists of a combination of query clauses that identify the data sources and iteration variables for the query.</span></span> <span data-ttu-id="2080f-148">查询表达式还可以包含排序、筛选、分组和联接的说明或要对源数据应用的计算。</span><span class="sxs-lookup"><span data-stu-id="2080f-148">A query expression can also include instructions for sorting, filtering, grouping, and joining, or calculations to apply to the source data.</span></span> <span data-ttu-id="2080f-149">查询表达式语法类似于 SQL的语法；因此，你可能发现该语法大都非常熟悉。</span><span class="sxs-lookup"><span data-stu-id="2080f-149">Query expression syntax resembles the syntax of SQL; therefore, you may find much of the syntax familiar.</span></span>  
  
 <span data-ttu-id="2080f-150">查询表达式以 `From` 子句开头。</span><span class="sxs-lookup"><span data-stu-id="2080f-150">A query expression starts with a `From` clause.</span></span> <span data-ttu-id="2080f-151">此子句标识查询的源数据和用于分别表示源数据中每个元素的变量。</span><span class="sxs-lookup"><span data-stu-id="2080f-151">This clause identifies the source data for a query and the variables that are used to refer to each element of the source data individually.</span></span> <span data-ttu-id="2080f-152">这些变量称为 " *范围变量* " 或 " *迭代变量*"。</span><span class="sxs-lookup"><span data-stu-id="2080f-152">These variables are named *range variables* or *iteration variables*.</span></span> <span data-ttu-id="2080f-153">`From` 子句是查询所必需的，但 `Aggregate` 查询除外，在该查询中 `From` 子句是可选的。</span><span class="sxs-lookup"><span data-stu-id="2080f-153">The `From` clause is required for a query, except for `Aggregate` queries, where the `From` clause is optional.</span></span> <span data-ttu-id="2080f-154">在 `From` 或 `Aggregate` 子句中标识查询的范围和源后，即可包括查询子句的任意组合来优化查询。</span><span class="sxs-lookup"><span data-stu-id="2080f-154">After the scope and source of the query are identified in the `From` or `Aggregate` clauses, you can include any combination of query clauses to refine the query.</span></span> <span data-ttu-id="2080f-155">有关查询子句的详细信息，请参阅本主题后面的 Visual Basic LINQ 查询运算符。</span><span class="sxs-lookup"><span data-stu-id="2080f-155">For details about query clauses, see Visual Basic LINQ Query Operators later in this topic.</span></span> <span data-ttu-id="2080f-156">例如，下面的查询将客户数据源集合标识为 `customers` 变量和一个名为 `cust` 的迭代变量。</span><span class="sxs-lookup"><span data-stu-id="2080f-156">For example, the following query identifies a source collection of customer data as the `customers` variable, and an iteration variable named `cust`.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#2)]  
  
 <span data-ttu-id="2080f-157">此示例本身是一个有效查询；但是，如果添加更多查询子句以优化结果，查询将变得更加强大。</span><span class="sxs-lookup"><span data-stu-id="2080f-157">This example is a valid query by itself; however, the query becomes far more powerful when you add more query clauses to refine the result.</span></span> <span data-ttu-id="2080f-158">例如，可以添加 `Where` 子句，以便按一个或多个值筛选结果。</span><span class="sxs-lookup"><span data-stu-id="2080f-158">For example, you can add a `Where` clause to filter the result by one or more values.</span></span> <span data-ttu-id="2080f-159">查询表达式都是单行代码；只能将其他查询子句附加到查询的末尾。</span><span class="sxs-lookup"><span data-stu-id="2080f-159">Query expressions are a single line of code; you can just append additional query clauses to the end of the query.</span></span> <span data-ttu-id="2080f-160">您可以通过使用下划线 () 行继续符，来分解多行文本中的查询，从而提高可读性 \_ 。</span><span class="sxs-lookup"><span data-stu-id="2080f-160">You can break up a query across multiple lines of text to improve readability by using the underscore (\_) line-continuation character.</span></span> <span data-ttu-id="2080f-161">下面的代码示例演示了包含 `Where` 子句的查询示例。</span><span class="sxs-lookup"><span data-stu-id="2080f-161">The following code example shows an example of a query that includes a `Where` clause.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#3)]  
  
 <span data-ttu-id="2080f-162">另一个功能强大的查询子句是 `Select` 子句，它能够从数据源仅返回所选字段。</span><span class="sxs-lookup"><span data-stu-id="2080f-162">Another powerful query clause is the `Select` clause, which enables you to return only selected fields from the data source.</span></span> <span data-ttu-id="2080f-163">LINQ 查询返回强类型化对象的可枚举集合。</span><span class="sxs-lookup"><span data-stu-id="2080f-163">LINQ queries return enumerable collections of strongly typed objects.</span></span> <span data-ttu-id="2080f-164">查询可以返回匿名类型或具名类型的集合。</span><span class="sxs-lookup"><span data-stu-id="2080f-164">A query can return a collection of anonymous types or named types.</span></span> <span data-ttu-id="2080f-165">可以使用 `Select` 子句从数据源仅返回单个字段。</span><span class="sxs-lookup"><span data-stu-id="2080f-165">You can use the `Select` clause to return only a single field from the data source.</span></span> <span data-ttu-id="2080f-166">执行此操作时，返回的集合类型为该单个字段的类型。</span><span class="sxs-lookup"><span data-stu-id="2080f-166">When you do this, the type of the collection returned is the type of that single field.</span></span> <span data-ttu-id="2080f-167">也可以使用 `Select` 子句从数据源返回多个字段。</span><span class="sxs-lookup"><span data-stu-id="2080f-167">You can also use the `Select` clause to return multiple fields from the data source.</span></span> <span data-ttu-id="2080f-168">执行此操作时，返回的集合类型为新的匿名类型。</span><span class="sxs-lookup"><span data-stu-id="2080f-168">When you do this, the type of the collection returned is a new anonymous type.</span></span> <span data-ttu-id="2080f-169">还可以将由查询返回的字段和指定的具名类型字段进行匹配。</span><span class="sxs-lookup"><span data-stu-id="2080f-169">You can also match the fields returned by the query to the fields of a specified named type.</span></span> <span data-ttu-id="2080f-170">下面的代码示例演示了一个查询表达式，它返回一个匿名类型的集合，该集合具有使用来自数据源中所选字段的数据填充的成员。</span><span class="sxs-lookup"><span data-stu-id="2080f-170">The following code example shows a query expression that returns a collection of anonymous types that have members populated with data from the selected fields from the data source.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#4)]  
  
 <span data-ttu-id="2080f-171">还可使用 LINQ 查询合并多个数据源组并返回单个结果。</span><span class="sxs-lookup"><span data-stu-id="2080f-171">LINQ queries can also be used to combine multiple sources of data and return a single result.</span></span> <span data-ttu-id="2080f-172">可以使用一个或多个 `From` 子句，或者使用 `Join` 或 `Group Join` 查询子句来完成此操作。</span><span class="sxs-lookup"><span data-stu-id="2080f-172">This can be done with one or more `From` clauses, or by using the `Join` or `Group Join` query clauses.</span></span> <span data-ttu-id="2080f-173">下面的代码示例演示了一个查询表达式，它合并客户和订单数据，并返回包含客户和订单数据的匿名类型的集合。</span><span class="sxs-lookup"><span data-stu-id="2080f-173">The following code example shows a query expression that combines customer and order data and returns a collection of anonymous types containing customer and order data.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#5)]  
  
 <span data-ttu-id="2080f-174">可以使用 `Group Join` 子句创建包含客户对象集合的分层查询结果。</span><span class="sxs-lookup"><span data-stu-id="2080f-174">You can use the `Group Join` clause to create a hierarchical query result that contains a collection of customer objects.</span></span> <span data-ttu-id="2080f-175">每个客户对象都具有一个包含该客户所有订单的集合的属性。</span><span class="sxs-lookup"><span data-stu-id="2080f-175">Each customer object has a property that contains a collection of all orders for that customer.</span></span> <span data-ttu-id="2080f-176">下面的代码示例演示了一个查询表达式，它将客户和订单数据合并为分层结果，并返回一个匿名类型的集合。</span><span class="sxs-lookup"><span data-stu-id="2080f-176">The following code example shows a query expression that combines customer and order data as a hierarchical result and returns a collection of anonymous types.</span></span> <span data-ttu-id="2080f-177">查询返回一个包括 `CustomerOrders` 属性的类型，该属性包含客户订单数据的集合。</span><span class="sxs-lookup"><span data-stu-id="2080f-177">The query returns a type that includes a `CustomerOrders` property that contains a collection of order data for the customer.</span></span> <span data-ttu-id="2080f-178">它还包括 `OrderTotal` 属性，该属性包含客户所有订单的总计值之和。</span><span class="sxs-lookup"><span data-stu-id="2080f-178">It also includes an `OrderTotal` property that contains the sum of the totals for all the orders for that customer.</span></span> <span data-ttu-id="2080f-179">（此查询等效于 LEFT OUTER JOIN。）</span><span class="sxs-lookup"><span data-stu-id="2080f-179">(This query is equivalent to a LEFT OUTER JOIN.)</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#6)]  
  
 <span data-ttu-id="2080f-180">还有几个其他 LINQ 查询运算符，可用它们创建功能强大的查询表达式。</span><span class="sxs-lookup"><span data-stu-id="2080f-180">There are several additional LINQ query operators that you can use to create powerful query expressions.</span></span> <span data-ttu-id="2080f-181">本主题的下一部分将讨论查询表达式中可以包括的各种查询子句。</span><span class="sxs-lookup"><span data-stu-id="2080f-181">The next section of this topic discusses the various query clauses that you can include in a query expression.</span></span> <span data-ttu-id="2080f-182">有关 Visual Basic 查询子句的详细信息，请参阅 [查询](../../../language-reference/queries/index.md)。</span><span class="sxs-lookup"><span data-stu-id="2080f-182">For details about Visual Basic query clauses, see [Queries](../../../language-reference/queries/index.md).</span></span>  
  
## <a name="visual-basic-linq-query-operators"></a><span data-ttu-id="2080f-183">Visual Basic LINQ 查询运算符</span><span class="sxs-lookup"><span data-stu-id="2080f-183">Visual Basic LINQ query operators</span></span>  

<span data-ttu-id="2080f-184">你可以调用 <xref:System.Linq> 命名空间和支持 LINQ 查询的其他命名空间中的类包括的方法，以便根据应用程序的需要创建和完善查询。</span><span class="sxs-lookup"><span data-stu-id="2080f-184">The classes in the <xref:System.Linq> namespace and the other namespaces that support LINQ queries include methods that you can call to create and refine queries based on the needs of your application.</span></span> <span data-ttu-id="2080f-185">Visual Basic 包括以下常见查询子句的关键字。</span><span class="sxs-lookup"><span data-stu-id="2080f-185">Visual Basic includes keywords for the following common query clauses.</span></span> <span data-ttu-id="2080f-186">有关 Visual Basic 查询子句的详细信息，请参阅 [查询](../../../language-reference/queries/index.md)。</span><span class="sxs-lookup"><span data-stu-id="2080f-186">For details about Visual Basic query clauses, see [Queries](../../../language-reference/queries/index.md).</span></span>

### <a name="from-clause"></a><span data-ttu-id="2080f-187">From 子句</span><span class="sxs-lookup"><span data-stu-id="2080f-187">From clause</span></span>

<span data-ttu-id="2080f-188">要开始查询，需要使用[ `From` 子句](../../../language-reference/queries/from-clause.md)或 `Aggregate` 子句。</span><span class="sxs-lookup"><span data-stu-id="2080f-188">Either a [`From` clause](../../../language-reference/queries/from-clause.md) or an `Aggregate` clause is required to begin a query.</span></span> <span data-ttu-id="2080f-189">`From` 子句可指定查询的源集合和迭代变量。</span><span class="sxs-lookup"><span data-stu-id="2080f-189">A `From` clause specifies a source collection and an iteration variable for a query.</span></span> <span data-ttu-id="2080f-190">例如：</span><span class="sxs-lookup"><span data-stu-id="2080f-190">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#7)]

### <a name="select-clause"></a><span data-ttu-id="2080f-191">Select 子句</span><span class="sxs-lookup"><span data-stu-id="2080f-191">Select clause</span></span>

<span data-ttu-id="2080f-192">可选。</span><span class="sxs-lookup"><span data-stu-id="2080f-192">Optional.</span></span> <span data-ttu-id="2080f-193">[ `Select` 子句](../../../language-reference/queries/select-clause.md)为查询声明一组迭代变量。</span><span class="sxs-lookup"><span data-stu-id="2080f-193">A [`Select` clause](../../../language-reference/queries/select-clause.md) declares a set of iteration variables for a query.</span></span> <span data-ttu-id="2080f-194">例如：</span><span class="sxs-lookup"><span data-stu-id="2080f-194">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#8)]

<span data-ttu-id="2080f-195">如果未指定 `Select` 子句，则该查询的迭代变量将由 `From` 或 `Aggregate` 子句指定的迭代变量组成。</span><span class="sxs-lookup"><span data-stu-id="2080f-195">If a `Select` clause is not specified, the iteration variables for the query consist of the iteration variables specified by the `From` or `Aggregate` clause.</span></span>

### <a name="where-clause"></a><span data-ttu-id="2080f-196">Where 子句</span><span class="sxs-lookup"><span data-stu-id="2080f-196">Where clause</span></span>

<span data-ttu-id="2080f-197">可选。</span><span class="sxs-lookup"><span data-stu-id="2080f-197">Optional.</span></span> <span data-ttu-id="2080f-198">[ `Where` 子句](../../../language-reference/queries/where-clause.md)指定查询的筛选条件。</span><span class="sxs-lookup"><span data-stu-id="2080f-198">A [`Where` clause](../../../language-reference/queries/where-clause.md) specifies a filtering condition for a query.</span></span> <span data-ttu-id="2080f-199">例如：</span><span class="sxs-lookup"><span data-stu-id="2080f-199">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#9)]

### <a name="order-by-clause"></a><span data-ttu-id="2080f-200">Order By 子句</span><span class="sxs-lookup"><span data-stu-id="2080f-200">Order By clause</span></span>

<span data-ttu-id="2080f-201">可选。</span><span class="sxs-lookup"><span data-stu-id="2080f-201">Optional.</span></span> <span data-ttu-id="2080f-202">[ `Order By` 子句](../../../language-reference/queries/order-by-clause.md)指定查询中列的排序顺序。</span><span class="sxs-lookup"><span data-stu-id="2080f-202">An [`Order By` clause](../../../language-reference/queries/order-by-clause.md) specifies the sort order for columns in a query.</span></span> <span data-ttu-id="2080f-203">例如：</span><span class="sxs-lookup"><span data-stu-id="2080f-203">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#10)]

### <a name="join-clause"></a><span data-ttu-id="2080f-204">Join 子句</span><span class="sxs-lookup"><span data-stu-id="2080f-204">Join clause</span></span>

<span data-ttu-id="2080f-205">可选。</span><span class="sxs-lookup"><span data-stu-id="2080f-205">Optional.</span></span> <span data-ttu-id="2080f-206">[ `Join` 子句](../../../language-reference/queries/join-clause.md)将两个集合组合为单个集合。</span><span class="sxs-lookup"><span data-stu-id="2080f-206">A [`Join` clause](../../../language-reference/queries/join-clause.md) combines two collections into a single collection.</span></span> <span data-ttu-id="2080f-207">例如：</span><span class="sxs-lookup"><span data-stu-id="2080f-207">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#11](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#11)]

### <a name="group-by-clause"></a><span data-ttu-id="2080f-208">Group By 子句</span><span class="sxs-lookup"><span data-stu-id="2080f-208">Group By clause</span></span>

<span data-ttu-id="2080f-209">可选。</span><span class="sxs-lookup"><span data-stu-id="2080f-209">Optional.</span></span> <span data-ttu-id="2080f-210">[ `Group By` 子句](../../../language-reference/queries/group-by-clause.md)对查询结果的元素进行分组。</span><span class="sxs-lookup"><span data-stu-id="2080f-210">A [`Group By` clause](../../../language-reference/queries/group-by-clause.md) groups the elements of a query result.</span></span> <span data-ttu-id="2080f-211">它可用于将聚合函数应用于每个组。</span><span class="sxs-lookup"><span data-stu-id="2080f-211">It can be used to apply aggregate functions to each group.</span></span> <span data-ttu-id="2080f-212">例如：</span><span class="sxs-lookup"><span data-stu-id="2080f-212">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#12](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#12)]

### <a name="group-join-clause"></a><span data-ttu-id="2080f-213">Group Join 子句</span><span class="sxs-lookup"><span data-stu-id="2080f-213">Group Join clause</span></span>

<span data-ttu-id="2080f-214">可选。</span><span class="sxs-lookup"><span data-stu-id="2080f-214">Optional.</span></span> <span data-ttu-id="2080f-215">[ `Group Join` 子句](../../../language-reference/queries/group-join-clause.md)将两个集合组合为单个分层集合。</span><span class="sxs-lookup"><span data-stu-id="2080f-215">A [`Group Join` clause](../../../language-reference/queries/group-join-clause.md) combines two collections into a single hierarchical collection.</span></span> <span data-ttu-id="2080f-216">例如：</span><span class="sxs-lookup"><span data-stu-id="2080f-216">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#13)]

### <a name="aggregate-clause"></a><span data-ttu-id="2080f-217">Aggregate 子句</span><span class="sxs-lookup"><span data-stu-id="2080f-217">Aggregate clause</span></span>

<span data-ttu-id="2080f-218">要开始查询，需要使用[ `Aggregate` 子句](../../../language-reference/queries/aggregate-clause.md)或 `From` 子句。</span><span class="sxs-lookup"><span data-stu-id="2080f-218">Either an [`Aggregate` clause](../../../language-reference/queries/aggregate-clause.md) or a `From` clause is required to begin a query.</span></span> <span data-ttu-id="2080f-219">`Aggregate` 子句向集合应用一个或多个聚合函数。</span><span class="sxs-lookup"><span data-stu-id="2080f-219">An `Aggregate` clause applies one or more aggregate functions to a collection.</span></span> <span data-ttu-id="2080f-220">例如，可以使用 `Aggregate` 子句来计算查询返回的所有元素的总和，如以下示例中所示。</span><span class="sxs-lookup"><span data-stu-id="2080f-220">For example, you can use the `Aggregate` clause to calculate a sum for all the elements returned by a query, as the following example does.</span></span>

 [!code-vb[VbVbalrIntroToLINQ#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#14)]

<span data-ttu-id="2080f-221">还可以使用 `Aggregate` 子句来修改查询。</span><span class="sxs-lookup"><span data-stu-id="2080f-221">You can also use the `Aggregate` clause to modify a query.</span></span> <span data-ttu-id="2080f-222">例如，可以使用 `Aggregate` 子句，对相关查询集合执行计算。</span><span class="sxs-lookup"><span data-stu-id="2080f-222">For example, you can use the `Aggregate` clause to perform a calculation on a related query collection.</span></span> <span data-ttu-id="2080f-223">例如：</span><span class="sxs-lookup"><span data-stu-id="2080f-223">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#15)]

### <a name="let-clause"></a><span data-ttu-id="2080f-224">Let 子句</span><span class="sxs-lookup"><span data-stu-id="2080f-224">Let clause</span></span>

<span data-ttu-id="2080f-225">可选。</span><span class="sxs-lookup"><span data-stu-id="2080f-225">Optional.</span></span> <span data-ttu-id="2080f-226">[ `Let` 子句](../../../language-reference/queries/let-clause.md)计算值并将其分配给查询中的新变量。</span><span class="sxs-lookup"><span data-stu-id="2080f-226">A [`Let` clause](../../../language-reference/queries/let-clause.md) computes a value and assigns it to a new variable in the query.</span></span> <span data-ttu-id="2080f-227">例如：</span><span class="sxs-lookup"><span data-stu-id="2080f-227">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#16)]

### <a name="distinct-clause"></a><span data-ttu-id="2080f-228">Distinct 子句</span><span class="sxs-lookup"><span data-stu-id="2080f-228">Distinct clause</span></span>

<span data-ttu-id="2080f-229">可选。</span><span class="sxs-lookup"><span data-stu-id="2080f-229">Optional.</span></span> <span data-ttu-id="2080f-230">`Distinct`子句限制当前迭代变量的值，以在查询结果中消除重复值。</span><span class="sxs-lookup"><span data-stu-id="2080f-230">A `Distinct` clause restricts the values of the current iteration variable to eliminate duplicate values in query results.</span></span> <span data-ttu-id="2080f-231">例如：</span><span class="sxs-lookup"><span data-stu-id="2080f-231">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#17](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#17)]

### <a name="skip-clause"></a><span data-ttu-id="2080f-232">Skip 子句</span><span class="sxs-lookup"><span data-stu-id="2080f-232">Skip clause</span></span>

<span data-ttu-id="2080f-233">可选。</span><span class="sxs-lookup"><span data-stu-id="2080f-233">Optional.</span></span> <span data-ttu-id="2080f-234">[ `Skip` 子句](../../../language-reference/queries/skip-clause.md)会跳过集合中指定数量的元素，然后返回剩余的元素。</span><span class="sxs-lookup"><span data-stu-id="2080f-234">A [`Skip` clause](../../../language-reference/queries/skip-clause.md) bypasses a specified number of elements in a collection and then returns the remaining elements.</span></span> <span data-ttu-id="2080f-235">例如：</span><span class="sxs-lookup"><span data-stu-id="2080f-235">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#18)]

### <a name="skip-while-clause"></a><span data-ttu-id="2080f-236">Skip While 子句</span><span class="sxs-lookup"><span data-stu-id="2080f-236">Skip While clause</span></span>

<span data-ttu-id="2080f-237">可选。</span><span class="sxs-lookup"><span data-stu-id="2080f-237">Optional.</span></span> <span data-ttu-id="2080f-238">只要指定的条件为， [ `Skip While` 子句](../../../language-reference/queries/skip-while-clause.md)就会跳过集合中的元素 `true` ，然后返回剩余的元素。</span><span class="sxs-lookup"><span data-stu-id="2080f-238">A [`Skip While` clause](../../../language-reference/queries/skip-while-clause.md) bypasses elements in a collection as long as a specified condition is `true` and then returns the remaining elements.</span></span> <span data-ttu-id="2080f-239">例如：</span><span class="sxs-lookup"><span data-stu-id="2080f-239">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#19](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#19)]

### <a name="take-clause"></a><span data-ttu-id="2080f-240">Take 子句</span><span class="sxs-lookup"><span data-stu-id="2080f-240">Take clause</span></span>

<span data-ttu-id="2080f-241">可选。</span><span class="sxs-lookup"><span data-stu-id="2080f-241">Optional.</span></span> <span data-ttu-id="2080f-242">[ `Take` 子句](../../../language-reference/queries/take-clause.md)从集合的开头返回指定数量的连续元素。</span><span class="sxs-lookup"><span data-stu-id="2080f-242">A [`Take` clause](../../../language-reference/queries/take-clause.md) returns a specified number of contiguous elements from the start of a collection.</span></span> <span data-ttu-id="2080f-243">例如：</span><span class="sxs-lookup"><span data-stu-id="2080f-243">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#20](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#20)]

### <a name="take-while-clause"></a><span data-ttu-id="2080f-244">Take While 子句</span><span class="sxs-lookup"><span data-stu-id="2080f-244">Take While clause</span></span>

<span data-ttu-id="2080f-245">可选。</span><span class="sxs-lookup"><span data-stu-id="2080f-245">Optional.</span></span> <span data-ttu-id="2080f-246">只要指定的条件为， [ `Take While` 子句](../../../language-reference/queries/take-while-clause.md)就包含集合中的元素 `true` ，并跳过剩余的元素。</span><span class="sxs-lookup"><span data-stu-id="2080f-246">A [`Take While` clause](../../../language-reference/queries/take-while-clause.md) includes elements in a collection as long as a specified condition is `true` and bypasses the remaining elements.</span></span> <span data-ttu-id="2080f-247">例如：</span><span class="sxs-lookup"><span data-stu-id="2080f-247">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#21)]
  
## <a name="use-additional-linq-query-features"></a><span data-ttu-id="2080f-248">使用其他 LINQ 查询功能</span><span class="sxs-lookup"><span data-stu-id="2080f-248">Use additional LINQ query features</span></span>  
  
<span data-ttu-id="2080f-249">可以通过调用 LINQ 提供的可枚举类型和可查询类型的成员来使用其他 LINQ 查询功能。</span><span class="sxs-lookup"><span data-stu-id="2080f-249">You can use additional LINQ query features by calling members of the enumerable and queryable types provided by LINQ.</span></span> <span data-ttu-id="2080f-250">可以通过对查询表达式的结果调用特定查询运算符来使用这些附加功能。</span><span class="sxs-lookup"><span data-stu-id="2080f-250">You can use these additional capabilities by calling a particular query operator on the result of a query expression.</span></span> <span data-ttu-id="2080f-251">例如，下面的示例使用方法将 <xref:System.Linq.Enumerable.Union%2A?displayProperty=nameWithType> 两个查询的结果合并为一个查询结果。</span><span class="sxs-lookup"><span data-stu-id="2080f-251">For example, the following example uses the <xref:System.Linq.Enumerable.Union%2A?displayProperty=nameWithType> method to combine the results of two queries into one query result.</span></span> <span data-ttu-id="2080f-252">它使用 <xref:System.Linq.Enumerable.ToList%2A?displayProperty=nameWithType> 方法，将查询结果返回为一个泛型列表。</span><span class="sxs-lookup"><span data-stu-id="2080f-252">It uses the <xref:System.Linq.Enumerable.ToList%2A?displayProperty=nameWithType> method to return the query result as a generic list.</span></span>
  
 [!code-vb[VbVbalrIntroToLINQ#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#22)]  
  
 <span data-ttu-id="2080f-253">有关其他 LINQ 功能的详细信息，请参阅 [标准查询运算符概述](../../concepts/linq/standard-query-operators-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="2080f-253">For details about additional LINQ capabilities, see [Standard Query Operators Overview](../../concepts/linq/standard-query-operators-overview.md).</span></span>  
  
## <a name="connect-to-a-database-by-using-linq-to-sql"></a><span data-ttu-id="2080f-254">使用 LINQ to SQL 连接到数据库</span><span class="sxs-lookup"><span data-stu-id="2080f-254">Connect to a database by using LINQ to SQL</span></span>  

 <span data-ttu-id="2080f-255">在 Visual Basic 中，你将通过使用 LINQ to SQL 文件来标识要访问的 SQL Server 数据库对象，例如表、视图和存储过程。</span><span class="sxs-lookup"><span data-stu-id="2080f-255">In Visual Basic, you identify the SQL Server database objects, such as tables, views, and stored procedures, that you want to access by using a LINQ to SQL file.</span></span> <span data-ttu-id="2080f-256">LINQ to SQL 文件具有 .dbml 扩展名。</span><span class="sxs-lookup"><span data-stu-id="2080f-256">A LINQ to SQL file has an extension of .dbml.</span></span>  
  
 <span data-ttu-id="2080f-257">如果与 SQL Server 数据库之间存在有效连接，则可以将 **LINQ to SQL 类** 项模板添加到项目。</span><span class="sxs-lookup"><span data-stu-id="2080f-257">When you have a valid connection to a SQL Server database, you can add a **LINQ to SQL Classes** item template to your project.</span></span> <span data-ttu-id="2080f-258">此操作将显示对象关系设计器（O/R 设计器）。</span><span class="sxs-lookup"><span data-stu-id="2080f-258">This will display the Object Relational Designer (O/R designer).</span></span> <span data-ttu-id="2080f-259">O/R 设计器使你能够将你想要在代码中访问的项从 **服务器资源管理器** / **数据库资源管理器** 拖到设计器图面上。</span><span class="sxs-lookup"><span data-stu-id="2080f-259">The O/R Designer enables you to drag the items that you want to access in your code from the **Server Explorer**/**Database Explorer** onto the designer surface.</span></span> <span data-ttu-id="2080f-260">LINQ to SQL 文件可向项目添加 <xref:System.Data.Linq.DataContext> 对象。</span><span class="sxs-lookup"><span data-stu-id="2080f-260">The LINQ to SQL file adds a <xref:System.Data.Linq.DataContext> object to your project.</span></span> <span data-ttu-id="2080f-261">此对象包括你希望访问的表和视图的属性和集合，以及希望调用的存储过程的方法。</span><span class="sxs-lookup"><span data-stu-id="2080f-261">This object includes properties and collections for the tables and views that you want access to, and methods for the stored procedures that you want to call.</span></span> <span data-ttu-id="2080f-262">保存对 LINQ to SQL (.dbml) 文件所作的更改后，即可通过引用由 O/R 设计器定义的 <xref:System.Data.Linq.DataContext> 对象，在代码中访问这些对象。</span><span class="sxs-lookup"><span data-stu-id="2080f-262">After you have saved your changes to the LINQ to SQL (.dbml) file, you can access these objects in your code by referencing the <xref:System.Data.Linq.DataContext> object that is defined by the O/R Designer.</span></span> <span data-ttu-id="2080f-263">项目的 <xref:System.Data.Linq.DataContext> 对象根据 LINQ to SQL 文件的名称进行命名。</span><span class="sxs-lookup"><span data-stu-id="2080f-263">The <xref:System.Data.Linq.DataContext> object for your project is named based on the name of your LINQ to SQL file.</span></span> <span data-ttu-id="2080f-264">例如，名为 Northwind.dbml 的 LINQ to SQL 文件将创建名为 `NorthwindDataContext` 的 <xref:System.Data.Linq.DataContext> 对象。</span><span class="sxs-lookup"><span data-stu-id="2080f-264">For example, a LINQ to SQL file that is named Northwind.dbml will create a <xref:System.Data.Linq.DataContext> object named `NorthwindDataContext`.</span></span>  
  
 <span data-ttu-id="2080f-265">有关分步说明的示例，请参阅 [如何：查询数据库](how-to-query-a-database-by-using-linq.md) 和 [如何：调用存储过程](how-to-call-a-stored-procedure-by-using-linq.md)。</span><span class="sxs-lookup"><span data-stu-id="2080f-265">For examples with step-by-step instructions, see [How to: Query a Database](how-to-query-a-database-by-using-linq.md) and [How to: Call a Stored Procedure](how-to-call-a-stored-procedure-by-using-linq.md).</span></span>  
  
## <a name="visual-basic-features-that-support-linq"></a><span data-ttu-id="2080f-266">支持 LINQ 的 Visual Basic 功能</span><span class="sxs-lookup"><span data-stu-id="2080f-266">Visual Basic features that support LINQ</span></span>  

 <span data-ttu-id="2080f-267">Visual Basic 包含了其他一些值得注意的功能，这些功能使得 LINQ 简单，并减少了执行 LINQ 查询所必须编写的代码量。</span><span class="sxs-lookup"><span data-stu-id="2080f-267">Visual Basic includes other notable features that make the use of LINQ simple and reduce the amount of code that you must write to perform LINQ queries.</span></span> <span data-ttu-id="2080f-268">这些功能包括以下这些：</span><span class="sxs-lookup"><span data-stu-id="2080f-268">These include the following:</span></span>  
  
- <span data-ttu-id="2080f-269">**匿名类型**，使您能够根据查询结果创建新类型。</span><span class="sxs-lookup"><span data-stu-id="2080f-269">**Anonymous types**, which enable you to create a new type based on a query result.</span></span>  
  
- <span data-ttu-id="2080f-270">**隐式类型化的变量**，使您能够延迟指定类型，并让编译器根据查询结果推断类型。</span><span class="sxs-lookup"><span data-stu-id="2080f-270">**Implicitly typed variables**, which enable you to defer specifying a type and let the compiler infer the type based on the query result.</span></span>  
  
- <span data-ttu-id="2080f-271">**扩展方法**，使你可以使用自己的方法扩展现有类型，而无需修改类型本身。</span><span class="sxs-lookup"><span data-stu-id="2080f-271">**Extension methods**, which enable you to extend an existing type with your own methods without modifying the type itself.</span></span>  
  
 <span data-ttu-id="2080f-272">有关详细信息，请参阅 [支持 LINQ 的 Visual Basic 功能](../../concepts/linq/features-that-support-linq.md)。</span><span class="sxs-lookup"><span data-stu-id="2080f-272">For details, see [Visual Basic Features That Support LINQ](../../concepts/linq/features-that-support-linq.md).</span></span>  
  
## <a name="deferred-and-immediate-query-execution"></a><span data-ttu-id="2080f-273">延迟和立即执行查询</span><span class="sxs-lookup"><span data-stu-id="2080f-273">Deferred and immediate query execution</span></span>

 <span data-ttu-id="2080f-274">执行查询与创建查询相互独立。</span><span class="sxs-lookup"><span data-stu-id="2080f-274">Query execution is separate from creating a query.</span></span> <span data-ttu-id="2080f-275">创建查询后，通过单独的机制触发其执行。</span><span class="sxs-lookup"><span data-stu-id="2080f-275">After a query is created, its execution is triggered by a separate mechanism.</span></span> <span data-ttu-id="2080f-276">可以在定义查询 *后立即执行查询 ()* ，或者可以存储定义，稍后 (*延迟执行*) 执行查询。</span><span class="sxs-lookup"><span data-stu-id="2080f-276">A query can be executed as soon as it is defined (*immediate execution*), or the definition can be stored and the query can be executed later (*deferred execution*).</span></span>  
  
 <span data-ttu-id="2080f-277">默认情况下，创建查询后，它本身不会立即执行。</span><span class="sxs-lookup"><span data-stu-id="2080f-277">By default, when you create a query, the query itself does not execute immediately.</span></span> <span data-ttu-id="2080f-278">而会将查询定义存储在用于引用查询结果的变量中。</span><span class="sxs-lookup"><span data-stu-id="2080f-278">Instead, the query definition is stored in the variable that is used to reference the query result.</span></span> <span data-ttu-id="2080f-279">当稍后在代码中（如在 `For…Next` 循环中）访问查询结果变量时，将执行该查询。</span><span class="sxs-lookup"><span data-stu-id="2080f-279">When the query result variable is accessed later in code, such as in a `For…Next` loop, the query is executed.</span></span> <span data-ttu-id="2080f-280">此过程称为 " *延迟执行*"。</span><span class="sxs-lookup"><span data-stu-id="2080f-280">This process is referred to as *deferred execution*.</span></span>  
  
 <span data-ttu-id="2080f-281">查询也可以在定义后执行，这称为 " *立即执行*"。</span><span class="sxs-lookup"><span data-stu-id="2080f-281">Queries can also be executed when they are defined, which is referred to as *immediate execution*.</span></span> <span data-ttu-id="2080f-282">可以通过应用需要访问查询结果中单个元素的方法来触发立即执行。</span><span class="sxs-lookup"><span data-stu-id="2080f-282">You can trigger immediate execution by applying a method that requires access to individual elements of the query result.</span></span> <span data-ttu-id="2080f-283">包括聚合函数（如 `Count`、`Sum`、`Average`、`Min` 或 `Max`）可产生此结果。</span><span class="sxs-lookup"><span data-stu-id="2080f-283">This can be the result of including an aggregate function, such as `Count`, `Sum`, `Average`, `Min`, or `Max`.</span></span> <span data-ttu-id="2080f-284">有关聚合函数的详细信息，请参阅 [Aggregate 子句](../../../language-reference/queries/aggregate-clause.md)。</span><span class="sxs-lookup"><span data-stu-id="2080f-284">For more information about aggregate functions, see [Aggregate Clause](../../../language-reference/queries/aggregate-clause.md).</span></span>  
  
 <span data-ttu-id="2080f-285">使用 `ToList` 或 `ToArray` 方法也会强制立即执行。</span><span class="sxs-lookup"><span data-stu-id="2080f-285">Using the `ToList` or `ToArray` methods will also force immediate execution.</span></span> <span data-ttu-id="2080f-286">当你希望立即执行查询并缓存查询结果时，这将很有用。</span><span class="sxs-lookup"><span data-stu-id="2080f-286">This can be useful when you want to execute the query immediately and cache the results.</span></span> <span data-ttu-id="2080f-287">有关这些方法的详细信息，请参阅 [转换数据类型](../../concepts/linq/converting-data-types.md)。</span><span class="sxs-lookup"><span data-stu-id="2080f-287">For more information about these methods, see [Converting Data Types](../../concepts/linq/converting-data-types.md).</span></span>  
  
 <span data-ttu-id="2080f-288">有关查询执行的详细信息，请参阅 [编写第一个 LINQ 查询](../../concepts/linq/writing-your-first-linq-query.md)。</span><span class="sxs-lookup"><span data-stu-id="2080f-288">For more information about query execution, see [Writing Your First LINQ Query](../../concepts/linq/writing-your-first-linq-query.md).</span></span>  
  
## <a name="xml-in-visual-basic"></a><span data-ttu-id="2080f-289">Visual Basic 中的 XML</span><span class="sxs-lookup"><span data-stu-id="2080f-289">XML in Visual Basic</span></span>  

 <span data-ttu-id="2080f-290">Visual Basic 中的 XML 功能包括 XML 文本和 XML 轴属性，这使你可以轻松地在代码中创建、访问、查询和修改 XML。</span><span class="sxs-lookup"><span data-stu-id="2080f-290">The XML features in Visual Basic include XML literals and XML axis properties, which enable you easily to create, access, query, and modify XML in your code.</span></span> <span data-ttu-id="2080f-291">XML 文本可用于在代码中直接编写 XML。</span><span class="sxs-lookup"><span data-stu-id="2080f-291">XML literals enable you to write XML directly in your code.</span></span> <span data-ttu-id="2080f-292">Visual Basic 编译器将 XML 视为第一类数据对象。</span><span class="sxs-lookup"><span data-stu-id="2080f-292">The Visual Basic compiler treats the XML as a first-class data object.</span></span>  
  
 <span data-ttu-id="2080f-293">下面的代码示例演示了如何创建 XML 元素、访问其子元素和属性，以及使用 LINQ 查询该元素的内容。</span><span class="sxs-lookup"><span data-stu-id="2080f-293">The following code example shows how to create an XML element, access its sub-elements and attributes, and query the contents of the element by using LINQ.</span></span>  
  
 [!code-vb[VbXmlSamples#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbXMLSamples/VB/XMLSamples3.vb#8)]  
  
 <span data-ttu-id="2080f-294">有关详细信息，请参阅 [XML](../xml/index.md)。</span><span class="sxs-lookup"><span data-stu-id="2080f-294">For more information, see [XML](../xml/index.md).</span></span>  
  
## <a name="related-resources"></a><span data-ttu-id="2080f-295">相关资源</span><span class="sxs-lookup"><span data-stu-id="2080f-295">Related resources</span></span>  
  
|<span data-ttu-id="2080f-296">主题</span><span class="sxs-lookup"><span data-stu-id="2080f-296">Topic</span></span>|<span data-ttu-id="2080f-297">说明</span><span class="sxs-lookup"><span data-stu-id="2080f-297">Description</span></span>|  
|---|---|  
|[<span data-ttu-id="2080f-298">XML</span><span class="sxs-lookup"><span data-stu-id="2080f-298">XML</span></span>](../xml/index.md)|<span data-ttu-id="2080f-299">介绍 Visual Basic 中可查询的 XML 功能，以及使您能够将 XML 作为 Visual Basic 代码中的第一类数据对象包括在内。</span><span class="sxs-lookup"><span data-stu-id="2080f-299">Describes the XML features in Visual Basic that can be queried and that enable you to include XML as first-class data objects in your Visual Basic code.</span></span>|  
|[<span data-ttu-id="2080f-300">查询</span><span class="sxs-lookup"><span data-stu-id="2080f-300">Queries</span></span>](../../../language-reference/queries/index.md)|<span data-ttu-id="2080f-301">提供有关 Visual Basic 中可用的查询子句的参考信息。</span><span class="sxs-lookup"><span data-stu-id="2080f-301">Provides reference information about the query clauses that are available in Visual Basic.</span></span>|  
|[<span data-ttu-id="2080f-302">LINQ（语言集成查询）</span><span class="sxs-lookup"><span data-stu-id="2080f-302">LINQ (Language-Integrated Query)</span></span>](../../concepts/linq/index.md)|<span data-ttu-id="2080f-303">包括常规信息、编程指南和 LINQ 示例。</span><span class="sxs-lookup"><span data-stu-id="2080f-303">Includes general information, programming guidance, and samples for LINQ.</span></span>|  
|[<span data-ttu-id="2080f-304">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="2080f-304">LINQ to SQL</span></span>](../../../../framework/data/adonet/sql/linq/index.md)|<span data-ttu-id="2080f-305">包括常规信息、编程指南和 LINQ to SQL 示例。</span><span class="sxs-lookup"><span data-stu-id="2080f-305">Includes general information, programming guidance, and samples for LINQ to SQL.</span></span>|  
|[<span data-ttu-id="2080f-306">LINQ to Objects</span><span class="sxs-lookup"><span data-stu-id="2080f-306">LINQ to Objects</span></span>](../../concepts/linq/linq-to-objects.md)|<span data-ttu-id="2080f-307">包括常规信息、编程指南和 LINQ to Objects 示例。</span><span class="sxs-lookup"><span data-stu-id="2080f-307">Includes general information, programming guidance, and samples for LINQ to Objects.</span></span>|  
|[<span data-ttu-id="2080f-308">LINQ to ADO.NET（门户网站页）</span><span class="sxs-lookup"><span data-stu-id="2080f-308">LINQ to ADO.NET (Portal Page)</span></span>](../../concepts/linq/linq-to-adonet-portal-page.md)|<span data-ttu-id="2080f-309">包含有关 LINQ to ADO.NET 的一般信息、编程指南和示例的链接。</span><span class="sxs-lookup"><span data-stu-id="2080f-309">Includes links to general information, programming guidance, and samples for LINQ to ADO.NET.</span></span>|  
|[<span data-ttu-id="2080f-310">LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="2080f-310">LINQ to XML</span></span>](../../../../standard/linq/linq-xml-overview.md)|<span data-ttu-id="2080f-311">包括常规信息、编程指南和 LINQ to XML 示例。</span><span class="sxs-lookup"><span data-stu-id="2080f-311">Includes general information, programming guidance, and samples for LINQ to XML.</span></span>|  
  
## <a name="how-to-and-walkthrough-topics"></a><span data-ttu-id="2080f-312">How to 和演练主题</span><span class="sxs-lookup"><span data-stu-id="2080f-312">How to and walkthrough topics</span></span>

 [<span data-ttu-id="2080f-313">如何：查询数据库</span><span class="sxs-lookup"><span data-stu-id="2080f-313">How to: Query a Database</span></span>](how-to-query-a-database-by-using-linq.md)  
  
 [<span data-ttu-id="2080f-314">如何：调用存储过程</span><span class="sxs-lookup"><span data-stu-id="2080f-314">How to: Call a Stored Procedure</span></span>](how-to-call-a-stored-procedure-by-using-linq.md)  
  
 [<span data-ttu-id="2080f-315">如何：修改数据库中的数据</span><span class="sxs-lookup"><span data-stu-id="2080f-315">How to: Modify Data in a Database</span></span>](how-to-modify-data-in-a-database-by-using-linq.md)  
  
 [<span data-ttu-id="2080f-316">如何：使用联接合并数据</span><span class="sxs-lookup"><span data-stu-id="2080f-316">How to: Combine Data with Joins</span></span>](how-to-combine-data-with-linq-by-using-joins.md)  
  
 [<span data-ttu-id="2080f-317">如何：对查询结果进行排序</span><span class="sxs-lookup"><span data-stu-id="2080f-317">How to: Sort Query Results</span></span>](how-to-sort-query-results-by-using-linq.md)  
  
 [<span data-ttu-id="2080f-318">如何：筛选查询结果</span><span class="sxs-lookup"><span data-stu-id="2080f-318">How to: Filter Query Results</span></span>](how-to-filter-query-results-by-using-linq.md)  
  
 [<span data-ttu-id="2080f-319">如何：对数据进行计数、求和与求平均值计算</span><span class="sxs-lookup"><span data-stu-id="2080f-319">How to: Count, Sum, or Average Data</span></span>](how-to-count-sum-or-average-data-by-using-linq.md)  
  
 [<span data-ttu-id="2080f-320">如何：查找查询结果中的最小值或最大值</span><span class="sxs-lookup"><span data-stu-id="2080f-320">How to: Find the Minimum or Maximum Value in a Query Result</span></span>](how-to-find-the-minimum-or-maximum-value-in-a-query-result.md)  
  
 [<span data-ttu-id="2080f-321">如何：分配存储流程来执行更新、插入和删除操作（O/R 设计器）</span><span class="sxs-lookup"><span data-stu-id="2080f-321">How to: Assign stored procedures to perform updates, inserts, and deletes (O/R Designer)</span></span>](/visualstudio/data-tools/how-to-assign-stored-procedures-to-perform-updates-inserts-and-deletes-o-r-designer)  
  
## <a name="featured-book-chapters"></a><span data-ttu-id="2080f-322">特色书籍章节</span><span class="sxs-lookup"><span data-stu-id="2080f-322">Featured book chapters</span></span>  

 <span data-ttu-id="2080f-323">第[17 章：](/previous-versions/visualstudio/visual-studio-2008/ff652502(v=orm.10))编程中的 LINQ [Visual Basic 2008](/previous-versions/visualstudio/visual-studio-2008/ff652504(v=orm.10))</span><span class="sxs-lookup"><span data-stu-id="2080f-323">[Chapter 17: LINQ](/previous-versions/visualstudio/visual-studio-2008/ff652502(v=orm.10)) in [Programming Visual Basic 2008](/previous-versions/visualstudio/visual-studio-2008/ff652504(v=orm.10))</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2080f-324">请参阅</span><span class="sxs-lookup"><span data-stu-id="2080f-324">See also</span></span>

- [<span data-ttu-id="2080f-325">LINQ（语言集成查询）</span><span class="sxs-lookup"><span data-stu-id="2080f-325">LINQ (Language-Integrated Query)</span></span>](../../concepts/linq/index.md)
- [<span data-ttu-id="2080f-326">Visual Basic 中的 LINQ to XML 概述</span><span class="sxs-lookup"><span data-stu-id="2080f-326">Overview of LINQ to XML in Visual Basic</span></span>](../xml/overview-of-linq-to-xml.md)
- [<span data-ttu-id="2080f-327">LINQ to DataSet 概述</span><span class="sxs-lookup"><span data-stu-id="2080f-327">LINQ to DataSet Overview</span></span>](../../../../framework/data/adonet/linq-to-dataset-overview.md)
- [<span data-ttu-id="2080f-328">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="2080f-328">LINQ to SQL</span></span>](../../../../framework/data/adonet/sql/linq/index.md)
- [<span data-ttu-id="2080f-329">Visual Studio 中的 LINQ to SQL 工具</span><span class="sxs-lookup"><span data-stu-id="2080f-329">LINQ to SQL Tools in Visual Studio</span></span>](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2)
- [<span data-ttu-id="2080f-330">DataContext 方法（O/R 设计器）</span><span class="sxs-lookup"><span data-stu-id="2080f-330">DataContext Methods (O/R Designer)</span></span>](/visualstudio/data-tools/datacontext-methods-o-r-designer)

---
description: '了解详细信息：更新数据服务 (WCF Data Services) '
title: 更新数据服务（WCF 数据服务）
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, changing data
- WCF Data Services, client library
ms.assetid: 00d993be-ffed-4dea-baf7-6eea982cdb54
ms.openlocfilehash: 3223207b310c28d8e586a537b5c76b7e1b7ca17c
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/06/2021
ms.locfileid: "99764887"
---
# <a name="updating-the-data-service-wcf-data-services"></a><span data-ttu-id="c6ad2-103">更新数据服务（WCF 数据服务）</span><span class="sxs-lookup"><span data-stu-id="c6ad2-103">Updating the Data Service (WCF Data Services)</span></span>

[!INCLUDE [wcf-deprecated](~/includes/wcf-deprecated.md)]

<span data-ttu-id="c6ad2-104">当你使用 WCF Data Services 的客户端库来使用 Open Data Protocol (OData) 源时，库会将源中的条目转换为客户端数据服务类的实例。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-104">When you use the WCF Data Services client library to consume an Open Data Protocol (OData) feed, the library translates the entries in the feed into instances of client data service classes.</span></span> <span data-ttu-id="c6ad2-105">通过使用 <xref:System.Data.Services.Client.DataServiceContext> 所属的 <xref:System.Data.Services.Client.DataServiceQuery%601> 跟踪这些数据服务类。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-105">These data service classes are tracked by using the <xref:System.Data.Services.Client.DataServiceContext> to which the <xref:System.Data.Services.Client.DataServiceQuery%601> belongs.</span></span> <span data-ttu-id="c6ad2-106">客户端通过使用 <xref:System.Data.Services.Client.DataServiceContext> 上的方法跟踪您报告的实体更改。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-106">The client tracks changes to entities that you report by using methods on <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="c6ad2-107">客户端利用这些方法可跟踪已添加和删除的实体以及您对属性值或对实体实例之间关系的更改。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-107">These methods enable the client to track added and deleted entities and also changes that you make to property values or to relationships between entity instances.</span></span> <span data-ttu-id="c6ad2-108">调用 <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> 方法时，将以基于 REST 的操作的形式将这些跟踪的更改发送回数据服务。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-108">Those tracked changes are sent back to the data service as REST-based operations when you call the <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> method.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="c6ad2-109">当使用 <xref:System.Data.Services.Client.DataServiceCollection%601> 实例将数据绑定到控件时，对绑定控件中数据所做的更改自动报告给 <xref:System.Data.Services.Client.DataServiceContext>。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-109">When you use an instance of <xref:System.Data.Services.Client.DataServiceCollection%601> to bind data to controls, changes made to data in the bound control are automatically reported to the <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="c6ad2-110">有关详细信息，请参阅 [将数据绑定到控件](binding-data-to-controls-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-110">For more information, see [Binding Data to Controls](binding-data-to-controls-wcf-data-services.md).</span></span>  
  
## <a name="adding-modifying-and-changing-entities"></a><span data-ttu-id="c6ad2-111">添加、修改和更改实体</span><span class="sxs-lookup"><span data-stu-id="c6ad2-111">Adding, Modifying, and Changing Entities</span></span>  

 <span data-ttu-id="c6ad2-112">使用 Visual Studio 中的 **添加服务引用** 对话框添加对 OData 源的引用时，每个生成的客户端数据服务类都具有静态 *Create* 方法，该方法将一个参数用于每个不可为 null 的实体属性。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-112">When you use the **Add Service Reference** dialog in Visual Studio to add a reference to an OData feed, the resulting client data service classes each have a static *Create* method that takes one parameter for each non-nullable entity property.</span></span> <span data-ttu-id="c6ad2-113">可以使用此方法创建实体类型类的实例，如下面的示例所示：</span><span class="sxs-lookup"><span data-stu-id="c6ad2-113">You can use this method to create instances of entity type classes, as in the following example:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#CreateNewProduct](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#createnewproduct)]
 [!code-vb[Astoria Northwind Client#CreateNewProduct](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#createnewproduct)]  
  
 <span data-ttu-id="c6ad2-114">若要添加实体实例，请在 "添加服务引用" 对话框生成的类上调用相应的 *AddTo* 方法 <xref:System.Data.Services.Client.DataServiceContext> ，如以下示例中所示： </span><span class="sxs-lookup"><span data-stu-id="c6ad2-114">To add an entity instance, call the appropriate *AddTo* method on the <xref:System.Data.Services.Client.DataServiceContext> class generated by the **Add Service Reference** dialog box, as in the following example:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#AddProductSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#addproductspecific)]
 [!code-vb[Astoria Northwind Client#AddProductSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#addproductspecific)]  
  
 <span data-ttu-id="c6ad2-115">这会将对象添加到上下文和正确的实体集中。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-115">This adds the object to the context and into the correct entity set.</span></span> <span data-ttu-id="c6ad2-116">您还可以调用 <xref:System.Data.Services.Client.DataServiceContext.AddObject%2A>，但是必须提供实体集名称。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-116">You can also call <xref:System.Data.Services.Client.DataServiceContext.AddObject%2A>, but you must instead supply the entity set name.</span></span> <span data-ttu-id="c6ad2-117">如果添加的实体具有与其他实体的一种或多种关系，则您可以使用 <xref:System.Data.Services.Client.DataServiceContext.AddRelatedObject%2A> 方法或使用上述方法之一，还可以显式定义这些链接。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-117">If the added entity has one or more relationships to other entities, you can either use the <xref:System.Data.Services.Client.DataServiceContext.AddRelatedObject%2A> method or use one of the previous methods and also explicitly define those links.</span></span> <span data-ttu-id="c6ad2-118">这些操作将在本主题的后面部分进行讨论。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-118">These operations are discussed later in this topic.</span></span>  
  
 <span data-ttu-id="c6ad2-119">若要修改现有的实体实例，请首先查询该实体，再对其属性进行必要的更改，然后调用 <xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A> 的 <xref:System.Data.Services.Client.DataServiceContext> 方法，以向客户端库指明它需要发送该对象的更新，如下面的示例所示：</span><span class="sxs-lookup"><span data-stu-id="c6ad2-119">To modify an existing entity instance, first query for that entity, make the desired changes to its properties, and then call the <xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A> method on the <xref:System.Data.Services.Client.DataServiceContext> to indicate to the client library that it needs to send an update for that object, as shown in the following example:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#ModifyCustomerSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#modifycustomerspecific)]
 [!code-vb[Astoria Northwind Client#ModifyCustomerSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#modifycustomerspecific)]  
  
 <span data-ttu-id="c6ad2-120">若要删除实体实例，请调用 <xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A> 的 <xref:System.Data.Services.Client.DataServiceContext> 方法，如下面的示例所示：</span><span class="sxs-lookup"><span data-stu-id="c6ad2-120">To delete an entity instance, call the <xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A> method on the <xref:System.Data.Services.Client.DataServiceContext>, as shown in the following example:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#DeleteProductSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#deleteproductspecific)]
 [!code-vb[Astoria Northwind Client#DeleteProductSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#deleteproductspecific)]  
  
 <span data-ttu-id="c6ad2-121">有关详细信息，请参阅 [如何：添加、修改和删除实体](how-to-add-modify-and-delete-entities-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-121">For more information, see [How to: Add, Modify, and Delete Entities](how-to-add-modify-and-delete-entities-wcf-data-services.md).</span></span>  
  
## <a name="attaching-entities"></a><span data-ttu-id="c6ad2-122">附加实体</span><span class="sxs-lookup"><span data-stu-id="c6ad2-122">Attaching Entities</span></span>  

 <span data-ttu-id="c6ad2-123">通过客户端库，可以保存对实体所做的更新，不必先执行查询来将实体加载到 <xref:System.Data.Services.Client.DataServiceContext>。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-123">The client library enables you to save updates that you made to an entity without first executing a query to load the entity into the <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="c6ad2-124">使用 <xref:System.Data.Services.Client.DataServiceContext.AttachTo%2A> 方法将现有对象附加到 <xref:System.Data.Services.Client.DataServiceContext> 中的特定实体集。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-124">Use the <xref:System.Data.Services.Client.DataServiceContext.AttachTo%2A> method to attach an existing object to a specific entity set in the <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="c6ad2-125">然后，可以修改对象，保存对数据服务的更改。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-125">You can then modify the object and save the changes to the data service.</span></span> <span data-ttu-id="c6ad2-126">在下面的示例中，已更改的客户对象附加到上下文，然后在调用 <xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A> 之前调用 <xref:System.Data.Services.Client.EntityStates.Modified> 以便将附加的对象标记为 <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A>：</span><span class="sxs-lookup"><span data-stu-id="c6ad2-126">In the following example, a customer object that has been changed is attached to the context and then <xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A> is called to mark the attached object as <xref:System.Data.Services.Client.EntityStates.Modified> before <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> is called:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#AttachObjectSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#attachobjectspecific)]
 [!code-vb[Astoria Northwind Client#AttachObjectSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#attachobjectspecific)]  
  
 <span data-ttu-id="c6ad2-127">在附加对象时需要考虑下列注意事项：</span><span class="sxs-lookup"><span data-stu-id="c6ad2-127">The following considerations apply when attaching objects:</span></span>  
  
- <span data-ttu-id="c6ad2-128">对象以 <xref:System.Data.Services.Client.EntityStates.Unchanged> 状态附加。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-128">An object is attached in the <xref:System.Data.Services.Client.EntityStates.Unchanged> state.</span></span>  
  
- <span data-ttu-id="c6ad2-129">附加对象时，不会附加与附加的对象有关的对象。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-129">When an object is attached, objects that are related to the attached object are not also attached.</span></span>  
  
- <span data-ttu-id="c6ad2-130">如果实体已被上下文跟踪，则不能附加对象。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-130">An object cannot be attached if the entity is already being tracked by the context.</span></span>  
  
- <span data-ttu-id="c6ad2-131">当附加收到的带有 eTag 值的实体对象时，使用采用 <xref:System.Data.Services.Client.DataServiceContext.AttachTo%28System.String%2CSystem.Object%2CSystem.String%29> 参数的 `etag` 方法重载。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-131">The <xref:System.Data.Services.Client.DataServiceContext.AttachTo%28System.String%2CSystem.Object%2CSystem.String%29> method overload that takes an `etag` parameter is used when you attach an entity object that was received along with an eTag value.</span></span> <span data-ttu-id="c6ad2-132">然后，使用此 eTag 值在保存对附加对象的更改时检查并发。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-132">This eTag value is then used to check for concurrency when changes to the attached object are saved.</span></span>  
  
 <span data-ttu-id="c6ad2-133">有关详细信息，请参阅 [如何：将现有实体附加到 DataServiceContext](attach-an-existing-entity-to-dc-wcf-data.md)。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-133">For more information, see [How to: Attach an Existing Entity to the DataServiceContext](attach-an-existing-entity-to-dc-wcf-data.md).</span></span>  
  
## <a name="creating-and-modifying-relationship-links"></a><span data-ttu-id="c6ad2-134">创建并修改关系链接</span><span class="sxs-lookup"><span data-stu-id="c6ad2-134">Creating and Modifying Relationship Links</span></span>  

 <span data-ttu-id="c6ad2-135">使用 <xref:System.Data.Services.Client.DataServiceContext.AddObject%2A> 添加服务引用对话框生成的类的方法或相应的 *AddTo* 方法添加新实体时 <xref:System.Data.Services.Client.DataServiceContext> ，不会自动定义新实体和相关实体之间的任何关系。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-135">When you add a new entity by using either the <xref:System.Data.Services.Client.DataServiceContext.AddObject%2A> method or the appropriate *AddTo* method of the <xref:System.Data.Services.Client.DataServiceContext> class that the **Add Service Reference** dialog generates, any relationships between the new entity and related entities are not automatically defined.</span></span>  
  
 <span data-ttu-id="c6ad2-136">可创建和更改实体实例之间的关系，以及让客户端库在数据服务中反映这些更改。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-136">You can create and change relationships between entity instances and have the client library reflect those changes in the data service.</span></span> <span data-ttu-id="c6ad2-137">实体之间的关系在模型中定义为关联，<xref:System.Data.Services.Client.DataServiceContext> 在上下文中以链接对象的形式跟踪每个关系。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-137">Relationships between entities are defined as associations in the model, and the <xref:System.Data.Services.Client.DataServiceContext> tracks each relationship as a link object in the context.</span></span> <span data-ttu-id="c6ad2-138">WCF Data Services 在类上提供以下方法 <xref:System.Data.Services.Client.DataServiceContext> 来创建、修改和删除这些链接：</span><span class="sxs-lookup"><span data-stu-id="c6ad2-138">WCF Data Services provides the following methods on the <xref:System.Data.Services.Client.DataServiceContext> class to create, modify, and delete these links:</span></span>  
  
|<span data-ttu-id="c6ad2-139">方法</span><span class="sxs-lookup"><span data-stu-id="c6ad2-139">Method</span></span>|<span data-ttu-id="c6ad2-140">说明</span><span class="sxs-lookup"><span data-stu-id="c6ad2-140">Description</span></span>|  
|------------|-----------------|  
|<xref:System.Data.Services.Client.DataServiceContext.AddRelatedObject%2A>|<span data-ttu-id="c6ad2-141">在两个相关实体对象之间创建新的链接。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-141">Creates a new link between two related entity objects.</span></span> <span data-ttu-id="c6ad2-142">调用此方法相当于同时调用 <xref:System.Data.Services.Client.DataServiceContext.AddObject%2A> 和  <xref:System.Data.Services.Client.DataServiceContext.AddLink%2A> 以创建新对象并定义与现有对象的关系。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-142">Calling this method is equivalent to calling <xref:System.Data.Services.Client.DataServiceContext.AddObject%2A> and <xref:System.Data.Services.Client.DataServiceContext.AddLink%2A> to both create the new object and define the relationship to an existing object.</span></span>|  
|<xref:System.Data.Services.Client.DataServiceContext.AddLink%2A>|<span data-ttu-id="c6ad2-143">在两个相关实体对象之间创建新的链接。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-143">Creates a new link between two related entity objects.</span></span>|  
|<xref:System.Data.Services.Client.DataServiceContext.SetLink%2A>|<span data-ttu-id="c6ad2-144">更新两个相关实体对象之间的现有链接。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-144">Updates an existing link between two related entity objects.</span></span> <span data-ttu-id="c6ad2-145"><xref:System.Data.Services.Client.DataServiceContext.SetLink%2A> 也可用于删除具有零或一对一基数 (`0..1:1`) 和一对一 (`1:1`) 基数的链接。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-145"><xref:System.Data.Services.Client.DataServiceContext.SetLink%2A> is also used to delete links with a cardinality of zero-or-one-to-one (`0..1:1`) and one-to-one (`1:1`).</span></span> <span data-ttu-id="c6ad2-146">为此，可将相关对象设置为 `null`。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-146">You can do this by setting the related object to `null`.</span></span>|  
|<xref:System.Data.Services.Client.DataServiceContext.DeleteLink%2A>|<span data-ttu-id="c6ad2-147">将上下文跟踪的链接标记为在调用 <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> 方法时删除。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-147">Marks a link that the context is tracking for deletion when the <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> method is called.</span></span> <span data-ttu-id="c6ad2-148">如果通过先删除指向现有对象的链接、再添加指向新的相关对象的链接的方式删除相关对象或更改关系，请使用此方法。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-148">Use this method when you delete a related object or change a relationship by first deleting the link to an existing object and then adding a link to the new related object.</span></span>|  
|<xref:System.Data.Services.Client.DataServiceContext.AttachLink%2A>|<span data-ttu-id="c6ad2-149">通知两个实体对象之间的现有链接的上下文。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-149">Notifies the context of an existing link between two entity objects.</span></span> <span data-ttu-id="c6ad2-150">该上下文假设此关系已在数据服务中存在，且不尝试在您调用 <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> 方法时创建链接。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-150">The context assumes that this relationship already exists in the data service and does not try to create the link when you call the <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> method.</span></span> <span data-ttu-id="c6ad2-151">如果要将对象附加到上下文且还需要附加两者之间的链接，请使用此方法。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-151">Use this method when you attach objects to a context and need to also attach the link between the two.</span></span> <span data-ttu-id="c6ad2-152">如果要定义新关系，则应使用 <xref:System.Data.Services.Client.DataServiceContext.AddLink%2A>。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-152">If you are defining a new relationship, you should instead use <xref:System.Data.Services.Client.DataServiceContext.AddLink%2A>.</span></span>|  
|<xref:System.Data.Services.Client.DataServiceContext.DetachLink%2A>|<span data-ttu-id="c6ad2-153">停止跟踪上下文中的指定链接。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-153">Stops tracking the specified link in the context.</span></span> <span data-ttu-id="c6ad2-154">该方法用于删除一对多 (`*:*`) 关系。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-154">This method is used to delete one-to-many (`*:*`) relationships.</span></span> <span data-ttu-id="c6ad2-155">对于基数为一的关系链接，则必须使用  <xref:System.Data.Services.Client.DataServiceContext.SetLink%2A>。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-155">For relationship links with a cardinality of one, you must instead use <xref:System.Data.Services.Client.DataServiceContext.SetLink%2A>.</span></span>|  
  
 <span data-ttu-id="c6ad2-156">下面的示例演示如何使用 <xref:System.Data.Services.Client.DataServiceContext.AddRelatedObject%2A> 方法添加新的与现有 `Order_Detail` 实体相关的 `Orders`。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-156">The following example shows how to use the <xref:System.Data.Services.Client.DataServiceContext.AddRelatedObject%2A> method to add a new `Order_Detail` that is related to an existing `Orders` entity.</span></span> <span data-ttu-id="c6ad2-157">由于新的 `Order_Details` 对象现在由 <xref:System.Data.Services.Client.DataServiceContext> 跟踪，因此所添加的 `Order_Details` 对象与现有 `Products` 实体的关系将通过调用 <xref:System.Data.Services.Client.DataServiceContext.AddLink%2A> 方法进行定义：</span><span class="sxs-lookup"><span data-stu-id="c6ad2-157">Because the new `Order_Details` object is now tracked by the <xref:System.Data.Services.Client.DataServiceContext>, the relationship of the added `Order_Details` object to the existing `Products` entity is defined by calling the <xref:System.Data.Services.Client.DataServiceContext.AddLink%2A> method:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#AddOrderDetailToOrderSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#addorderdetailtoorderspecific)]
 [!code-vb[Astoria Northwind Client#AddOrderDetailToOrderSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#addorderdetailtoorderspecific)]  
  
 <span data-ttu-id="c6ad2-158"><xref:System.Data.Services.Client.DataServiceContext.AddLink%2A> 方法定义的链接必须在数据服务中创建，要在上下文中的对象中反应这些链接，还必须为对象本身设置导航属性。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-158">While the <xref:System.Data.Services.Client.DataServiceContext.AddLink%2A> method defines links that must be created in the data service, to have these links reflected in the objects that are in the context, you must also set the navigation properties on the objects themselves.</span></span> <span data-ttu-id="c6ad2-159">在上面的示例中，应当设置如下的导航属性：</span><span class="sxs-lookup"><span data-stu-id="c6ad2-159">In the previous example, you should set the navigation properties as follows:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#SetNavProps](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#setnavprops)]
 [!code-vb[Astoria Northwind Client#SetNavProps](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#setnavprops)]  
  
 <span data-ttu-id="c6ad2-160">有关详细信息，请参阅 [如何：定义实体关系](how-to-define-entity-relationships-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-160">For more information, see [How to: Define Entity Relationships](how-to-define-entity-relationships-wcf-data-services.md).</span></span>  
  
## <a name="saving-changes"></a><span data-ttu-id="c6ad2-161">保存更改</span><span class="sxs-lookup"><span data-stu-id="c6ad2-161">Saving Changes</span></span>  

 <span data-ttu-id="c6ad2-162">在 <xref:System.Data.Services.Client.DataServiceContext> 实例中对更改进行跟踪，但不会将更改立即发送到服务器。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-162">Changes are tracked in the <xref:System.Data.Services.Client.DataServiceContext> instance but not sent to the server immediately.</span></span> <span data-ttu-id="c6ad2-163">在完成对指定活动的所需更改后，调用 <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> 以将所有更改提交给数据服务。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-163">After you are finished with the required changes for a specified activity, call <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> to submit all the changes to the data service.</span></span> <span data-ttu-id="c6ad2-164">有关详细信息，请参阅 [管理数据服务上下文](managing-the-data-service-context-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-164">For more information, see [Managing the Data Service Context](managing-the-data-service-context-wcf-data-services.md).</span></span> <span data-ttu-id="c6ad2-165">还可以使用 <xref:System.Data.Services.Client.DataServiceContext.BeginSaveChanges%2A> 和 <xref:System.Data.Services.Client.DataServiceContext.EndSaveChanges%2A> 方法异步保存更改。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-165">You can also save changes asynchronously by using the <xref:System.Data.Services.Client.DataServiceContext.BeginSaveChanges%2A> and <xref:System.Data.Services.Client.DataServiceContext.EndSaveChanges%2A> methods.</span></span> <span data-ttu-id="c6ad2-166">有关详细信息，请参阅 [异步操作](asynchronous-operations-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="c6ad2-166">For more information, see [Asynchronous Operations](asynchronous-operations-wcf-data-services.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c6ad2-167">请参阅</span><span class="sxs-lookup"><span data-stu-id="c6ad2-167">See also</span></span>

- [<span data-ttu-id="c6ad2-168">WCF 数据服务客户端库</span><span class="sxs-lookup"><span data-stu-id="c6ad2-168">WCF Data Services Client Library</span></span>](wcf-data-services-client-library.md)
- [<span data-ttu-id="c6ad2-169">查询数据服务</span><span class="sxs-lookup"><span data-stu-id="c6ad2-169">Querying the Data Service</span></span>](querying-the-data-service-wcf-data-services.md)
- [<span data-ttu-id="c6ad2-170">异步操作</span><span class="sxs-lookup"><span data-stu-id="c6ad2-170">Asynchronous Operations</span></span>](asynchronous-operations-wcf-data-services.md)
- [<span data-ttu-id="c6ad2-171">批处理操作</span><span class="sxs-lookup"><span data-stu-id="c6ad2-171">Batching Operations</span></span>](batching-operations-wcf-data-services.md)
- [<span data-ttu-id="c6ad2-172">对象具体化</span><span class="sxs-lookup"><span data-stu-id="c6ad2-172">Object Materialization</span></span>](object-materialization-wcf-data-services.md)
- [<span data-ttu-id="c6ad2-173">管理数据服务上下文</span><span class="sxs-lookup"><span data-stu-id="c6ad2-173">Managing the Data Service Context</span></span>](managing-the-data-service-context-wcf-data-services.md)

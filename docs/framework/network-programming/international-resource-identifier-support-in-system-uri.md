---
description: 详细了解：System.Uri 中的国际资源标识符支持
title: System.Uri 中的国际资源标识符支持
ms.date: 03/30/2017
ms.assetid: b5e994c3-3535-4aff-8e1b-b69be22e9a22
ms.openlocfilehash: 9aa22a42f45d149b56441e113e3e6cc00512c506
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/06/2021
ms.locfileid: "99801873"
---
# <a name="international-resource-identifier-support-in-systemuri"></a><span data-ttu-id="f1291-103">System.Uri 中的国际资源标识符支持</span><span class="sxs-lookup"><span data-stu-id="f1291-103">International Resource Identifier Support in System.Uri</span></span>

<span data-ttu-id="f1291-104"><xref:System.Uri?displayProperty=nameWithType> 类在国际资源标识符 (IRI) 和国际化域名 (IDN) 的支持下已得到扩展。</span><span class="sxs-lookup"><span data-stu-id="f1291-104">The <xref:System.Uri?displayProperty=nameWithType> class has been extended with International Resource Identifier (IRI) and Internationalized Domain Names (IDN) support.</span></span> <span data-ttu-id="f1291-105">NET Framework 3.5、3.0 SP1 和 2.0 SP1 提供了这些增强功能。</span><span class="sxs-lookup"><span data-stu-id="f1291-105">These enhancements are available in .NET Framework 3.5, 3.0 SP1, and 2.0 SP1.</span></span>  
  
## <a name="iri-and-idn-support"></a><span data-ttu-id="f1291-106">IRI 和 IDN 支持</span><span class="sxs-lookup"><span data-stu-id="f1291-106">IRI and IDN Support</span></span>  

 <span data-ttu-id="f1291-107">Web 地址通常使用由一组非常有限的字符组成的统一资源标识符 (URI) 来表示：</span><span class="sxs-lookup"><span data-stu-id="f1291-107">Web addresses are typically expressed using Uniform Resource Identifiers (URI) that consist of a very restricted set of characters:</span></span>  
  
- <span data-ttu-id="f1291-108">英文字母表中的大小写 ASCII 字母。</span><span class="sxs-lookup"><span data-stu-id="f1291-108">Upper and lower case ASCII letters from the English alphabet.</span></span>  
  
- <span data-ttu-id="f1291-109">从 0 到 9 的数字。</span><span class="sxs-lookup"><span data-stu-id="f1291-109">Digits from 0 to 9.</span></span>  
  
- <span data-ttu-id="f1291-110">少量的其他 ASCII 符号。</span><span class="sxs-lookup"><span data-stu-id="f1291-110">A small number of other ASCII symbols.</span></span>  
  
 <span data-ttu-id="f1291-111">Internet 工程任务组发布 (IETF) 的 RFC 2396 和 RFC 3986 中记录了 URL 的规格。</span><span class="sxs-lookup"><span data-stu-id="f1291-111">The specifications for URIs are documented in RFC 2396 and RFC 3986 published by the Internet Engineering Task Force (IETF).</span></span>  
  
 <span data-ttu-id="f1291-112">随着 Internet 的发展，越来越需要使用英语以外的语言识别资源。</span><span class="sxs-lookup"><span data-stu-id="f1291-112">With the growth of the Internet, there is a growing need to identify resources using languages other than English.</span></span> <span data-ttu-id="f1291-113">标识符满足了这种需求，并且使得非 ASCII 字符（Unicode 中的字符/ISO 10646 字符集）被称为国际资源标识符（IRI）。</span><span class="sxs-lookup"><span data-stu-id="f1291-113">Identifiers which facilitate this need and allow non-ASCII characters (characters in the Unicode/ISO 10646 character set) are known as International Resource Identifiers (IRIs).</span></span> <span data-ttu-id="f1291-114">IETF 发布的 RFC 3987 记录了 IRI 的规格。</span><span class="sxs-lookup"><span data-stu-id="f1291-114">The specifications for IRIs are documented in RFC 3987 published by IETF.</span></span> <span data-ttu-id="f1291-115">使用 IRI 允许 URL 包含 Unicode 字符。</span><span class="sxs-lookup"><span data-stu-id="f1291-115">Using IRIs allows a URL to contain Unicode characters.</span></span>  
  
 <span data-ttu-id="f1291-116">现有的 <xref:System.Uri?displayProperty=nameWithType> 类已扩展为在 RFC 3987 基础上为 IRI 提供支持。</span><span class="sxs-lookup"><span data-stu-id="f1291-116">The existing <xref:System.Uri?displayProperty=nameWithType> class has been extended to provide IRI support based on RFC 3987.</span></span> <span data-ttu-id="f1291-117">除非当前用户专门启用 IRI，否则他们看不到任何 NET Framework 2.0 行为的改变。</span><span class="sxs-lookup"><span data-stu-id="f1291-117">Current users will not see any change from the .NET Framework 2.0 behavior unless they specifically enable IRI.</span></span> <span data-ttu-id="f1291-118">这确保了 NET Framework 以前版本的应用程序兼容性。</span><span class="sxs-lookup"><span data-stu-id="f1291-118">This ensures application compatibility with prior versions of the .NET Framework.</span></span>  
  
 <span data-ttu-id="f1291-119">应用程序可指定是否使用应用于域名的国际化域名（IDN）分析，以及是否应该应用 IRI 分析规则。</span><span class="sxs-lookup"><span data-stu-id="f1291-119">An application can specify whether to use Internationalized Domain Name (IDN) parsing applied to domain names and whether IRI parsing rules should be applied.</span></span> <span data-ttu-id="f1291-120">这可以在 machine.config 或应用配置文件中完成。</span><span class="sxs-lookup"><span data-stu-id="f1291-120">This can be done in the machine.config or in the app.config file.</span></span>  
  
 <span data-ttu-id="f1291-121">启用 IDN 可以将域名中所有 Unicode 标签转换成标签的 Punycode 等同项。</span><span class="sxs-lookup"><span data-stu-id="f1291-121">Enabling IDN will convert all Unicode labels in a domain name to their Punycode equivalents.</span></span> <span data-ttu-id="f1291-122">Punycode 名称只包含 ASCII 字符，并且始终以 xn-- 前缀开头。</span><span class="sxs-lookup"><span data-stu-id="f1291-122">Punycode names contain only ASCII characters and always start with the xn-- prefix.</span></span> <span data-ttu-id="f1291-123">这样是为了支持 Internet 上的 DNS 服务器，因为大部分 DNS 服务器仅支持 ASCII 字符（参见 RFC 3940）。</span><span class="sxs-lookup"><span data-stu-id="f1291-123">The reason for this is to support existing DNS servers on the Internet, since most DNS servers only support ASCII characters (see RFC 3940).</span></span>  
  
 <span data-ttu-id="f1291-124">启用 IRI 和 IDN 会影响 <xref:System.Uri.DnsSafeHost%2A?displayProperty=nameWithType> 属性的值。</span><span class="sxs-lookup"><span data-stu-id="f1291-124">Enabling IRI and IDN affects the value of the <xref:System.Uri.DnsSafeHost%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="f1291-125">启用 IRI 和 IDN 还可能更改 <xref:System.Uri.Equals%2A?displayProperty=nameWithType>、<xref:System.Uri.OriginalString%2A?displayProperty=nameWithType>、<xref:System.Uri.GetComponents%2A?displayProperty=nameWithType> 和 <xref:System.Uri.IsWellFormedOriginalString%2A> 方法的行为。</span><span class="sxs-lookup"><span data-stu-id="f1291-125">Enabling IRI and IDN can also change the behavior of the <xref:System.Uri.Equals%2A?displayProperty=nameWithType>, <xref:System.Uri.OriginalString%2A?displayProperty=nameWithType>, <xref:System.Uri.GetComponents%2A?displayProperty=nameWithType>, and <xref:System.Uri.IsWellFormedOriginalString%2A> methods.</span></span>  
  
 <span data-ttu-id="f1291-126"><xref:System.GenericUriParser?displayProperty=nameWithType> 类已得到扩展，允许创建支持 IRI 和 IDN 的自定义分析。</span><span class="sxs-lookup"><span data-stu-id="f1291-126">The <xref:System.GenericUriParser?displayProperty=nameWithType> class has also been extended to allow creating a customizable parser that supports IRI and IDN.</span></span> <span data-ttu-id="f1291-127">通过将枚举中可用值的按位组合传递给 <xref:System.GenericUriParserOptions?displayProperty=nameWithType> 构造函数 <xref:System.GenericUriParser?displayProperty=nameWithType> 来指定 <xref:System.GenericUriParser?displayProperty=nameWithType> 对象的行为。</span><span class="sxs-lookup"><span data-stu-id="f1291-127">The behavior of a <xref:System.GenericUriParser?displayProperty=nameWithType> object is specified by passing a bitwise combination of the values available in the <xref:System.GenericUriParserOptions?displayProperty=nameWithType> enumeration to the <xref:System.GenericUriParser?displayProperty=nameWithType> constructor.</span></span> <span data-ttu-id="f1291-128"><xref:System.GenericUriParserOptions.IriParsing?displayProperty=nameWithType> 类型表示分析程序支持 RFC 3987 中为国际资源标识符 (IRI) 指定的分析规则。</span><span class="sxs-lookup"><span data-stu-id="f1291-128">The <xref:System.GenericUriParserOptions.IriParsing?displayProperty=nameWithType> type indicates the parser supports the parsing rules specified in RFC 3987 for International Resource Identifiers (IRI).</span></span> <span data-ttu-id="f1291-129">是否实际使用 IRI 取决于是否启用 IRI。</span><span class="sxs-lookup"><span data-stu-id="f1291-129">Whether IRI is actually used depends on if IRI is enabled.</span></span>  
  
 <span data-ttu-id="f1291-130"><xref:System.GenericUriParserOptions.Idn?displayProperty=nameWithType> 类型表示分析程序支持主机名的国际化域名 (IDN) 分析。</span><span class="sxs-lookup"><span data-stu-id="f1291-130">The <xref:System.GenericUriParserOptions.Idn?displayProperty=nameWithType> type indicates the parser supports Internationalized Domain Name (IDN) parsing (IDN) of host names.</span></span> <span data-ttu-id="f1291-131">是否实际使用 IDN 取决于是否启用 IDN。</span><span class="sxs-lookup"><span data-stu-id="f1291-131">Whether IDN is actually used depends on if IDN is enabled.</span></span>  
  
 <span data-ttu-id="f1291-132">启用 IRI 分析后将根据 RFC 3987 中最后的 IRI 规则执行规范化和字符检查。</span><span class="sxs-lookup"><span data-stu-id="f1291-132">Enabling IRI parsing will do normalization and character checking according to the latest IRI rules in RFC 3987.</span></span> <span data-ttu-id="f1291-133">默认值用于禁用 IRI 分析，所以规范化和字符检查会根据 RFC 2396 和 RFC 3986 完成。</span><span class="sxs-lookup"><span data-stu-id="f1291-133">The default value is for IRI parsing to be disabled so normalization and character checking are done according to RFC 2396 and RFC 3986.</span></span>  
  
 <span data-ttu-id="f1291-134"><xref:System.Uri?displayProperty=nameWithType> 类中的 IRI 和 IDN 处理也可以通过使用 <xref:System.Configuration.IriParsingElement?displayProperty=nameWithType> 和 <xref:System.Configuration.IdnElement?displayProperty=nameWithType> 配置集类进行控制。</span><span class="sxs-lookup"><span data-stu-id="f1291-134">IRI and IDN processing in the <xref:System.Uri?displayProperty=nameWithType> class can also be controlled using the <xref:System.Configuration.IriParsingElement?displayProperty=nameWithType> and <xref:System.Configuration.IdnElement?displayProperty=nameWithType> configuration setting classes.</span></span> <span data-ttu-id="f1291-135"><xref:System.Configuration.IriParsingElement?displayProperty=nameWithType> 设置启用或禁用 <xref:System.Uri?displayProperty=nameWithType> 类中的 IRI 处理。</span><span class="sxs-lookup"><span data-stu-id="f1291-135">The <xref:System.Configuration.IriParsingElement?displayProperty=nameWithType> setting enables or disables IRI processing in the <xref:System.Uri?displayProperty=nameWithType> class.</span></span> <span data-ttu-id="f1291-136"><xref:System.Configuration.IdnElement?displayProperty=nameWithType> 设置启用或禁用 <xref:System.Uri> 类中的 IDN 处理。</span><span class="sxs-lookup"><span data-stu-id="f1291-136">The <xref:System.Configuration.IdnElement?displayProperty=nameWithType> setting enables or disables IDN processing in the <xref:System.Uri> class.</span></span> <span data-ttu-id="f1291-137"><xref:System.Configuration.IriParsingElement?displayProperty=nameWithType> 也可间接控制 IDN。</span><span class="sxs-lookup"><span data-stu-id="f1291-137">The <xref:System.Configuration.IriParsingElement?displayProperty=nameWithType> setting also indirectly controls IDN.</span></span> <span data-ttu-id="f1291-138">必须启用 IRI 处理才能进行 IDN 处理。</span><span class="sxs-lookup"><span data-stu-id="f1291-138">IRI processing must be enabled for IDN processing to be possible.</span></span> <span data-ttu-id="f1291-139">如果禁用 IRI，IDN 处理将被设置为默认值，这时 NET Framework 2.0 行为用于兼容性，并且 IDN 名称不可用。</span><span class="sxs-lookup"><span data-stu-id="f1291-139">If IRI processing is disabled, then IDN processing will be set to the default setting where the .NET Framework 2.0 behavior is used for compatibility and IDN names are not used.</span></span>  
  
 <span data-ttu-id="f1291-140">构造第一个 <xref:System.Uri?displayProperty=nameWithType> 类后，将立即读取 <xref:System.Configuration.IriParsingElement?displayProperty=nameWithType> 和 <xref:System.Configuration.IdnElement?displayProperty=nameWithType> 配置类的配置设置。</span><span class="sxs-lookup"><span data-stu-id="f1291-140">The configuration setting for the <xref:System.Configuration.IriParsingElement?displayProperty=nameWithType> and <xref:System.Configuration.IdnElement?displayProperty=nameWithType> configuration classes will be read once when the first <xref:System.Uri?displayProperty=nameWithType> class is constructed.</span></span> <span data-ttu-id="f1291-141">忽略时间后更改为默认设置。</span><span class="sxs-lookup"><span data-stu-id="f1291-141">Changes to configuration settings after that time are ignored.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f1291-142">另请参阅</span><span class="sxs-lookup"><span data-stu-id="f1291-142">See also</span></span>

- <xref:System.Configuration.IdnElement?displayProperty=nameWithType>
- <xref:System.Configuration.IriParsingElement?displayProperty=nameWithType>
- <xref:System.Uri?displayProperty=nameWithType>
- <xref:System.Uri.DnsSafeHost%2A?displayProperty=nameWithType>

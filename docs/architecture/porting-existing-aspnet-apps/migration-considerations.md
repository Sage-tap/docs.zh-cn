---
title: 迁移注意事项
description: 团队需要了解哪些内容才能正确决定是否以及如何从 ASP.NET MVC 迁移到 .NET Core？
author: ardalis
ms.date: 11/13/2020
ms.openlocfilehash: efa1efc99cbe46ef289cfd6b53ba83b3bc1b56b1
ms.sourcegitcommit: bdbf6472de867a0a11aaa5b9384a2506c24f27d2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/05/2021
ms.locfileid: "102401227"
---
# <a name="migration-considerations"></a><span data-ttu-id="9a1d7-103">迁移注意事项</span><span class="sxs-lookup"><span data-stu-id="9a1d7-103">Migration considerations</span></span>

<span data-ttu-id="9a1d7-104">在将应用程序移植到 .NET Core 时，最基本的问题团队必须解决这一问题？</span><span class="sxs-lookup"><span data-stu-id="9a1d7-104">The most fundamental question teams must answer when it comes to porting their apps to .NET Core is, should they port at all?</span></span> <span data-ttu-id="9a1d7-105">在某些情况下，最好的方法是使用 ASP.NET MVC 和/或 Web API 继续 .NET Framework。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-105">In some cases, the best path forward is to remain on .NET Framework using ASP.NET MVC and/or Web API.</span></span> <span data-ttu-id="9a1d7-106">本章介绍了迁移到 .NET Core 的原因。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-106">This chapter considers reasons why moving to .NET Core makes sense.</span></span> <span data-ttu-id="9a1d7-107">本章还考虑了方案和 counterpoints，以便保持 .NET Framework。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-107">The chapter also considers scenarios and counterpoints for staying on .NET Framework.</span></span>

## <a name="is-migration-to-net-core-appropriate"></a><span data-ttu-id="9a1d7-108">是否适合迁移到 .NET Core？</span><span class="sxs-lookup"><span data-stu-id="9a1d7-108">Is migration to .NET Core appropriate?</span></span>

<span data-ttu-id="9a1d7-109">让我们从一些可能需要迁移到 .NET Core (或 .NET 5) 的原因着手。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-109">Let's start with some of the reasons why you might want to move to .NET Core (or .NET 5).</span></span> <span data-ttu-id="9a1d7-110">还有很多内容，因此请不要将此列表详尽。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-110">There are quite a few, so don't consider this list exhaustive.</span></span>

### <a name="cross-platform-support"></a><span data-ttu-id="9a1d7-111">跨平台支持</span><span class="sxs-lookup"><span data-stu-id="9a1d7-111">Cross-platform support</span></span>

<span data-ttu-id="9a1d7-112">基于 .NET Core 构建的应用程序确实跨平台，可以在 Windows、Linux 和 macOS 上运行。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-112">Apps built on .NET Core are truly cross-platform and can run on Windows, Linux, and macOS.</span></span> <span data-ttu-id="9a1d7-113">你的开发人员不仅可以使用所需的任何硬件，还可以在任何位置托管你的应用程序。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-113">Not only can your developers use whatever hardware they want, but you can also host your app anywhere.</span></span> <span data-ttu-id="9a1d7-114">示例从本地 IIS 到云中的 Azure 或从 Linux Docker 容器到 IoT 设备的范围。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-114">Examples range from local IIS to Azure in the cloud or from Linux Docker containers to IoT devices.</span></span>

### <a name="performance-and-scalability"></a><span data-ttu-id="9a1d7-115">性能和可伸缩性</span><span class="sxs-lookup"><span data-stu-id="9a1d7-115">Performance and scalability</span></span>

<span data-ttu-id="9a1d7-116">使用 .NET Core 构建的应用程序在 [任意位置可用的最快技术堆栈](https://www.techempower.com/benchmarks/#hw=ph&test=plaintext)上运行。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-116">Apps built with .NET Core are running on [one of the fastest tech stacks available anywhere](https://www.techempower.com/benchmarks/#hw=ph&test=plaintext).</span></span> <span data-ttu-id="9a1d7-117">ASP.NET MVC 应用程序通常 ASP.NET Core 上的性能改进，特别是在更新后，才能利用 .NET Core 中提供的一些新功能。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-117">ASP.NET MVC apps often see performance improvements on ASP.NET Core, especially if they're updated to take advantage of some new features available in .NET Core.</span></span>

### <a name="cloud-native"></a><span data-ttu-id="9a1d7-118">云原生</span><span class="sxs-lookup"><span data-stu-id="9a1d7-118">Cloud-native</span></span>

<span data-ttu-id="9a1d7-119">出于上述原因和其他原因，.NET Core 应用非常适合在云托管环境中运行。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-119">For the above reasons and others, .NET Core apps are well-suited to running in cloud hosting environments.</span></span> <span data-ttu-id="9a1d7-120">轻型和 fast，可以将 .NET Core 应用部署到 Azure 应用服务或容器，并根据需要水平缩放以满足即时系统需求。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-120">Lightweight and fast, .NET Core apps can be deployed to Azure App Services or containers and scaled horizontally as needed to meet immediate system demand.</span></span>

### <a name="maintainable"></a><span data-ttu-id="9a1d7-121">容易</span><span class="sxs-lookup"><span data-stu-id="9a1d7-121">Maintainable</span></span>

<span data-ttu-id="9a1d7-122">对于许多应用程序，尽管他们一直在满足客户和业务需求，但技术债务已积累并维护应用程序的成本高昂。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-122">For many apps, while they've continued to meet customer and business needs, technical debt has accumulated and maintaining the app has grown expensive.</span></span> <span data-ttu-id="9a1d7-123">ASP.NET Core 应用比 ASP.NET MVC 应用更易于测试，使其更易于重构和扩展。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-123">ASP.NET Core apps are more easily tested than ASP.NET MVC apps, making them easier to refactor and extend with confidence.</span></span>

### <a name="modular"></a><span data-ttu-id="9a1d7-124">模块化</span><span class="sxs-lookup"><span data-stu-id="9a1d7-124">Modular</span></span>

<span data-ttu-id="9a1d7-125">ASP.NET Core 是模块化的，使用 NuGet 包作为框架的第一类部分。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-125">ASP.NET Core is modular, using NuGet packages as a first-class part of the framework.</span></span> <span data-ttu-id="9a1d7-126">为 .NET Core 构建的应用程序都支持依赖项注入，从而可以轻松地从给定环境中所需的任何实现编写解决方案。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-126">Apps built for .NET Core all support dependency injection, making it easy to compose solutions from whatever implementations are needed for a given environment.</span></span> <span data-ttu-id="9a1d7-127">利用 .NET Core 生成微服务比在 IIS 上依赖 ASP.NET MVC 更容易，后者会打开其他选项，将大型应用分解为较小的模块。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-127">Building microservices with .NET Core is easier than with ASP.NET MVC with its dependency on IIS, which opens up additional options to break up large apps into smaller modules.</span></span>

### <a name="modern"></a><span data-ttu-id="9a1d7-128">新式</span><span class="sxs-lookup"><span data-stu-id="9a1d7-128">Modern</span></span>

<span data-ttu-id="9a1d7-129">一直在一种新式、积极发展的技术堆栈上，都有一种优势。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-129">Staying on a modern, actively developed technology stack has a host of advantages.</span></span> <span data-ttu-id="9a1d7-130">新功能和 c # 语言功能将仅添加到 .NET Core。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-130">New features and C# language features will only be added to .NET Core.</span></span> <span data-ttu-id="9a1d7-131">.NET Framework 的最新发布版本4.8，并且 c # 版本以外的 c # 不是以 .NET Framework 为目标。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-131">The .NET Framework has had its last release with version 4.8, and versions of C# beyond 8 won't target .NET Framework.</span></span> <span data-ttu-id="9a1d7-132">尽管 ASP.NET MVC 将在很多年内仍受支持，但最优秀的 .NET 软件开发人员可能希望使用更先进的 .NET Core framework，它提供的所有优点 (仅) 上面的部分。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-132">While ASP.NET MVC will remain supported by Microsoft for many years, the best and brightest .NET software developers are likely looking to use the more modern .NET Core framework, with all of the advantages it offers (only some of which are summarized above).</span></span> <span data-ttu-id="9a1d7-133">查找具有维护 ASP.NET MVC 应用的技能的开发人员在某个时间点将开始成为一项挑战，因为这将查找在线培训和故障排除帮助。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-133">Finding developers with the skills to maintain an ASP.NET MVC app will start to become a challenge at some point, as will finding online training and troubleshooting assistance.</span></span> <span data-ttu-id="9a1d7-134">例如，可能不会对 ASP.NET MVC 5 撰写许多新的博客文章，而是为 .NET 5.0 编写大量的博客文章。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-134">There probably aren't that many new blog posts being written about ASP.NET MVC 5, while there are plenty being written for .NET 5.0, for example.</span></span>

<span data-ttu-id="9a1d7-135">考虑迁移到 .NET Core 有许多有说服力的原因，这可能是您阅读本书的原因！</span><span class="sxs-lookup"><span data-stu-id="9a1d7-135">There are many compelling reasons to consider migrating to .NET Core, which presumably is why you're reading this book!</span></span> <span data-ttu-id="9a1d7-136">但让我们考虑一些缺点和原因，原因可能是更有可能保持 .NET Framework。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-136">But let's consider some disadvantages and reasons why it may make more sense to remain on the .NET Framework.</span></span>

## <a name="when-is-net-framework-appropriate"></a><span data-ttu-id="9a1d7-137">何时 .NET Framework 适用的情况？</span><span class="sxs-lookup"><span data-stu-id="9a1d7-137">When is .NET Framework appropriate?</span></span>

<span data-ttu-id="9a1d7-138">继续 .NET Framework 的最大原因是，应用程序不处于活动状态，并且不会从上面列出的优势中获益。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-138">The biggest reason to stay on .NET Framework is when an app isn't under active development and wouldn't benefit substantially from the advantages listed above.</span></span> <span data-ttu-id="9a1d7-139">在这种情况下，可能不是一个很好的业务案例来移植应用程序的成本。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-139">In that case, there probably isn't a good business case to incur the cost of porting the app.</span></span> <span data-ttu-id="9a1d7-140">如果你的应用程序可能会受益于 .NET Core 产品/服务的优点，但如果你需要某些在 .NET Core 中不可用的技术，你可能仍需要继续 .NET Framework。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-140">If your app might benefit from the advantages .NET Core offers, you may still need to stay on .NET Framework if you need certain technologies that are unavailable on .NET Core.</span></span> <span data-ttu-id="9a1d7-141">.NET Core 提供了一些 [.net 技术](../../core/porting/net-framework-tech-unavailable.md)，其中包括 Appdomain、远程处理、代码访问安全性 (CAS) 、安全透明度和 `System.EnterpriseServices` 。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-141">There are some [.NET technologies that are unavailable on .NET Core](../../core/porting/net-framework-tech-unavailable.md), including AppDomains, Remoting, Code Access Security (CAS), Security Transparency, and `System.EnterpriseServices`.</span></span> <span data-ttu-id="9a1d7-142">此处提供了这些技术及其替代项的简要概述。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-142">A brief summary of these technologies and their alternatives is included here.</span></span> <span data-ttu-id="9a1d7-143">有关更详细的指南，请参阅文档。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-143">For more detailed guidance, see the documentation.</span></span>

### <a name="application-domains"></a><span data-ttu-id="9a1d7-144">应用程序域</span><span class="sxs-lookup"><span data-stu-id="9a1d7-144">Application domains</span></span>

<span data-ttu-id="9a1d7-145">应用程序域 (AppDomain) 可将应用相互隔离。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-145">Application domains (AppDomains) isolate apps from one another.</span></span> <span data-ttu-id="9a1d7-146">Appdomain 需要运行时支持，而且可能会占用大量资源。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-146">AppDomains require runtime support and can be expensive.</span></span> <span data-ttu-id="9a1d7-147">不支持创建更多的应用程序域，而且将来不会将此功能添加到 .NET Core。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-147">Creating additional app domains isn't supported, and there are no plans to add this capability to .NET Core in the future.</span></span> <span data-ttu-id="9a1d7-148">对于代码隔离，将流程或容器用作备用。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-148">For code isolation, use separate processes or containers as an alternative.</span></span>

### <a name="wcf"></a><span data-ttu-id="9a1d7-149">WCF</span><span class="sxs-lookup"><span data-stu-id="9a1d7-149">WCF</span></span>

<span data-ttu-id="9a1d7-150">.NET Core 不支持服务器端 WCF。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-150">Server-side WCF isn't supported in .NET Core.</span></span> <span data-ttu-id="9a1d7-151">.NET Core 支持 WCF 客户端，但不支持 WCF 主机。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-151">.NET Core supports WCF clients but not WCF hosts.</span></span> <span data-ttu-id="9a1d7-152">需要此功能的应用将需要升级到不同的通信技术 (例如，作为迁移的一部分的 gRPC 或 REST) 。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-152">Apps that require this functionality will need to upgrade to a different communication technology (such as gRPC or REST) as part of a migration.</span></span>

<span data-ttu-id="9a1d7-153">[.Net Foundation 中提供了一个 WCF 客户端端口](../../core/dotnet-five.md#windows-communication-foundation)。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-153">There is a [WCF client port available from the .NET Foundation](../../core/dotnet-five.md#windows-communication-foundation).</span></span> <span data-ttu-id="9a1d7-154">它完全是开放源代码、跨平台并受 Microsoft 支持。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-154">It is entirely open source, cross platform, and supported by Microsoft.</span></span> <span data-ttu-id="9a1d7-155">还有一个 *不* 受 Microsoft 正式支持的社区支持的 [CoreWCF 项目](https://github.com/CoreWCF/CoreWCF)。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-155">There is also a community-supported [CoreWCF project](https://github.com/CoreWCF/CoreWCF) that is *not* officially supported by Microsoft.</span></span>

### <a name="remoting"></a><span data-ttu-id="9a1d7-156">远程处理</span><span class="sxs-lookup"><span data-stu-id="9a1d7-156">Remoting</span></span>

<span data-ttu-id="9a1d7-157">.NET 远程处理被认为是存在问题的体系结构。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-157">.NET Remoting was identified as a problematic architecture.</span></span> <span data-ttu-id="9a1d7-158">它用于进行跨 AppDomain 的通信，该通信现已不再受支持。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-158">It's used for cross-AppDomain communication, which is no longer supported.</span></span> <span data-ttu-id="9a1d7-159">同样，远程处理也需要运行时支持，进行维护的成本较高。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-159">Also, Remoting requires runtime support, which is expensive to maintain.</span></span> <span data-ttu-id="9a1d7-160">由于这些原因，.net Core 不支持 .NET 远程处理，并且产品团队不打算在将来添加对它的支持。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-160">For these reasons, .NET Remoting isn't supported on .NET Core, and the product team doesn't plan on adding support for it in the future.</span></span> <span data-ttu-id="9a1d7-161">可以使用几种备选消息传递策略和实现来替换 .NET Core 应用中的远程处理。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-161">There are several alternative messaging strategies and implementations you can use to replace remoting in your .NET Core apps.</span></span>

### <a name="code-access-security-cas-and-security-transparency"></a><span data-ttu-id="9a1d7-162"> (CA) 和安全透明度的代码访问安全性</span><span class="sxs-lookup"><span data-stu-id="9a1d7-162">Code Access Security (CAS) and Security Transparency</span></span>

<span data-ttu-id="9a1d7-163">.NET Core 不支持这两种技术。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-163">Neither of these technologies are supported by .NET Core.</span></span> <span data-ttu-id="9a1d7-164">相反，建议使用操作系统提供的安全边界。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-164">Instead, the recommendation is to use security boundaries provided by the operating system.</span></span> <span data-ttu-id="9a1d7-165">例如，虚拟化、容器或用户帐户。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-165">For example, virtualization, containers, or user accounts.</span></span> <span data-ttu-id="9a1d7-166">用所需的最小特权集运行进程。</span><span class="sxs-lookup"><span data-stu-id="9a1d7-166">Run processes with the minimal set of privileges necessary.</span></span>

## <a name="references"></a><span data-ttu-id="9a1d7-167">参考</span><span class="sxs-lookup"><span data-stu-id="9a1d7-167">References</span></span>

[<span data-ttu-id="9a1d7-168">.NET Core 中不可用的 .NET Framework 技术</span><span class="sxs-lookup"><span data-stu-id="9a1d7-168">.NET Framework Technologies Unavailable on .NET Core</span></span>](../../core/porting/net-framework-tech-unavailable.md)

>[!div class="step-by-step"]
><span data-ttu-id="9a1d7-169">[上一页](introduction.md)
>[下一页](migrate-aspnet-core-2-1.md)</span><span class="sxs-lookup"><span data-stu-id="9a1d7-169">[Previous](introduction.md)
[Next](migrate-aspnet-core-2-1.md)</span></span>

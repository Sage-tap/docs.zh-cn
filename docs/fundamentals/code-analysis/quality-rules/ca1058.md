---
title: CA1058：类型不应扩展某些基类型（代码分析）
description: 了解代码分析规则 CA1058：类型不应扩展某些基类型
ms.date: 03/11/2019
ms.topic: reference
f1_keywords:
- TypesShouldNotExtendCertainBaseTypes
- CA1058
helpviewer_keywords:
- CA1058
- TypesShouldNotExtendCertainBaseTypes
author: gewarren
ms.author: gewarren
ms.openlocfilehash: a67a6d494ee11c6b3c1ed6b7cde62f721517ad26
ms.sourcegitcommit: 05d0087dfca85aac9ca2960f86c5efd218bf833f
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/30/2021
ms.locfileid: "99546785"
---
# <a name="ca1058-types-should-not-extend-certain-base-types"></a><span data-ttu-id="dc938-103">CA1058:类型不应扩展某些基类型</span><span class="sxs-lookup"><span data-stu-id="dc938-103">CA1058: Types should not extend certain base types</span></span>

| | <span data-ttu-id="dc938-104">值</span><span class="sxs-lookup"><span data-stu-id="dc938-104">Value</span></span> |
|-|-|
| <span data-ttu-id="dc938-105">**规则 ID**</span><span class="sxs-lookup"><span data-stu-id="dc938-105">**Rule ID**</span></span> |<span data-ttu-id="dc938-106">CA1058</span><span class="sxs-lookup"><span data-stu-id="dc938-106">CA1058</span></span>|
| <span data-ttu-id="dc938-107">**类别**</span><span class="sxs-lookup"><span data-stu-id="dc938-107">**Category**</span></span> |[<span data-ttu-id="dc938-108">Microsoft.Design</span><span class="sxs-lookup"><span data-stu-id="dc938-108">Microsoft.Design</span></span>](design-warnings.md)|
| <span data-ttu-id="dc938-109">修复是中断修复还是非中断修复</span><span class="sxs-lookup"><span data-stu-id="dc938-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="dc938-110">重大</span><span class="sxs-lookup"><span data-stu-id="dc938-110">Breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="dc938-111">原因</span><span class="sxs-lookup"><span data-stu-id="dc938-111">Cause</span></span>

<span data-ttu-id="dc938-112">类型扩展了以下基类型之一：</span><span class="sxs-lookup"><span data-stu-id="dc938-112">A type extends one of the following base types:</span></span>

- <xref:System.ApplicationException?displayProperty=fullName>
- <xref:System.Xml.XmlDocument?displayProperty=fullName>
- <xref:System.Collections.CollectionBase?displayProperty=fullName>
- <xref:System.Collections.DictionaryBase?displayProperty=fullName>
- <xref:System.Collections.Queue?displayProperty=fullName>
- <xref:System.Collections.ReadOnlyCollectionBase?displayProperty=fullName>
- <xref:System.Collections.SortedList?displayProperty=fullName>
- <xref:System.Collections.Stack?displayProperty=fullName>

<span data-ttu-id="dc938-113">默认情况下，此规则仅查看外部可见的类型，但这是[可配置](#configure-code-to-analyze)的。</span><span class="sxs-lookup"><span data-stu-id="dc938-113">By default, this rule only looks at externally visible types, but this is [configurable](#configure-code-to-analyze).</span></span>

## <a name="rule-description"></a><span data-ttu-id="dc938-114">规则说明</span><span class="sxs-lookup"><span data-stu-id="dc938-114">Rule description</span></span>

<span data-ttu-id="dc938-115">异常应派生自 <xref:System.Exception?displayProperty=fullName> 或其在 <xref:System> 命名空间中的子类之一。</span><span class="sxs-lookup"><span data-stu-id="dc938-115">Exceptions should derive from <xref:System.Exception?displayProperty=fullName> or one of its subclasses in the <xref:System> namespace.</span></span>

<span data-ttu-id="dc938-116">如果要创建基础对象模型或数据源的 XML 视图，请勿创建 <xref:System.Xml.XmlDocument> 的子类。</span><span class="sxs-lookup"><span data-stu-id="dc938-116">Do not create a subclass of <xref:System.Xml.XmlDocument> if you want to create an XML view of an underlying object model or data source.</span></span>

### <a name="non-generic-collections"></a><span data-ttu-id="dc938-117">非泛型集合</span><span class="sxs-lookup"><span data-stu-id="dc938-117">Non-generic collections</span></span>

<span data-ttu-id="dc938-118">尽可能使用和/或扩展泛型集合。</span><span class="sxs-lookup"><span data-stu-id="dc938-118">Use and/or extend generic collections whenever possible.</span></span> <span data-ttu-id="dc938-119">除非之前已发布过代码，否则请勿在代码中扩展非泛型集合。</span><span class="sxs-lookup"><span data-stu-id="dc938-119">Do not extend non-generic collections in your code, unless you shipped it previously.</span></span>

<span data-ttu-id="dc938-120">**错误用法示例**</span><span class="sxs-lookup"><span data-stu-id="dc938-120">**Examples of Incorrect Usage**</span></span>

```csharp
public class MyCollection : CollectionBase
{
}

public class MyReadOnlyCollection : ReadOnlyCollectionBase
{
}
```

<span data-ttu-id="dc938-121">**正确用法示例**</span><span class="sxs-lookup"><span data-stu-id="dc938-121">**Examples of Correct Usage**</span></span>

```csharp
public class MyCollection : Collection<T>
{
}

public class MyReadOnlyCollection : ReadOnlyCollection<T>
{
}
```

## <a name="how-to-fix-violations"></a><span data-ttu-id="dc938-122">如何解决冲突</span><span class="sxs-lookup"><span data-stu-id="dc938-122">How to fix violations</span></span>

<span data-ttu-id="dc938-123">若要解决此规则的冲突，请从其他基类型或泛型集合派生该类型。</span><span class="sxs-lookup"><span data-stu-id="dc938-123">To fix a violation of this rule, derive the type from a different base type or a generic collection.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="dc938-124">何时禁止显示警告</span><span class="sxs-lookup"><span data-stu-id="dc938-124">When to suppress warnings</span></span>

<span data-ttu-id="dc938-125">对于有关 <xref:System.ApplicationException> 的冲突，请勿禁止显示此规则的警告。</span><span class="sxs-lookup"><span data-stu-id="dc938-125">Do not suppress a warning from this rule for violations about <xref:System.ApplicationException>.</span></span> <span data-ttu-id="dc938-126">对于有关 <xref:System.Xml.XmlDocument> 的冲突，可以安全地禁止显示此规则的警告。</span><span class="sxs-lookup"><span data-stu-id="dc938-126">It is safe to suppress a warning from this rule for violations about <xref:System.Xml.XmlDocument>.</span></span> <span data-ttu-id="dc938-127">如果之前发布过代码，则可以安全地禁止显示有关非泛型集合的警告。</span><span class="sxs-lookup"><span data-stu-id="dc938-127">It is safe to suppress a warning about a non-generic collection if the code was released previously.</span></span>

## <a name="configure-code-to-analyze"></a><span data-ttu-id="dc938-128">配置代码以进行分析</span><span class="sxs-lookup"><span data-stu-id="dc938-128">Configure code to analyze</span></span>

<span data-ttu-id="dc938-129">使用下面的选项来配置代码库的哪些部分要运行此规则。</span><span class="sxs-lookup"><span data-stu-id="dc938-129">Use the following option to configure which parts of your codebase to run this rule on.</span></span>

- [<span data-ttu-id="dc938-130">包含特定的 API 图面</span><span class="sxs-lookup"><span data-stu-id="dc938-130">Include specific API surfaces</span></span>](#include-specific-api-surfaces)

<span data-ttu-id="dc938-131">你可以仅为此规则、为所有规则或为此类别中的所有规则配置此选项（[设计](design-warnings.md)）。</span><span class="sxs-lookup"><span data-stu-id="dc938-131">You can configure this option for just this rule, for all rules, or for all rules in this category ([Design](design-warnings.md)).</span></span> <span data-ttu-id="dc938-132">有关详细信息，请参阅[代码质量规则配置选项](../code-quality-rule-options.md)。</span><span class="sxs-lookup"><span data-stu-id="dc938-132">For more information, see [Code quality rule configuration options](../code-quality-rule-options.md).</span></span>

[!INCLUDE[api-surface](~/includes/code-analysis/api-surface.md)]

---
title: Winmdexp.exe（Windows 运行时元数据导出工具）
description: 了解 Winmdexp.exe（Windows 运行时元数据导出工具）。 此工具将 .NET 模块转换为包含 Windows 运行时元数据的文件。
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Runtime Metadata Export Tool
- Winmdexp.exe
ms.assetid: d2ce0683-343d-403e-bb8d-209186f7a19d
ms.openlocfilehash: a35577841765f7e6d5d5e8220bf3951f81d65832
ms.sourcegitcommit: 9c589b25b005b9a7f87327646020eb85c3b6306f
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/06/2021
ms.locfileid: "102258697"
---
# <a name="winmdexpexe-windows-runtime-metadata-export-tool"></a><span data-ttu-id="efcf4-104">Winmdexp.exe（Windows 运行时元数据导出工具）</span><span class="sxs-lookup"><span data-stu-id="efcf4-104">Winmdexp.exe (Windows Runtime Metadata Export Tool)</span></span>

<span data-ttu-id="efcf4-105">Windows 运行时元数据导出工具 (Winmdexp.exe) 可将 .NET Framework 模块转换为包含 Windows 运行时元数据的文件。</span><span class="sxs-lookup"><span data-stu-id="efcf4-105">The Windows Runtime Metadata Export Tool (Winmdexp.exe) transforms a .NET Framework module into a file that contains Windows Runtime metadata.</span></span> <span data-ttu-id="efcf4-106">尽管 .NET Framework 程序集和 Windows 运行时元数据文件使用相同的物理格式，但元数据表的内容有差别，这意味着 .NET Framework 程序集不可自动用作 Windows 运行时组件。</span><span class="sxs-lookup"><span data-stu-id="efcf4-106">Although .NET Framework assemblies and Windows Runtime metadata files use the same physical format, there are differences in the content of the metadata tables, which means that .NET Framework assemblies are not automatically usable as Windows Runtime Components.</span></span> <span data-ttu-id="efcf4-107">将 .NET Framework 模块转换为 Windows 运行时组件的过程称为“导出”。</span><span class="sxs-lookup"><span data-stu-id="efcf4-107">The process of turning a .NET Framework module into a Windows Runtime component is referred to as *exporting*.</span></span> <span data-ttu-id="efcf4-108">在 .NET Framework 4.5 和 .NET Framework 4.5.1 中，生成的 Windows 元数据 (.winmd) 文件同时包含元数据和实现。</span><span class="sxs-lookup"><span data-stu-id="efcf4-108">In the .NET Framework 4.5 and .NET Framework 4.5.1, the resulting Windows metadata (.winmd) file contains both metadata and implementation.</span></span>  
  
 <span data-ttu-id="efcf4-109">使用 Windows 运行时组件模板（在 C# 中，位于“Microsoft Store”下；在 Visual Basic 中，位于 Visual Studio 2013 或 Visual Studio 2012 中）时，编译器目标是 .winmdobj 文件，后续生成步骤将调用 Winmdexp.exe 以将 .winmdobj 文件导出到 .winmd 文件。</span><span class="sxs-lookup"><span data-stu-id="efcf4-109">When you use the **Windows Runtime Component** template, which is located under **Windows Store** for C# and Visual Basic in Visual Studio 2013 or Visual Studio 2012, the compiler target is a .winmdobj file, and a subsequent build step calls Winmdexp.exe to export the .winmdobj file to a .winmd file.</span></span> <span data-ttu-id="efcf4-110">这是生成 Windows 运行时组件的推荐方法。</span><span class="sxs-lookup"><span data-stu-id="efcf4-110">This is the recommended way to build a Windows Runtime component.</span></span> <span data-ttu-id="efcf4-111">当你对生成过程需要的控制超过 Visual Studio 所能提供的控制时，请直接使用 Winmdexp.exe。</span><span class="sxs-lookup"><span data-stu-id="efcf4-111">Use Winmdexp.exe directly when you want more control over the build process than Visual Studio provides.</span></span>  
  
 <span data-ttu-id="efcf4-112">此工具会自动随 Visual Studio 一起安装。</span><span class="sxs-lookup"><span data-stu-id="efcf4-112">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="efcf4-113">若要运行此工具，请使用[开发人员命令行 shell](/visualstudio/ide/reference/command-prompt-powershell)。</span><span class="sxs-lookup"><span data-stu-id="efcf4-113">To run the tool, use a [command-line shell for developers](/visualstudio/ide/reference/command-prompt-powershell).</span></span>
  
 <span data-ttu-id="efcf4-114">在命令提示符处，键入以下内容：</span><span class="sxs-lookup"><span data-stu-id="efcf4-114">At the command prompt, type the following:</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="efcf4-115">语法</span><span class="sxs-lookup"><span data-stu-id="efcf4-115">Syntax</span></span>  
  
```console  
winmdexp [options] winmdmodule  
```  
  
## <a name="parameters"></a><span data-ttu-id="efcf4-116">parameters</span><span class="sxs-lookup"><span data-stu-id="efcf4-116">Parameters</span></span>  
  
|<span data-ttu-id="efcf4-117">自变量或选项</span><span class="sxs-lookup"><span data-stu-id="efcf4-117">Argument or option</span></span>|<span data-ttu-id="efcf4-118">描述</span><span class="sxs-lookup"><span data-stu-id="efcf4-118">Description</span></span>|  
|------------------------|-----------------|  
|`winmdmodule`|<span data-ttu-id="efcf4-119">指定要导出的模块 (.winmdobj)。</span><span class="sxs-lookup"><span data-stu-id="efcf4-119">Specifies the module (.winmdobj) to be exported.</span></span> <span data-ttu-id="efcf4-120">仅允许一个模块。</span><span class="sxs-lookup"><span data-stu-id="efcf4-120">Only one module is allowed.</span></span> <span data-ttu-id="efcf4-121">若要创建此模块，请将 `/target` 编译器选项与 `winmdobj` 目标一起使用。</span><span class="sxs-lookup"><span data-stu-id="efcf4-121">To create this module, use the `/target` compiler option with the `winmdobj` target.</span></span> <span data-ttu-id="efcf4-122">请参阅 [-target:winmdobj（C# 编译器选项）](../../csharp/language-reference/compiler-options/target-winmdobj-compiler-option.md)或 [-target (Visual Basic)](../../visual-basic/reference/command-line-compiler/target.md)。</span><span class="sxs-lookup"><span data-stu-id="efcf4-122">See [-target:winmdobj (C# Compiler Options)](../../csharp/language-reference/compiler-options/target-winmdobj-compiler-option.md) or [-target (Visual Basic)](../../visual-basic/reference/command-line-compiler/target.md).</span></span>|  
|<span data-ttu-id="efcf4-123">`/docfile:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="efcf4-123">`/docfile:` `docfile`</span></span><br /><br /> <span data-ttu-id="efcf4-124">`/d:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="efcf4-124">`/d:` `docfile`</span></span>|<span data-ttu-id="efcf4-125">指定 Winmdexp.exe 将生成的输出 XML 文档文件。</span><span class="sxs-lookup"><span data-stu-id="efcf4-125">Specifies the output XML documentation file that Winmdexp.exe will produce.</span></span> <span data-ttu-id="efcf4-126">在 .NET Framework 4.5 中，输出文件实质上与输入 XML 文档文件相同。</span><span class="sxs-lookup"><span data-stu-id="efcf4-126">In the .NET Framework 4.5, the output file is essentially the same as the input XML documentation file.</span></span>|  
|<span data-ttu-id="efcf4-127">`/moduledoc:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="efcf4-127">`/moduledoc:` `docfile`</span></span><br /><br /> <span data-ttu-id="efcf4-128">`/md:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="efcf4-128">`/md:` `docfile`</span></span>|<span data-ttu-id="efcf4-129">指定编译器使用 `winmdmodule` 生成的 XML 文档文件的名称。</span><span class="sxs-lookup"><span data-stu-id="efcf4-129">Specifies the name of the XML documentation file that the compiler produced with `winmdmodule`.</span></span>|  
|<span data-ttu-id="efcf4-130">`/modulepdb:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="efcf4-130">`/modulepdb:` `symbolfile`</span></span><br /><br /> <span data-ttu-id="efcf4-131">`/mp:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="efcf4-131">`/mp:` `symbolfile`</span></span>|<span data-ttu-id="efcf4-132">指定包含 `winmdmodule` 的符号的程序数据库 (PDB) 文件的名称。</span><span class="sxs-lookup"><span data-stu-id="efcf4-132">Specifies the name of the program database (PDB) file that contains symbols for `winmdmodule`.</span></span>|  
|<span data-ttu-id="efcf4-133">`/nowarn:` `warning`</span><span class="sxs-lookup"><span data-stu-id="efcf4-133">`/nowarn:` `warning`</span></span>|<span data-ttu-id="efcf4-134">禁止显示指定的警告编号。</span><span class="sxs-lookup"><span data-stu-id="efcf4-134">Suppresses the specified warning number.</span></span> <span data-ttu-id="efcf4-135">对于 *警告*，仅提供错误代码的数字部分（不包含前导零）。</span><span class="sxs-lookup"><span data-stu-id="efcf4-135">For *warning*, supply only the numeric portion of the error code, without leading zeros.</span></span>|  
|<span data-ttu-id="efcf4-136">`/out:` `file`</span><span class="sxs-lookup"><span data-stu-id="efcf4-136">`/out:` `file`</span></span><br /><br /> <span data-ttu-id="efcf4-137">`/o:` `file`</span><span class="sxs-lookup"><span data-stu-id="efcf4-137">`/o:` `file`</span></span>|<span data-ttu-id="efcf4-138">指定输出 Windows 元数据 (.winmd) 文件的名称。</span><span class="sxs-lookup"><span data-stu-id="efcf4-138">Specifies the name of the output Windows metadata (.winmd) file.</span></span>|  
|<span data-ttu-id="efcf4-139">`/pdb:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="efcf4-139">`/pdb:` `symbolfile`</span></span><br /><br /> <span data-ttu-id="efcf4-140">`/p:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="efcf4-140">`/p:` `symbolfile`</span></span>|<span data-ttu-id="efcf4-141">指定将包含导出的 Windows 元数据 (.winmd) 文件的符号的输出程序数据库 (PDB) 文件的名称。</span><span class="sxs-lookup"><span data-stu-id="efcf4-141">Specifies the name of the output program database (PDB) file that will contain the symbols for the exported Windows metadata (.winmd) file.</span></span>|  
|<span data-ttu-id="efcf4-142">`/reference:` `winmd`</span><span class="sxs-lookup"><span data-stu-id="efcf4-142">`/reference:` `winmd`</span></span><br /><br /> <span data-ttu-id="efcf4-143">`/r:` `winmd`</span><span class="sxs-lookup"><span data-stu-id="efcf4-143">`/r:` `winmd`</span></span>|<span data-ttu-id="efcf4-144">指定要在导出过程中引用的元数据文件 (.winmd 或程序集)。</span><span class="sxs-lookup"><span data-stu-id="efcf4-144">Specifies a metadata file (.winmd or assembly) to reference during export.</span></span> <span data-ttu-id="efcf4-145">如果使用“Program Files (x86)\Reference Assemblies\Microsoft\Framework\\.NETCore\v4.5”（在 32 位计算机上为“\Program Files\\...”）中的引用程序集，请包含对 System.Runtime.dll 和 mscorlib.dll 的引用。</span><span class="sxs-lookup"><span data-stu-id="efcf4-145">If you use the reference assemblies in "\Program Files (x86)\Reference Assemblies\Microsoft\Framework\\.NETCore\v4.5" ("\Program Files\\..." on 32-bit computers), include references to both System.Runtime.dll and mscorlib.dll.</span></span>|  
|`/utf8output`|<span data-ttu-id="efcf4-146">指定输出消息应采用 UTF-8 编码。</span><span class="sxs-lookup"><span data-stu-id="efcf4-146">Specifies that output messages should be in UTF-8 encoding.</span></span>|  
|`/warnaserror+`|<span data-ttu-id="efcf4-147">指定应将所有警告都视为错误。</span><span class="sxs-lookup"><span data-stu-id="efcf4-147">Specifies that all warnings should be treated as errors.</span></span>|  
|<span data-ttu-id="efcf4-148">**@** `responsefile`</span><span class="sxs-lookup"><span data-stu-id="efcf4-148">**@** `responsefile`</span></span>|<span data-ttu-id="efcf4-149">指定包含选项的响应 (.rsp) 文件（并且还可以选择指定 `winmdmodule`）。</span><span class="sxs-lookup"><span data-stu-id="efcf4-149">Specifies a response (.rsp) file that contains options (and optionally `winmdmodule`).</span></span> <span data-ttu-id="efcf4-150">`responsefile` 中的每行应包含一个参数或选项。</span><span class="sxs-lookup"><span data-stu-id="efcf4-150">Each line in `responsefile` should contain a single argument or option.</span></span>|  
  
## <a name="remarks"></a><span data-ttu-id="efcf4-151">备注</span><span class="sxs-lookup"><span data-stu-id="efcf4-151">Remarks</span></span>  

 <span data-ttu-id="efcf4-152">Winmdexp.exe 未被设计将任意 .NET Framework 程序集转换为 .winmd 文件。</span><span class="sxs-lookup"><span data-stu-id="efcf4-152">Winmdexp.exe is not designed to convert an arbitrary .NET Framework assembly to a .winmd file.</span></span> <span data-ttu-id="efcf4-153">它需要使用 `/target:winmdobj` 选项编译的模块，并且其他限制也适用。</span><span class="sxs-lookup"><span data-stu-id="efcf4-153">It requires a module that is compiled with the `/target:winmdobj` option, and additional restrictions apply.</span></span> <span data-ttu-id="efcf4-154">这些限制中最重要的是，程序集的 API 图面中公开的所有类型都必须是 Windows 运行时类型。</span><span class="sxs-lookup"><span data-stu-id="efcf4-154">The most important of these restrictions is that all types that are exposed in the API surface of the assembly must be Windows Runtime types.</span></span> <span data-ttu-id="efcf4-155">有关详细信息，请参阅[在 C# 和 Visual Basic 中创建 Windows 运行时组件](/previous-versions/br230301(v=vs.110))一文中的“在 Windows 运行时组件中声明类型”一节。</span><span class="sxs-lookup"><span data-stu-id="efcf4-155">For more information, see the "Declaring types in Windows Runtime Components" section of the article [Creating Windows Runtime Components in C# and Visual Basic](/previous-versions/br230301(v=vs.110)).</span></span>
  
 <span data-ttu-id="efcf4-156">当你使用 C# 或 Visual Basic 编写 Windows 8.x 应用商店应用或 Windows 运行时组件时，.NET Framework 将提供支持，使得利用 Windows 运行时进行编程更加自然。</span><span class="sxs-lookup"><span data-stu-id="efcf4-156">When you write a Windows 8.x Store app or a Windows Runtime component with C# or Visual Basic, the .NET Framework provides support to make programming with the Windows Runtime more natural.</span></span> <span data-ttu-id="efcf4-157">[Windows 应用商店应用和 Windows 运行时的 .NET Framework 支持](../cross-platform/support-for-windows-store-apps-and-windows-runtime.md)一文中对此进行了讨论。</span><span class="sxs-lookup"><span data-stu-id="efcf4-157">This is discussed in the article [.NET Framework Support for Windows Store Apps and Windows Runtime](../cross-platform/support-for-windows-store-apps-and-windows-runtime.md).</span></span> <span data-ttu-id="efcf4-158">在该过程中，某些常用的 Windows 运行时类型将映射到 .NET Framework 类型。</span><span class="sxs-lookup"><span data-stu-id="efcf4-158">In the process, some commonly used Windows Runtime types are mapped to .NET Framework types.</span></span> <span data-ttu-id="efcf4-159">Winmdexp.exe 将反转此过程并生成使用对应的 Windows 运行时类型的 API 图面。</span><span class="sxs-lookup"><span data-stu-id="efcf4-159">Winmdexp.exe reverses this process and produces an API surface that uses the corresponding Windows Runtime types.</span></span> <span data-ttu-id="efcf4-160">例如，从 <xref:System.Collections.Generic.IList%601> 接口构造的类型将映射到从 Windows 运行时 <xref:Windows.Foundation.Collections.IVector%601> 接口构造的类型。</span><span class="sxs-lookup"><span data-stu-id="efcf4-160">For example, types that are constructed from the <xref:System.Collections.Generic.IList%601> interface map to types that are constructed from the Windows Runtime <xref:Windows.Foundation.Collections.IVector%601> interface.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="efcf4-161">请参阅</span><span class="sxs-lookup"><span data-stu-id="efcf4-161">See also</span></span>

- [<span data-ttu-id="efcf4-162">.NET Framework 对 Windows 应用商店应用和 Windows 运行时的支持情况</span><span class="sxs-lookup"><span data-stu-id="efcf4-162">.NET Framework Support for Windows Store Apps and Windows Runtime</span></span>](../cross-platform/support-for-windows-store-apps-and-windows-runtime.md)
- <span data-ttu-id="efcf4-163">[用 C# 和 Visual Basic 创建 Windows 运行时组件](/previous-versions/br230301(v=vs.110))</span><span class="sxs-lookup"><span data-stu-id="efcf4-163">[Creating Windows Runtime Components in C# and Visual Basic](/previous-versions/br230301(v=vs.110))</span></span>
- [<span data-ttu-id="efcf4-164">Winmdexp.exe 错误消息</span><span class="sxs-lookup"><span data-stu-id="efcf4-164">Winmdexp.exe Error Messages</span></span>](winmdexp-exe-error-messages.md)
- <span data-ttu-id="efcf4-165">[生成、部署和配置工具 (.NET Framework)](/previous-versions/dotnet/netframework-4.0/dd233108(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="efcf4-165">[Build, Deployment, and Configuration Tools (.NET Framework)](/previous-versions/dotnet/netframework-4.0/dd233108(v=vs.100))</span></span>

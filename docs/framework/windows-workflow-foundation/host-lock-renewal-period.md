---
description: 了解更多：主机锁续订期
title: 宿主锁定续订期
ms.date: 03/30/2017
ms.assetid: f8ba94fc-27e0-4d8e-8f85-50a6d2a3cd43
ms.openlocfilehash: 88348c4cebd7ac42657c4ba68238a3b58a8f0d1a
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/06/2021
ms.locfileid: "99742207"
---
# <a name="host-lock-renewal-period"></a><span data-ttu-id="1d20c-103">宿主锁定续订期</span><span class="sxs-lookup"><span data-stu-id="1d20c-103">Host Lock Renewal Period</span></span>

<span data-ttu-id="1d20c-104">使用 SQL 工作流实例存储的 " **主机锁定续订期间** " 属性，您可以指定一个时间段，在该时间段内，主机将其在工作流实例上的锁进行续订。</span><span class="sxs-lookup"><span data-stu-id="1d20c-104">The **Host Lock Renewal Period** property of the SQL Workflow Instance Store lets you specify the time period within which the host renews its lock on a workflow instance.</span></span> <span data-ttu-id="1d20c-105">锁定在宿主锁定续订期及其后 30 秒内有效。</span><span class="sxs-lookup"><span data-stu-id="1d20c-105">The lock remains valid for Host Lock Renewal Period + 30 seconds.</span></span> <span data-ttu-id="1d20c-106">如果宿主未能在此时间段内续订锁定（换句话说，延长租约），则锁定将过期并且持久性提供程序将解除实例锁定。</span><span class="sxs-lookup"><span data-stu-id="1d20c-106">If the host fails to renew the lock (in other words, extend the lease) within this time period, the lock expires and the persistence provider unlocks the instance.</span></span> <span data-ttu-id="1d20c-107">此属性的值为类型为 "hh： mm： ss" 的 TimeSpan。</span><span class="sxs-lookup"><span data-stu-id="1d20c-107">The value for this property is of type TimeSpan of the form "hh:mm:ss".</span></span> <span data-ttu-id="1d20c-108">允许的最小值为 "00:00:01" (1 秒) 。</span><span class="sxs-lookup"><span data-stu-id="1d20c-108">The minimum permitted value is "00:00:01" (1 second).</span></span> <span data-ttu-id="1d20c-109">此属性的默认值为 "00:00:30" (30 秒) 。</span><span class="sxs-lookup"><span data-stu-id="1d20c-109">The default value of this property is "00:00:30" (30 seconds).</span></span>  
  
 <span data-ttu-id="1d20c-110">在工作流服务宿主解除其拥有的工作流服务实例的锁定之前该宿主即失败的情况下，此属性很重要。</span><span class="sxs-lookup"><span data-stu-id="1d20c-110">This property is significant in scenarios where a workflow service host fails before it can unlock a workflow service instance that it owns.</span></span> <span data-ttu-id="1d20c-111">在这种情况下，持久性提供程序将在该锁定过期后移除持久性数据库中工作流服务实例上的锁定，以便运行在同一台计算机上或服务器场中的另一台计算机上的另一工作流服务宿主可以获取锁定并将工作流服务实例加载到内存中，从而从该工作流服务实例的最后持久保存状态继续其执行。</span><span class="sxs-lookup"><span data-stu-id="1d20c-111">In this scenario, the lock on the workflow service instance in the persistence database is removed by the persistence provider after the lock expires so that another workflow service host running on the same computer or another computer in a server farm can acquire the lock and load the workflow service instance into memory to resume its execution from its last persisted state.</span></span>  
  
 <span data-ttu-id="1d20c-112">将此属性设置为较大的值将使工作流服务实例在持久性数据库中锁定的时间更长，从而延迟该实例从最后一个持久点恢复的时间。</span><span class="sxs-lookup"><span data-stu-id="1d20c-112">Setting a higher value for this property causes the workflow service instances to be locked in the persistence database for a longer time and therefore delays the recovery of the instance from the last persistence point.</span></span> <span data-ttu-id="1d20c-113">将此属性设置为较短间隔可使工作流服务主机的新实例快速选取失败的工作流服务实例，但会导致工作流服务主机和 SQL Server 数据库的工作负荷增加。</span><span class="sxs-lookup"><span data-stu-id="1d20c-113">Setting a short interval for this property causes the new instance of the workflow service host to pick up the failed workflow service instance quickly, but causes an increase in workload for the workflow service host and the SQL Server database.</span></span>  
  
 <span data-ttu-id="1d20c-114">SQL 工作流实例存储运行一个内部任务，该任务将定期苏醒并检测实例上是否有过期锁定。</span><span class="sxs-lookup"><span data-stu-id="1d20c-114">The SQL Workflow Instance Store runs an internal task that periodically wakes up and detects instances with expired locks on them.</span></span> <span data-ttu-id="1d20c-115">当它发现有过期锁定的实例时，会将这些实例放在 RunnableInstances 表中，以使工作流宿主可以选取并运行这些实例。</span><span class="sxs-lookup"><span data-stu-id="1d20c-115">When it finds instances with expired locks, it places the instances in the RunnableInstances table so that a workflow host can pick up and run these instances.</span></span>

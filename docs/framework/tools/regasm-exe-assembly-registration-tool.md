---
title: Regasm.exe（程序集注册工具）
description: 使用 Regasm.exe（程序集注册工具）。 读取程序集元数据，并将所需项添加到注册表中，允许 COM 客户端创建 .NET 类。
ms.date: 03/30/2017
helpviewer_keywords:
- Assembly Registration tool
- assemblies [.NET Framework], registering
- Regasm.exe
- registering assemblies
ms.assetid: e190e342-36ef-4651-a0b4-0e8c2c0281cb
ms.openlocfilehash: 81d835d280a3a55efc7644b2a081d033afe73349
ms.sourcegitcommit: 1dbe25ff484a02025d5c34146e517c236f7161fb
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/19/2021
ms.locfileid: "104653317"
---
# <a name="regasmexe-assembly-registration-tool"></a><span data-ttu-id="696c8-104">Regasm.exe（程序集注册工具）</span><span class="sxs-lookup"><span data-stu-id="696c8-104">Regasm.exe (Assembly Registration Tool)</span></span>

<span data-ttu-id="696c8-105">程序集注册工具读取程序集中的元数据，并将所需项添加到注册表中。注册表允许 COM 客户端以透明方式创建 .NET Framework 类。</span><span class="sxs-lookup"><span data-stu-id="696c8-105">The Assembly Registration tool reads the metadata within an assembly and adds the necessary entries to the registry, which allows COM clients to create .NET Framework classes transparently.</span></span> <span data-ttu-id="696c8-106">在注册一个类之后，任何 COM 客户端都可以像使用 COM 类一样使用它。</span><span class="sxs-lookup"><span data-stu-id="696c8-106">Once a class is registered, any COM client can use it as though the class were a COM class.</span></span> <span data-ttu-id="696c8-107">类仅在安装程序集时注册一次。</span><span class="sxs-lookup"><span data-stu-id="696c8-107">The class is registered only once, when the assembly is installed.</span></span> <span data-ttu-id="696c8-108">只有实际注册程序集中的类实例之后才能从 COM 中创建它们。</span><span class="sxs-lookup"><span data-stu-id="696c8-108">Instances of classes within the assembly cannot be created from COM until they are actually registered.</span></span>

<span data-ttu-id="696c8-109">若要运行该工具，请使用 [Visual Studio 开发人员命令提示或 Visual Studio 开发人员 PowerShell](/visualstudio/ide/reference/command-prompt-powershell)。</span><span class="sxs-lookup"><span data-stu-id="696c8-109">To run the tool, use [Visual Studio Developer Command Prompt or Visual Studio Developer PowerShell](/visualstudio/ide/reference/command-prompt-powershell).</span></span>

<span data-ttu-id="696c8-110">在命令提示符处，键入以下内容：</span><span class="sxs-lookup"><span data-stu-id="696c8-110">At the command prompt, type the following:</span></span>

## <a name="syntax"></a><span data-ttu-id="696c8-111">语法</span><span class="sxs-lookup"><span data-stu-id="696c8-111">Syntax</span></span>

```console
regasm assemblyFile [options]
```

## <a name="parameters"></a><span data-ttu-id="696c8-112">参数</span><span class="sxs-lookup"><span data-stu-id="696c8-112">Parameters</span></span>

|<span data-ttu-id="696c8-113">参数</span><span class="sxs-lookup"><span data-stu-id="696c8-113">Parameter</span></span>|<span data-ttu-id="696c8-114">说明</span><span class="sxs-lookup"><span data-stu-id="696c8-114">Description</span></span>|
|---------------|-----------------|
|<span data-ttu-id="696c8-115">assemblyFile</span><span class="sxs-lookup"><span data-stu-id="696c8-115">*assemblyFile*</span></span>|<span data-ttu-id="696c8-116">要向 COM 注册的程序集。</span><span class="sxs-lookup"><span data-stu-id="696c8-116">The assembly to be registered with COM.</span></span>|

|<span data-ttu-id="696c8-117">选项</span><span class="sxs-lookup"><span data-stu-id="696c8-117">Option</span></span>|<span data-ttu-id="696c8-118">描述</span><span class="sxs-lookup"><span data-stu-id="696c8-118">Description</span></span>|
|------------|-----------------|
|<span data-ttu-id="696c8-119">/codebase</span><span class="sxs-lookup"><span data-stu-id="696c8-119">**/codebase**</span></span>|<span data-ttu-id="696c8-120">在注册表中创建一个 Codebase 项。</span><span class="sxs-lookup"><span data-stu-id="696c8-120">Creates a Codebase entry in the registry.</span></span> <span data-ttu-id="696c8-121">Codebase 项指定未安装到全局程序集缓存中的程序集的文件路径。</span><span class="sxs-lookup"><span data-stu-id="696c8-121">The Codebase entry specifies the file path for an assembly that's not installed in the global assembly cache.</span></span> <span data-ttu-id="696c8-122">如果随后将安装要注册到全局程序集缓存中的程序集，请勿指定此选项。</span><span class="sxs-lookup"><span data-stu-id="696c8-122">Don't specify this option if you will subsequently install the assembly that you're registering into the global assembly cache.</span></span> <span data-ttu-id="696c8-123">用 /codebase 选项指定的 assemblyFile 参数必须是[具有强名称的程序集](../../standard/assembly/strong-named.md)   。</span><span class="sxs-lookup"><span data-stu-id="696c8-123">The *assemblyFile* argument that you specify with the **/codebase** option must be a [strong-named assembly](../../standard/assembly/strong-named.md).</span></span>|
|<span data-ttu-id="696c8-124">/registered</span><span class="sxs-lookup"><span data-stu-id="696c8-124">**/registered**</span></span>|<span data-ttu-id="696c8-125">指定此工具将仅引用已经注册的类型库。</span><span class="sxs-lookup"><span data-stu-id="696c8-125">Specifies that this tool will only refer to type libraries that have already been registered.</span></span>|
|<span data-ttu-id="696c8-126">/asmpath:directory</span><span class="sxs-lookup"><span data-stu-id="696c8-126">**/asmpath:directory**</span></span>|<span data-ttu-id="696c8-127">指定包含程序集引用的目录。</span><span class="sxs-lookup"><span data-stu-id="696c8-127">Specifies a directory containing assembly references.</span></span> <span data-ttu-id="696c8-128">必须与 /regfile 选项一起使用  。</span><span class="sxs-lookup"><span data-stu-id="696c8-128">Must be used with the **/regfile** option.</span></span>|
|<span data-ttu-id="696c8-129">**/nologo**</span><span class="sxs-lookup"><span data-stu-id="696c8-129">**/nologo**</span></span>|<span data-ttu-id="696c8-130">取消显示 Microsoft 启动版权标志。</span><span class="sxs-lookup"><span data-stu-id="696c8-130">Suppresses the Microsoft startup banner display.</span></span>|
|<span data-ttu-id="696c8-131">/regfile [: regFile]</span><span class="sxs-lookup"><span data-stu-id="696c8-131">**/regfile** [**:** *regFile*]</span></span>|<span data-ttu-id="696c8-132">为程序集生成指定的 .reg 文件，其中包含所需的注册表项。</span><span class="sxs-lookup"><span data-stu-id="696c8-132">Generates the specified .reg file for the assembly, which contains the needed registry entries.</span></span> <span data-ttu-id="696c8-133">指定此选项将不会更改注册表。</span><span class="sxs-lookup"><span data-stu-id="696c8-133">Specifying this option does not change the registry.</span></span> <span data-ttu-id="696c8-134">此选项不能与 /u 或 /tlb 选项一起使用   。</span><span class="sxs-lookup"><span data-stu-id="696c8-134">You cannot use this option with the **/u** or **/tlb** options.</span></span>|
|<span data-ttu-id="696c8-135">/silent 或 /s</span><span class="sxs-lookup"><span data-stu-id="696c8-135">**/silent** or **/s**</span></span>|<span data-ttu-id="696c8-136">取消显示成功消息。</span><span class="sxs-lookup"><span data-stu-id="696c8-136">Suppresses the display of success messages.</span></span>|
|<span data-ttu-id="696c8-137">/tlb [: typeLibFile]</span><span class="sxs-lookup"><span data-stu-id="696c8-137">**/tlb** [**:** *typeLibFile*]</span></span>|<span data-ttu-id="696c8-138">从指定的程序集生成类型库，该类型库包含在程序集中定义的可访问类型的定义。</span><span class="sxs-lookup"><span data-stu-id="696c8-138">Generates a type library from the specified assembly containing definitions of the accessible types defined within the assembly.</span></span>|
|<span data-ttu-id="696c8-139">/unregister 或 /u</span><span class="sxs-lookup"><span data-stu-id="696c8-139">**/unregister** or **/u**</span></span>|<span data-ttu-id="696c8-140">注销在 assemblyFile 中找到的可创建类  。</span><span class="sxs-lookup"><span data-stu-id="696c8-140">Unregisters the creatable classes found in *assemblyFile*.</span></span> <span data-ttu-id="696c8-141">省略此选项将使 Regasm.exe 注册程序集中的可创建类。</span><span class="sxs-lookup"><span data-stu-id="696c8-141">Omitting this option causes Regasm.exe to register the creatable classes in the assembly.</span></span>|
|<span data-ttu-id="696c8-142">**/verbose**</span><span class="sxs-lookup"><span data-stu-id="696c8-142">**/verbose**</span></span>|<span data-ttu-id="696c8-143">指定详细模式；当与 /tlb 选项一起指定时，将显示所有需要为其生成类型库的引用程序集的列表  。</span><span class="sxs-lookup"><span data-stu-id="696c8-143">Specifies verbose mode; displays a list of any referenced assemblies for which a type library needs to be generated, when specified with the **/tlb** option.</span></span>|
|<span data-ttu-id="696c8-144">**/?**</span><span class="sxs-lookup"><span data-stu-id="696c8-144">**/?**</span></span> <span data-ttu-id="696c8-145">或 /help</span><span class="sxs-lookup"><span data-stu-id="696c8-145">or **/help**</span></span>|<span data-ttu-id="696c8-146">显示该工具的命令语法和选项。</span><span class="sxs-lookup"><span data-stu-id="696c8-146">Displays command syntax and options for the tool.</span></span>|

> [!NOTE]
> <span data-ttu-id="696c8-147">Regasm.exe 命令行选不区分大小写。</span><span class="sxs-lookup"><span data-stu-id="696c8-147">The Regasm.exe command-line options are case insensitive.</span></span> <span data-ttu-id="696c8-148">只需提供足以唯一地进行标识的选项部分。</span><span class="sxs-lookup"><span data-stu-id="696c8-148">You only need to provide enough of the option to uniquely identify it.</span></span> <span data-ttu-id="696c8-149">例如，/n 等效于 /nologo，而 /t: outfile.tlb 等效于 /tlb: outfile.tlb       。</span><span class="sxs-lookup"><span data-stu-id="696c8-149">For example, **/n** is equivalent to **/nologo** and **/t:** *outfile.tlb* is equivalent to **/tlb:** *outfile.tlb*.</span></span>

## <a name="remarks"></a><span data-ttu-id="696c8-150">备注</span><span class="sxs-lookup"><span data-stu-id="696c8-150">Remarks</span></span>

<span data-ttu-id="696c8-151">可以使用 /regfile 选项生成包含注册表项的 .reg 文件，而不是直接对注册表进行更改  。</span><span class="sxs-lookup"><span data-stu-id="696c8-151">You can use the **/regfile** option to generate a .reg file that contains the registry entries instead of making the changes directly to the registry.</span></span> <span data-ttu-id="696c8-152">通过注册表编辑器工具 (Regedit.exe) 导入 .reg 文件，可以在计算机上更新注册表。</span><span class="sxs-lookup"><span data-stu-id="696c8-152">You can update the registry on a computer by importing the .reg file with the Registry Editor tool (Regedit.exe).</span></span> <span data-ttu-id="696c8-153">.reg 文件不包含任何可由用户定义的注册函数完成的注册表更新。</span><span class="sxs-lookup"><span data-stu-id="696c8-153">The .reg file does not contain any registry updates that can be made by user-defined register functions.</span></span> <span data-ttu-id="696c8-154">/regfile 选项只为托管类发出注册表项  。</span><span class="sxs-lookup"><span data-stu-id="696c8-154">The **/regfile** option only emits registry entries for managed classes.</span></span> <span data-ttu-id="696c8-155">此选项不为 `TypeLibID` 或 `InterfaceID` 发出注册表项。</span><span class="sxs-lookup"><span data-stu-id="696c8-155">This option does not emit entries for `TypeLibID`s or `InterfaceID`s.</span></span>

<span data-ttu-id="696c8-156">指定 /tlb 选项时，Regasm.exe 将生成并注册一个类型库，对在程序集中找到的类型进行描述  。</span><span class="sxs-lookup"><span data-stu-id="696c8-156">When you specify the **/tlb** option, Regasm.exe generates and registers a type library describing the types found in the assembly.</span></span> <span data-ttu-id="696c8-157">Regasm.exe 将生成的类型库放置在当前的工作目录中或为输出文件指定的目录中。</span><span class="sxs-lookup"><span data-stu-id="696c8-157">Regasm.exe places the generated type libraries in the current working directory or the directory specified for the output file.</span></span> <span data-ttu-id="696c8-158">为引用其他程序集的程序集生成类型库可能导致同时生成几个类型库。</span><span class="sxs-lookup"><span data-stu-id="696c8-158">Generating a type library for an assembly that references other assemblies may cause several type libraries to be generated at once.</span></span> <span data-ttu-id="696c8-159">你可使用类型库向开发工具（如 Visual Studio）提供类型信息。</span><span class="sxs-lookup"><span data-stu-id="696c8-159">You can use the type library to provide type information to development tools like Visual Studio.</span></span> <span data-ttu-id="696c8-160">如果所注册的程序集是由类型库导入程序 ([Tlbimp.exe](tlbimp-exe-type-library-importer.md)) 生成的，请勿使用 /tlb 选项  。</span><span class="sxs-lookup"><span data-stu-id="696c8-160">Don't use the **/tlb** option if the assembly you are registering was produced by the Type Library Importer ([Tlbimp.exe](tlbimp-exe-type-library-importer.md)).</span></span> <span data-ttu-id="696c8-161">如果程序集是从类型库导入的，则不能从它导出类型库。</span><span class="sxs-lookup"><span data-stu-id="696c8-161">You cannot export a type library from an assembly that was imported from a type library.</span></span> <span data-ttu-id="696c8-162">除了类型库导出程序 ([Tlbexp.exe](tlbexp-exe-type-library-exporter.md)) 不会注册其生成的类型库外，使用 /tlb 选项与使用 Tlbexp.exe 和 Regasm.exe 的效果相同  。</span><span class="sxs-lookup"><span data-stu-id="696c8-162">Using the **/tlb** option has the same effect as using the Type Library Exporter ([Tlbexp.exe](tlbexp-exe-type-library-exporter.md)) and Regasm.exe, with the exception that Tlbexp.exe does not register the type library it produces.</span></span>  <span data-ttu-id="696c8-163">如果使用 /tlb  选项注册某个类型库，则可将 /tlb  选项和 /unregister  选项一起使用以注销类型库。</span><span class="sxs-lookup"><span data-stu-id="696c8-163">If you use the **/tlb** option to register a type library, you can use the **/tlb** option with the **/unregister** option to unregister the type library.</span></span> <span data-ttu-id="696c8-164">将两个选项一起使用将注销类型库和接口项，这样可较大程度地清理注册表。</span><span class="sxs-lookup"><span data-stu-id="696c8-164">Using the two options together will unregister the type library and interface entries, which can clean the registry considerably.</span></span>

<span data-ttu-id="696c8-165">当你注册一个程序集供 COM 使用时，Regasm.exe 会在本地计算机上的注册表中添加一些项。</span><span class="sxs-lookup"><span data-stu-id="696c8-165">When you register an assembly for use by COM, Regasm.exe adds entries to the registry on the local computer.</span></span> <span data-ttu-id="696c8-166">具体而言，它将创建一些与版本相关的注册表键，从而允许在一台计算机上并行运行同一程序集的多个版本。</span><span class="sxs-lookup"><span data-stu-id="696c8-166">More specifically, it creates version-dependent registry keys that allow multiple versions of the same assembly to run side by side on a computer.</span></span> <span data-ttu-id="696c8-167">在第一次注册某个程序集时，将会为该程序集创建一个顶级键，并为特定版本创建一个唯一的子键。</span><span class="sxs-lookup"><span data-stu-id="696c8-167">The first time an assembly is registered, one top-level key is created for the assembly, and a unique subkey is created for the specific version.</span></span> <span data-ttu-id="696c8-168">每次注册该程序集的新版本时，Regasm.exe 都将为新版本创建一个子键。</span><span class="sxs-lookup"><span data-stu-id="696c8-168">Each time you register a new version of the assembly, Regasm.exe creates a subkey for the new version.</span></span>

<span data-ttu-id="696c8-169">例如，假设你注册了一个版本为 1.0.0.0 的托管组件 myComp.dll 供 COM 使用。</span><span class="sxs-lookup"><span data-stu-id="696c8-169">For example, consider a scenario where you register the managed component, myComp.dll, version 1.0.0.0 for use by COM.</span></span> <span data-ttu-id="696c8-170">之后，你注册了版本为 2.0.0.0 的 myComp.dll。</span><span class="sxs-lookup"><span data-stu-id="696c8-170">Later, you register myComp.dll, version 2.0.0.0.</span></span> <span data-ttu-id="696c8-171">你确定计算机上的所有 COM 客户端应用程序都要使用 2.0.0.0 版本的 myComp.dll，并且决定注销 myComponent.dll 版本 1.0.0.0。</span><span class="sxs-lookup"><span data-stu-id="696c8-171">You determine that all COM client applications on the computer are using myComp.dll version 2.0.0.0 and you decide to unregister myComponent.dll version 1.0.0.0.</span></span> <span data-ttu-id="696c8-172">此注册表方案允许你注销 myComp.dll 版本 1.0.0.0，这是因为注销操作只移除 1.0.0.0 版本子键。</span><span class="sxs-lookup"><span data-stu-id="696c8-172">This registry scheme allows you to unregister myComp.dll version 1.0.0.0 because only the version 1.0.0.0 subkey is removed.</span></span>

<span data-ttu-id="696c8-173">使用 Regasm.exe 注册一个程序集之后，可以将该程序集安装在[全局程序集缓存](../app-domains/gac.md)中，以便可以从任何 COM 客户端激活它。</span><span class="sxs-lookup"><span data-stu-id="696c8-173">After registering an assembly using Regasm.exe, you can install it in the [global assembly cache](../app-domains/gac.md) so that it can be activated from any COM client.</span></span> <span data-ttu-id="696c8-174">如果该程序集将仅由单个应用程序激活，则可以将其放置在该应用程序的目录中。</span><span class="sxs-lookup"><span data-stu-id="696c8-174">If the assembly is only going to be activated by a single application, you can place it in that application's directory.</span></span>

## <a name="examples"></a><span data-ttu-id="696c8-175">示例</span><span class="sxs-lookup"><span data-stu-id="696c8-175">Examples</span></span>

<span data-ttu-id="696c8-176">下面的命令将注册 `myTest.dll` 中包含的所有公共类。</span><span class="sxs-lookup"><span data-stu-id="696c8-176">The following command registers all public classes contained in `myTest.dll`.</span></span>

```console
regasm myTest.dll
```

<span data-ttu-id="696c8-177">下面的命令生成包含所有必要的注册表项的 `myTest.reg` 文件。</span><span class="sxs-lookup"><span data-stu-id="696c8-177">The following command generates the file `myTest.reg`, which contains all the necessary registry entries.</span></span> <span data-ttu-id="696c8-178">此命令不更新注册表。</span><span class="sxs-lookup"><span data-stu-id="696c8-178">This command does not update the registry.</span></span>

```console
regasm myTest.dll /regfile:myTest.reg
```

<span data-ttu-id="696c8-179">下面的命令注册 `myTest.dll` 中包含的所有公共类，并生成和注册类型库 `myTest.tlb`，该类型库包含 `myTest.dll` 中定义的所有公共类型的定义。</span><span class="sxs-lookup"><span data-stu-id="696c8-179">The following command registers all public classes contained in `myTest.dll`, and generates and registers the type library `myTest.tlb`, which contains definitions of all the public types defined in `myTest.dll`.</span></span>

```console
regasm myTest.dll /tlb:myTest.tlb
```

## <a name="see-also"></a><span data-ttu-id="696c8-180">请参阅</span><span class="sxs-lookup"><span data-stu-id="696c8-180">See also</span></span>

- [<span data-ttu-id="696c8-181">工具</span><span class="sxs-lookup"><span data-stu-id="696c8-181">Tools</span></span>](index.md)
- [<span data-ttu-id="696c8-182">Tlbexp.exe（类型库导出程序）</span><span class="sxs-lookup"><span data-stu-id="696c8-182">Tlbexp.exe (Type Library Exporter)</span></span>](tlbexp-exe-type-library-exporter.md)
- [<span data-ttu-id="696c8-183">Tlbimp.exe（类型库导入程序）</span><span class="sxs-lookup"><span data-stu-id="696c8-183">Tlbimp.exe (Type Library Importer)</span></span>](tlbimp-exe-type-library-importer.md)
- [<span data-ttu-id="696c8-184">向 COM 注册程序集</span><span class="sxs-lookup"><span data-stu-id="696c8-184">Registering Assemblies with COM</span></span>](../interop/registering-assemblies-with-com.md)
- [<span data-ttu-id="696c8-185">开发人员命令行 shell</span><span class="sxs-lookup"><span data-stu-id="696c8-185">Developer command-line shells</span></span>](/visualstudio/ide/reference/command-prompt-powershell)

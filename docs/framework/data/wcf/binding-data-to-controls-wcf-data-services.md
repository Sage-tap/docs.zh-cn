---
description: '了解详细信息：将数据绑定到控件 (WCF Data Services) '
title: 将数据绑定到控件（WCF 数据服务）
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- client applications, WCF Data Services
- WCF Data Services, client library
- data binding, WCF Data Services
ms.assetid: b32e1d49-c214-4cb1-867e-88fbb3d08c8d
ms.openlocfilehash: 01ef24c2723bb690a8f441a315085c4312307b03
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/06/2021
ms.locfileid: "99766473"
---
# <a name="binding-data-to-controls-wcf-data-services"></a><span data-ttu-id="81809-103">将数据绑定到控件（WCF 数据服务）</span><span class="sxs-lookup"><span data-stu-id="81809-103">Binding Data to Controls (WCF Data Services)</span></span>

[!INCLUDE [wcf-deprecated](~/includes/wcf-deprecated.md)]

<span data-ttu-id="81809-104">使用 WCF Data Services，可以将控件（如 `ComboBox` 和控件）绑定 `ListView` 到类的实例 <xref:System.Data.Services.Client.DataServiceCollection%601> 。</span><span class="sxs-lookup"><span data-stu-id="81809-104">With WCF Data Services, you can bind controls such as the `ComboBox` and `ListView` controls to an instance of the <xref:System.Data.Services.Client.DataServiceCollection%601> class.</span></span> <span data-ttu-id="81809-105">此集合继承自 <xref:System.Collections.ObjectModel.ObservableCollection%601> 类，包含 Open Data Protocol (OData) 源的数据。</span><span class="sxs-lookup"><span data-stu-id="81809-105">This collection, which inherits from the <xref:System.Collections.ObjectModel.ObservableCollection%601> class, contains the data from an Open Data Protocol (OData) feed.</span></span> <span data-ttu-id="81809-106">此类表示一个动态数据集合，在添加项或移除项时，此集合将提供通知。</span><span class="sxs-lookup"><span data-stu-id="81809-106">This class represents a dynamic data collection that provides notifications when items get added or removed.</span></span> <span data-ttu-id="81809-107">当你使用 <xref:System.Data.Services.Client.DataServiceCollection%601> 的实例进行数据绑定时，WCF Data Services 的客户端库将处理这些事件，以确保由跟踪的对象 <xref:System.Data.Services.Client.DataServiceContext> 与绑定 UI 元素中的数据保持同步。</span><span class="sxs-lookup"><span data-stu-id="81809-107">When you use an instance of <xref:System.Data.Services.Client.DataServiceCollection%601> for data binding, the WCF Data Services client libraries handle these events to ensure that objects tracked by the <xref:System.Data.Services.Client.DataServiceContext> remain synchronized with the data in the bound UI element.</span></span>  
  
 <span data-ttu-id="81809-108"><xref:System.Data.Services.Client.DataServiceCollection%601> 类（间接）实现 <xref:System.Collections.Specialized.INotifyCollectionChanged> 接口以从集合中添加或移除对象时警告上下文。</span><span class="sxs-lookup"><span data-stu-id="81809-108">The <xref:System.Data.Services.Client.DataServiceCollection%601> class (indirectly) implements the <xref:System.Collections.Specialized.INotifyCollectionChanged> interface to alert the context when objects are added to or removed from the collection.</span></span> <span data-ttu-id="81809-109">与 <xref:System.Data.Services.Client.DataServiceCollection%601> 一起使用的数据服务类型对象还必须实现 <xref:System.ComponentModel.INotifyPropertyChanged> 接口，才能在绑定集合中对象的属性发生更改时警告 <xref:System.Data.Services.Client.DataServiceCollection%601>。</span><span class="sxs-lookup"><span data-stu-id="81809-109">Data service type objects used with a <xref:System.Data.Services.Client.DataServiceCollection%601> must also implement the <xref:System.ComponentModel.INotifyPropertyChanged> interface to alert the <xref:System.Data.Services.Client.DataServiceCollection%601> when properties of objects in the binding collection have changed.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="81809-110">当你使用 **添加服务引用** 对话框或具有 [](wcf-data-service-client-utility-datasvcutil-exe.md) `/dataservicecollection` 生成客户端数据服务类的选项的DataSvcUtil.exe工具时，生成的数据类将实现 <xref:System.ComponentModel.INotifyPropertyChanged> 接口。</span><span class="sxs-lookup"><span data-stu-id="81809-110">When you use the **Add Service Reference** dialog or the [DataSvcUtil.exe](wcf-data-service-client-utility-datasvcutil-exe.md) tool with the `/dataservicecollection` option to generate the client data service classes, the generated data classes implement the <xref:System.ComponentModel.INotifyPropertyChanged> interface.</span></span> <span data-ttu-id="81809-111">有关详细信息，请参阅 [如何：手动生成客户端数据服务类](how-to-manually-generate-client-data-service-classes-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="81809-111">For more information, see [How to: Manually Generate Client Data Service Classes](how-to-manually-generate-client-data-service-classes-wcf-data-services.md).</span></span>  
  
## <a name="creating-the-binding-collection"></a><span data-ttu-id="81809-112">创建绑定集合</span><span class="sxs-lookup"><span data-stu-id="81809-112">Creating the Binding Collection</span></span>  

 <span data-ttu-id="81809-113">可以通过使用提供的 <xref:System.Data.Services.Client.DataServiceCollection%601> 实例调用其中一个类构造函数方法创建 <xref:System.Data.Services.Client.DataServiceContext> 类的新实例，还可以创建 <xref:System.Data.Services.Client.DataServiceQuery%601> 或返回 <xref:System.Collections.Generic.IEnumerable%601> 实例的 LINQ 查询（执行时）。</span><span class="sxs-lookup"><span data-stu-id="81809-113">Create a new instance of the <xref:System.Data.Services.Client.DataServiceCollection%601> class by calling one of the class constructor methods with a supplied <xref:System.Data.Services.Client.DataServiceContext> instance and optionally a <xref:System.Data.Services.Client.DataServiceQuery%601> or LINQ query that, when it is executed, returns an <xref:System.Collections.Generic.IEnumerable%601> instance.</span></span> <span data-ttu-id="81809-114">这 <xref:System.Collections.Generic.IEnumerable%601> 提供了从 OData 源具体化的绑定集合的对象的源。</span><span class="sxs-lookup"><span data-stu-id="81809-114">This <xref:System.Collections.Generic.IEnumerable%601> provides the source of objects for the binding collection, which are materialized from an OData feed.</span></span> <span data-ttu-id="81809-115">有关详细信息，请参阅 [对象具体化](object-materialization-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="81809-115">For more information, see [Object Materialization](object-materialization-wcf-data-services.md).</span></span> <span data-ttu-id="81809-116">默认情况下，对绑定对象所做的更改和插入到集合的项自动由 <xref:System.Data.Services.Client.DataServiceContext> 跟踪。</span><span class="sxs-lookup"><span data-stu-id="81809-116">By default, changes made to bound objects and items inserted into the collection are automatically tracked by the <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="81809-117">如果需要手动跟踪这些更改，请调用采用参数的构造函数方法之一， `trackingMode` 并将值指定为 <xref:System.Data.Services.Client.TrackingMode.None> 。</span><span class="sxs-lookup"><span data-stu-id="81809-117">If you need to manually track these changes, call one of the constructor methods that takes a `trackingMode` parameter and specify a value of <xref:System.Data.Services.Client.TrackingMode.None>.</span></span>  
  
 <span data-ttu-id="81809-118">下面的示例演示如何基于提供的 <xref:System.Data.Services.Client.DataServiceCollection%601> 和返回具有相关订单的所有客户的 <xref:System.Data.Services.Client.DataServiceContext> 创建 <xref:System.Data.Services.Client.DataServiceQuery%601> 的实例：</span><span class="sxs-lookup"><span data-stu-id="81809-118">The following example shows how to create an instance of <xref:System.Data.Services.Client.DataServiceCollection%601> based on a supplied <xref:System.Data.Services.Client.DataServiceContext> and a <xref:System.Data.Services.Client.DataServiceQuery%601> that returns all customers with related orders:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#CustomersOrders2Binding](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorders2.cs#customersorders2binding)]
 [!code-vb[Astoria Northwind Client#CustomersOrders2Binding](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorders2.vb#customersorders2binding)]  
  
## <a name="binding-data-to-windows-presentation-foundation-elements"></a><span data-ttu-id="81809-119">将数据绑定到 Windows Presentation Foundation 元素</span><span class="sxs-lookup"><span data-stu-id="81809-119">Binding Data to Windows Presentation Foundation Elements</span></span>  

 <span data-ttu-id="81809-120">因为 <xref:System.Data.Services.Client.DataServiceCollection%601> 类从 <xref:System.Collections.ObjectModel.ObservableCollection%601> 类继承，所以可以在 Windows Presentation Foundation (WPF) 应用程序中将对象绑定到元素或控件，像使用 <xref:System.Collections.ObjectModel.ObservableCollection%601> 类用于绑定时一样。</span><span class="sxs-lookup"><span data-stu-id="81809-120">Because the <xref:System.Data.Services.Client.DataServiceCollection%601> class inherits from the <xref:System.Collections.ObjectModel.ObservableCollection%601> class, you can bind objects to an element, or control, in a Windows Presentation Foundation (WPF) application as you would when using the <xref:System.Collections.ObjectModel.ObservableCollection%601> class for binding.</span></span> <span data-ttu-id="81809-121">有关详细信息，请参阅 [数据绑定 (Windows Presentation Foundation) ](/dotnet/desktop/wpf/data/data-binding-overview)。</span><span class="sxs-lookup"><span data-stu-id="81809-121">For more information, see [Data Binding (Windows Presentation Foundation)](/dotnet/desktop/wpf/data/data-binding-overview).</span></span> <span data-ttu-id="81809-122">将数据服务数据绑定到 WPF 控件的一种方法是将元素的 `DataContext` 属性设置为包含查询结果的 <xref:System.Data.Services.Client.DataServiceCollection%601> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="81809-122">One way to bind data service data to WPF controls is to set the `DataContext` property of the element to the instance of the <xref:System.Data.Services.Client.DataServiceCollection%601> class that contains the query result.</span></span> <span data-ttu-id="81809-123">在本例中，使用 <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> 属性设置该控件的对象源。</span><span class="sxs-lookup"><span data-stu-id="81809-123">In this case, you use the <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> property to set the object source for the control.</span></span> <span data-ttu-id="81809-124">使用 <xref:System.Windows.Controls.ItemsControl.DisplayMemberPath%2A> 属性指定要显示的绑定对象的属性。</span><span class="sxs-lookup"><span data-stu-id="81809-124">Use the <xref:System.Windows.Controls.ItemsControl.DisplayMemberPath%2A> property to specify which property of the bound object to display.</span></span> <span data-ttu-id="81809-125">若要将元素绑定到导航属性所返回的相关对象，请在为 <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> 属性定义的绑定中包含相应的路径。</span><span class="sxs-lookup"><span data-stu-id="81809-125">If you are binding an element to a related object that is returned by a navigation property, include the path in the binding defined for the <xref:System.Windows.Controls.ItemsControl.ItemsSource%2A> property.</span></span> <span data-ttu-id="81809-126">该路径相对于父控件的 <xref:System.Windows.FrameworkElement.DataContext%2A> 属性所设置的根对象。</span><span class="sxs-lookup"><span data-stu-id="81809-126">This path is relative to the root object set by the <xref:System.Windows.FrameworkElement.DataContext%2A> property of the parent control.</span></span> <span data-ttu-id="81809-127">下面的示例设置 <xref:System.Windows.FrameworkElement.DataContext%2A> 元素的 <xref:System.Windows.Controls.StackPanel> 属性以将父控件绑定到客户对象的 <xref:System.Data.Services.Client.DataServiceCollection%601>：</span><span class="sxs-lookup"><span data-stu-id="81809-127">The following example sets the <xref:System.Windows.FrameworkElement.DataContext%2A> property of a <xref:System.Windows.Controls.StackPanel> element to bind the parent control to an <xref:System.Data.Services.Client.DataServiceCollection%601> of customer objects:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#MasterDetailBinding](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorderscustom.xaml.cs#masterdetailbinding)]
 [!code-csharp[Astoria Northwind Client#MasterDetailBinding](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorderswpf.xaml.cs#masterdetailbinding)]
 [!code-vb[Astoria Northwind Client#MasterDetailBinding](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderscustom.xaml.vb#masterdetailbinding)]
 [!code-vb[Astoria Northwind Client#MasterDetailBinding](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderswpf.xaml.vb#masterdetailbinding)]
 [!code-vb[Astoria Northwind Client#MasterDetailBinding](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderscustom2.xaml.vb#masterdetailbinding)]  
  
 <span data-ttu-id="81809-128">下面的示例显示 <xref:System.Windows.Controls.DataGrid> 和 <xref:System.Windows.Controls.ComboBox> 子控件的 XAML 绑定定义：</span><span class="sxs-lookup"><span data-stu-id="81809-128">The following example shows the XAML binding definition of the child <xref:System.Windows.Controls.DataGrid> and <xref:System.Windows.Controls.ComboBox> controls:</span></span>  
  
 [!code-xaml[Astoria Northwind Client#MasterDetailXaml](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderswpf.xaml#masterdetailxaml)]  
  
 <span data-ttu-id="81809-129">有关详细信息，请参阅 [如何：将数据绑定到 Windows Presentation Foundation 元素](bind-data-to-wpf-elements-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="81809-129">For more information, see [How to: Bind Data to Windows Presentation Foundation Elements](bind-data-to-wpf-elements-wcf-data-services.md).</span></span>  
  
 <span data-ttu-id="81809-130">如果某实体参与一对多或多对多关系，该关系的导航属性返回相关对象的集合。</span><span class="sxs-lookup"><span data-stu-id="81809-130">When an entity participates in a one-to-many or many-to-many relationship, the navigation property for the relationship returns a collection of related objects.</span></span> <span data-ttu-id="81809-131">使用 " **添加服务引用** " 对话框或 DataSvcUtil.exe 工具来生成客户端数据服务类时，导航属性返回的实例 <xref:System.Data.Services.Client.DataServiceCollection%601> 。</span><span class="sxs-lookup"><span data-stu-id="81809-131">When you use the **Add Service Reference** dialog box or the DataSvcUtil.exe tool to generate the client data service classes, the navigation property returns an instance of <xref:System.Data.Services.Client.DataServiceCollection%601>.</span></span> <span data-ttu-id="81809-132">这使你可以将相关对象绑定到控件，并支持常见的 WPF 绑定方案，例如相关实体的主/从绑定模式。</span><span class="sxs-lookup"><span data-stu-id="81809-132">This enables you to bind related objects to a control, and support common WPF binding scenarios, such as the master-detail binding pattern for related entities.</span></span> <span data-ttu-id="81809-133">在上面的 XAML 示例中，XAML 代码将主 <xref:System.Data.Services.Client.DataServiceCollection%601> 绑定到根数据元素。</span><span class="sxs-lookup"><span data-stu-id="81809-133">In the previous XAML example, the XAML code binds the master <xref:System.Data.Services.Client.DataServiceCollection%601> to the root data element.</span></span> <span data-ttu-id="81809-134">然后订单 <xref:System.Windows.Controls.DataGrid> 绑定到从所选的 Customers 对象返回的订单 <xref:System.Data.Services.Client.DataServiceCollection%601>，后者又绑定到 <xref:System.Windows.Window> 的根数据元素。</span><span class="sxs-lookup"><span data-stu-id="81809-134">The order <xref:System.Windows.Controls.DataGrid> is then bound to the Orders <xref:System.Data.Services.Client.DataServiceCollection%601> returned from the selected Customers object, which is in turn bound to the root data element of the <xref:System.Windows.Window>.</span></span>  
  
## <a name="binding-data-to-windows-forms-controls"></a><span data-ttu-id="81809-135">将数据绑定到 Windows 窗体控件</span><span class="sxs-lookup"><span data-stu-id="81809-135">Binding Data to Windows Forms Controls</span></span>  

 <span data-ttu-id="81809-136">若要将对象绑定到 Windows 窗体控件，请将该控件的 `DataSource` 属性设置为包含查询结果的 <xref:System.Data.Services.Client.DataServiceCollection%601> 类的实例。</span><span class="sxs-lookup"><span data-stu-id="81809-136">To bind objects to a Windows Form control, set the `DataSource` property of the control to the instance of the <xref:System.Data.Services.Client.DataServiceCollection%601> class that contains the query result.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="81809-137">只有通过实现 <xref:System.Collections.Specialized.INotifyCollectionChanged> 和 <xref:System.ComponentModel.INotifyPropertyChanged> 接口侦听更改事件的控件才支持数据绑定。</span><span class="sxs-lookup"><span data-stu-id="81809-137">Data binding is only supported for controls that listen for change events by implementing the <xref:System.Collections.Specialized.INotifyCollectionChanged> and <xref:System.ComponentModel.INotifyPropertyChanged> interfaces.</span></span> <span data-ttu-id="81809-138">如果控件不支持这种类型的更改通知，则绑定控件中不会反映对基础 <xref:System.Data.Services.Client.DataServiceCollection%601> 所做的更改。</span><span class="sxs-lookup"><span data-stu-id="81809-138">When a control does not support this kind of change notification, changes that are made to the underlying <xref:System.Data.Services.Client.DataServiceCollection%601> are not reflected in the bound control.</span></span>  
  
 <span data-ttu-id="81809-139">下面的示例将 <xref:System.Data.Services.Client.DataServiceCollection%601> 绑定到 <xref:System.Windows.Forms.ComboBox> 控件：</span><span class="sxs-lookup"><span data-stu-id="81809-139">The following example binds an <xref:System.Data.Services.Client.DataServiceCollection%601> to a <xref:System.Windows.Forms.ComboBox> control:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#CustomersOrdersDataBindingSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorders.cs#customersordersdatabindingspecific)]
 [!code-vb[Astoria Northwind Client#CustomersOrdersDataBindingSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorders.vb#customersordersdatabindingspecific)]  
  
 <span data-ttu-id="81809-140">使用 " **添加服务引用** " 对话框生成客户端数据服务类时，还将创建基于生成的的项目数据源 <xref:System.Data.Services.Client.DataServiceContext> 。</span><span class="sxs-lookup"><span data-stu-id="81809-140">When you use the **Add Service Reference** dialog to generate the client data service classes, a project data source is also created that is based on the generated <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="81809-141">使用此数据源，你只需将项从 " **数据源** " 窗口拖到设计器上即可创建显示数据服务中的数据的 UI 元素或控件。</span><span class="sxs-lookup"><span data-stu-id="81809-141">With this data source, you can create UI elements or controls that display data from the data service simply by dragging items from the **Data Sources** window onto the designer.</span></span> <span data-ttu-id="81809-142">这些项将成为绑定到数据源的应用程序 UI 中的元素。</span><span class="sxs-lookup"><span data-stu-id="81809-142">These items become elements in the application UI that are bound to the data source.</span></span> <span data-ttu-id="81809-143">有关详细信息，请参阅 [如何：使用项目数据源绑定数据](how-to-bind-data-using-a-project-data-source-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="81809-143">For more information, see [How to: Bind Data Using a Project Data Source](how-to-bind-data-using-a-project-data-source-wcf-data-services.md).</span></span>  
  
## <a name="binding-paged-data"></a><span data-ttu-id="81809-144">绑定分页数据</span><span class="sxs-lookup"><span data-stu-id="81809-144">Binding Paged Data</span></span>  

 <span data-ttu-id="81809-145">可以配置数据服务来限制单个响应消息中返回的查询数据量。</span><span class="sxs-lookup"><span data-stu-id="81809-145">A data service can be configured to limit the amount of queried data that is returned in a single response message.</span></span> <span data-ttu-id="81809-146">有关详细信息，请参阅 [配置数据服务](configuring-the-data-service-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="81809-146">For more information, see [Configuring the Data Service](configuring-the-data-service-wcf-data-services.md).</span></span> <span data-ttu-id="81809-147">数据服务分页响应数据时，每个响应包含用于返回下一页结果的链接。</span><span class="sxs-lookup"><span data-stu-id="81809-147">When the data service is paging response data, each response contains a link that is used to return the next page of results.</span></span> <span data-ttu-id="81809-148">有关详细信息，请参阅 [加载延迟的内容](loading-deferred-content-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="81809-148">For more information, see [Loading Deferred Content](loading-deferred-content-wcf-data-services.md).</span></span> <span data-ttu-id="81809-149">在这种情况下，必须通过传递从 <xref:System.Data.Services.Client.DataServiceCollection%601.Load%2A> 属性获取的 URI，对 <xref:System.Data.Services.Client.DataServiceCollection%601> 调用 <xref:System.Data.Services.Client.DataServiceQueryContinuation.NextLinkUri%2A> 方法来显式加载页，如下面的示例所示：</span><span class="sxs-lookup"><span data-stu-id="81809-149">In this case, you must explicitly load pages by calling the <xref:System.Data.Services.Client.DataServiceCollection%601.Load%2A> method on the <xref:System.Data.Services.Client.DataServiceCollection%601> by passing the URI obtained from the <xref:System.Data.Services.Client.DataServiceQueryContinuation.NextLinkUri%2A> property, as in the following example:</span></span>  
  
 [!code-csharp[Astoria Northwind Client#BindPagedDataSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorderswpf3.xaml.cs#bindpageddataspecific)]
 [!code-vb[Astoria Northwind Client#BindPagedDataSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderswpf3.xaml.vb#bindpageddataspecific)]  
  
 <span data-ttu-id="81809-150">相关对象以类似方式进行加载。</span><span class="sxs-lookup"><span data-stu-id="81809-150">Related objects are loaded in a similar manner.</span></span> <span data-ttu-id="81809-151">有关详细信息，请参阅 [如何：将数据绑定到 Windows Presentation Foundation 元素](bind-data-to-wpf-elements-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="81809-151">For more information, see [How to: Bind Data to Windows Presentation Foundation Elements](bind-data-to-wpf-elements-wcf-data-services.md).</span></span>  
  
## <a name="customizing-data-binding-behaviors"></a><span data-ttu-id="81809-152">自定义数据绑定行为</span><span class="sxs-lookup"><span data-stu-id="81809-152">Customizing Data Binding Behaviors</span></span>  

 <span data-ttu-id="81809-153">使用 <xref:System.Data.Services.Client.DataServiceCollection%601> 类可以截获对集合进行更改时（例如正在添加或移除对象）和对集合中对象的属性进行更改时引发的事件。</span><span class="sxs-lookup"><span data-stu-id="81809-153">The <xref:System.Data.Services.Client.DataServiceCollection%601> class enables you to intercept the events raised when changes are made to the collection, such as an object being added or removed, and when changes are made to the properties of object in a collection.</span></span> <span data-ttu-id="81809-154">可以修改数据绑定事件以重写默认行为，该行为包括以下约束：</span><span class="sxs-lookup"><span data-stu-id="81809-154">You can modify the data binding events to override the default behavior, which includes the following constraints:</span></span>  
  
- <span data-ttu-id="81809-155">委托内未执行验证。</span><span class="sxs-lookup"><span data-stu-id="81809-155">No validation is performed within the delegates.</span></span>  
  
- <span data-ttu-id="81809-156">添加实体自动添加相关实体。</span><span class="sxs-lookup"><span data-stu-id="81809-156">Adding an entity automatically adds related entities.</span></span>  
  
- <span data-ttu-id="81809-157">删除实体不删除相关实体。</span><span class="sxs-lookup"><span data-stu-id="81809-157">Deleting an entity does not delete the related entities.</span></span>  
  
 <span data-ttu-id="81809-158">创建 <xref:System.Data.Services.Client.DataServiceCollection%601> 的新实例时，可以选择指定以下参数，定义对处理绑定对象更改后引发事件的方法的委托：</span><span class="sxs-lookup"><span data-stu-id="81809-158">When you create a new instance of <xref:System.Data.Services.Client.DataServiceCollection%601>, you have the option to specify the following parameters that define delegates to methods that handle the events raised when bound objects are changed:</span></span>  
  
- <span data-ttu-id="81809-159">`entityChanged` - 绑定对象的属性更改后调用的方法。</span><span class="sxs-lookup"><span data-stu-id="81809-159">`entityChanged` - a method that is called when the property of a bound object is changed.</span></span> <span data-ttu-id="81809-160">此 <xref:System.Func%602> 委托接受一个 <xref:System.Data.Services.Client.EntityChangedParams> 对象并返回一个布尔值，该值指示对 <xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A> 调用 <xref:System.Data.Services.Client.DataServiceContext> 这一默认行为是否仍应发生。</span><span class="sxs-lookup"><span data-stu-id="81809-160">This <xref:System.Func%602> delegate accepts an <xref:System.Data.Services.Client.EntityChangedParams> object and returns a Boolean value that indicates whether the default behavior, to call <xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A> on the <xref:System.Data.Services.Client.DataServiceContext>, should still occur.</span></span>  
  
- <span data-ttu-id="81809-161">`entityCollectionChanged` - 从绑定集合添加或移除对象时调用的方法。</span><span class="sxs-lookup"><span data-stu-id="81809-161">`entityCollectionChanged` - a method that is called when an object is added or removed from the binding collection.</span></span> <span data-ttu-id="81809-162">此 <xref:System.Func%602> 委托接受一个 <xref:System.Data.Services.Client.EntityCollectionChangedParams> 对象并返回一个布尔值，该值指示默认行为（即对 <xref:System.Data.Services.Client.DataServiceContext.AddObject%2A> 调用 <xref:System.Collections.Specialized.NotifyCollectionChangedAction.Add> 操作的 <xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A> 或 <xref:System.Collections.Specialized.NotifyCollectionChangedAction.Remove> 操作的 <xref:System.Data.Services.Client.DataServiceContext>）是否仍应发生。</span><span class="sxs-lookup"><span data-stu-id="81809-162">This <xref:System.Func%602> delegate accepts an <xref:System.Data.Services.Client.EntityCollectionChangedParams> object and returns a Boolean value that indicates whether the default behavior, to call <xref:System.Data.Services.Client.DataServiceContext.AddObject%2A> for an <xref:System.Collections.Specialized.NotifyCollectionChangedAction.Add> action or <xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A> for a <xref:System.Collections.Specialized.NotifyCollectionChangedAction.Remove> action on the <xref:System.Data.Services.Client.DataServiceContext>, should still occur.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="81809-163">WCF Data Services 不执行在这些委托中实现的自定义行为的验证。</span><span class="sxs-lookup"><span data-stu-id="81809-163">WCF Data Services performs no validation of the custom behaviors that you implement in these delegates.</span></span>  
  
 <span data-ttu-id="81809-164">在下面的示例中，自定义 <xref:System.Collections.Specialized.NotifyCollectionChangedAction.Remove> 操作以调用 <xref:System.Data.Services.Client.DataServiceContext.DeleteLink%2A> 和 <xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A> 方法来移除属于删除的 `Orders_Details` 实体的 `Orders` 实体。</span><span class="sxs-lookup"><span data-stu-id="81809-164">In the following example, the <xref:System.Collections.Specialized.NotifyCollectionChangedAction.Remove> action is customized to call the <xref:System.Data.Services.Client.DataServiceContext.DeleteLink%2A> and <xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A> method to remove `Orders_Details` entities that belong to a deleted `Orders` entity.</span></span> <span data-ttu-id="81809-165">执行此自定义操作的原因是，删除父实体时不会自动删除依赖实体。</span><span class="sxs-lookup"><span data-stu-id="81809-165">This custom action is performed because dependent entities are not automatically deleted when the parent entity is deleted.</span></span>  
  
 [!code-csharp[Astoria Northwind Client#CustomersOrdersDeleteRelated](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/customerorderscustom.xaml.cs#customersordersdeleterelated)]
 [!code-vb[Astoria Northwind Client#CustomersOrdersDeleteRelated](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderscustom.xaml.vb#customersordersdeleterelated)]
 [!code-vb[Astoria Northwind Client#CustomersOrdersDeleteRelated](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/customerorderscustom2.xaml.vb#customersordersdeleterelated)]  
  
 <span data-ttu-id="81809-166">有关详细信息，请参阅 [如何：自定义数据绑定行为](how-to-customize-data-binding-behaviors-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="81809-166">For more information, see [How to: Customize Data Binding Behaviors](how-to-customize-data-binding-behaviors-wcf-data-services.md).</span></span>  
  
 <span data-ttu-id="81809-167">使用 <xref:System.Data.Services.Client.DataServiceCollection%601> 方法从 <xref:System.Collections.ObjectModel.Collection%601.Remove%2A> 移除对象时的默认行为是，该对象还在 <xref:System.Data.Services.Client.DataServiceContext> 中标记为已删除。</span><span class="sxs-lookup"><span data-stu-id="81809-167">The default behavior when an object is removed from a <xref:System.Data.Services.Client.DataServiceCollection%601> by using the <xref:System.Collections.ObjectModel.Collection%601.Remove%2A> method is that the object is also marked as deleted in the <xref:System.Data.Services.Client.DataServiceContext>.</span></span> <span data-ttu-id="81809-168">若要更改此行为，可以在发生 `entityCollectionChanged` 事件时所调用的 <xref:System.Collections.Specialized.INotifyCollectionChanged.CollectionChanged> 参数中指定对方法的委托。</span><span class="sxs-lookup"><span data-stu-id="81809-168">To change this behavior, you can specify a delegate to a method in the `entityCollectionChanged` parameter that is called when the <xref:System.Collections.Specialized.INotifyCollectionChanged.CollectionChanged> event occurs.</span></span>  
  
## <a name="data-binding-with-custom-client-data-classes"></a><span data-ttu-id="81809-169">使用自定义客户端数据类的数据绑定</span><span class="sxs-lookup"><span data-stu-id="81809-169">Data Binding with Custom Client Data Classes</span></span>  

 <span data-ttu-id="81809-170">若要能够将对象加载到 <xref:System.Data.Services.Client.DataServiceCollection%601>，对象本身必须实现 <xref:System.ComponentModel.INotifyPropertyChanged> 接口。</span><span class="sxs-lookup"><span data-stu-id="81809-170">To be able to load objects into a <xref:System.Data.Services.Client.DataServiceCollection%601>, the objects themselves must implement the <xref:System.ComponentModel.INotifyPropertyChanged> interface.</span></span> <span data-ttu-id="81809-171">使用 " **添加服务引用** " 对话框或 [DataSvcUtil.exe](wcf-data-service-client-utility-datasvcutil-exe.md) 工具时生成的数据服务客户端类实现此接口。</span><span class="sxs-lookup"><span data-stu-id="81809-171">Data service client classes that are generated when you use the **Add Service Reference** dialog box or the [DataSvcUtil.exe](wcf-data-service-client-utility-datasvcutil-exe.md) tool implement this interface.</span></span> <span data-ttu-id="81809-172">如果提供你自己的客户端数据类，必须将其他类型的集合用于数据绑定。</span><span class="sxs-lookup"><span data-stu-id="81809-172">If you provide your own client data classes, you must use another type of collection for data binding.</span></span> <span data-ttu-id="81809-173">如果对象更改，必须在数据绑定控件中处理事件以调用 <xref:System.Data.Services.Client.DataServiceContext> 类的以下方法：</span><span class="sxs-lookup"><span data-stu-id="81809-173">When objects change, you must handle events in the data bound controls to call the following methods of the <xref:System.Data.Services.Client.DataServiceContext> class:</span></span>  
  
- <span data-ttu-id="81809-174"><xref:System.Data.Services.Client.DataServiceContext.AddObject%2A> - 新对象添加到集合时。</span><span class="sxs-lookup"><span data-stu-id="81809-174"><xref:System.Data.Services.Client.DataServiceContext.AddObject%2A> - when a new object is added to the collection.</span></span>  
  
- <span data-ttu-id="81809-175"><xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A> - 从集合中移除对象时。</span><span class="sxs-lookup"><span data-stu-id="81809-175"><xref:System.Data.Services.Client.DataServiceContext.DeleteObject%2A> - when an object is removed from the collection.</span></span>  
  
- <span data-ttu-id="81809-176"><xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A> - 在集合中的对象上更改属性时。</span><span class="sxs-lookup"><span data-stu-id="81809-176"><xref:System.Data.Services.Client.DataServiceContext.UpdateObject%2A> - when a property is changed on an object in the collection.</span></span>  
  
- <span data-ttu-id="81809-177"><xref:System.Data.Services.Client.DataServiceContext.AddLink%2A> - 对象添加到相关对象的集合时。</span><span class="sxs-lookup"><span data-stu-id="81809-177"><xref:System.Data.Services.Client.DataServiceContext.AddLink%2A> - when an object is added to a collection of related object.</span></span>  
  
- <span data-ttu-id="81809-178"><xref:System.Data.Services.Client.DataServiceContext.SetLink%2A> - 对象添加到相关对象的集合时。</span><span class="sxs-lookup"><span data-stu-id="81809-178"><xref:System.Data.Services.Client.DataServiceContext.SetLink%2A> - when an object is added to a collection of related objects.</span></span>  
  
 <span data-ttu-id="81809-179">有关详细信息，请参阅 [更新数据服务](updating-the-data-service-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="81809-179">For more information, see [Updating the Data Service](updating-the-data-service-wcf-data-services.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="81809-180">请参阅</span><span class="sxs-lookup"><span data-stu-id="81809-180">See also</span></span>

- [<span data-ttu-id="81809-181">如何：手动生成客户端数据服务类</span><span class="sxs-lookup"><span data-stu-id="81809-181">How to: Manually Generate Client Data Service Classes</span></span>](how-to-manually-generate-client-data-service-classes-wcf-data-services.md)
- [<span data-ttu-id="81809-182">如何：添加数据服务引用</span><span class="sxs-lookup"><span data-stu-id="81809-182">How to: Add a Data Service Reference</span></span>](how-to-add-a-data-service-reference-wcf-data-services.md)

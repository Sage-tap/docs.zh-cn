---
title: Mage.exe（清单生成和编辑工具）
description: 开始使用 Mage.exe（清单生成和编辑工具）。 此工具支持创建和编辑应用程序和部署清单。
ms.date: 12/06/2018
helpviewer_keywords:
- Manifest Generation and Editing tool
- Mage.exe
ms.assetid: 77dfe576-2962-407e-af13-82255df725a1
ms.openlocfilehash: ce3724271663163f26a34b6710b28503f7b0c52e
ms.sourcegitcommit: 9c589b25b005b9a7f87327646020eb85c3b6306f
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/06/2021
ms.locfileid: "102259923"
---
# <a name="mageexe-manifest-generation-and-editing-tool"></a><span data-ttu-id="d8b7b-104">Mage.exe（清单生成和编辑工具）</span><span class="sxs-lookup"><span data-stu-id="d8b7b-104">Mage.exe (Manifest Generation and Editing Tool)</span></span>

<span data-ttu-id="d8b7b-105">清单生成和编辑工具 (Mage.exe) 是一种命令行工具，可以支持创建和编辑应用程序和部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-105">The Manifest Generation and Editing Tool (*Mage.exe*) is a command-line tool that supports the creation and editing of application and deployment manifests.</span></span> <span data-ttu-id="d8b7b-106">可以从批脚本和其他基于 Windows 的应用程序（包括 ASP.NET 应用程序）运行命令行工具 Mage.exe。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-106">As a command-line tool, *Mage.exe* can be run from both batch scripts and other Windows-based applications, including ASP.NET applications.</span></span>

<span data-ttu-id="d8b7b-107">也可以使用一种图形应用程序 MageUI.exe 来代替 Mage.exe 。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-107">You can also use *MageUI.exe*, a graphical application, instead of *Mage.exe*.</span></span> <span data-ttu-id="d8b7b-108">有关详细信息，请参阅 [MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)](mageui-exe-manifest-generation-and-editing-tool-graphical-client.md)。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-108">For more information, see [MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)](mageui-exe-manifest-generation-and-editing-tool-graphical-client.md).</span></span>

<span data-ttu-id="d8b7b-109">此工具会自动随 Visual Studio 一起安装。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-109">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="d8b7b-110">若要运行该工具，请[对开发人员使用命令行 shell](/visualstudio/ide/reference/command-prompt-powershell)。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-110">To run the tool, use a [command-line shell for developers](/visualstudio/ide/reference/command-prompt-powershell).</span></span>

<span data-ttu-id="d8b7b-111">Mage.exe 和 MageUI.exe 的两个版本包含在 Visual Studio 中 。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-111">Two versions of *Mage.exe* and *MageUI.exe* are included with Visual Studio.</span></span> <span data-ttu-id="d8b7b-112">若要查看版本信息，请运行 MageUI.exe，依次选择“帮助”和“关于” 。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-112">To see version information, run *MageUI.exe*, select **Help**, and select **About**.</span></span> <span data-ttu-id="d8b7b-113">本文档介绍 Mage.exe 和 MageUI.exe 的 4.0.x.x 版本 。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-113">This documentation describes version 4.0.x.x of *Mage.exe* and *MageUI.exe*.</span></span>

## <a name="syntax"></a><span data-ttu-id="d8b7b-114">语法</span><span class="sxs-lookup"><span data-stu-id="d8b7b-114">Syntax</span></span>

```console
Mage [commands] [commandOptions]
```

## <a name="parameters"></a><span data-ttu-id="d8b7b-115">参数</span><span class="sxs-lookup"><span data-stu-id="d8b7b-115">Parameters</span></span>

<span data-ttu-id="d8b7b-116">下表显示了 Mage.exe 所支持的命令。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-116">The following table shows the commands supported by *Mage.exe*.</span></span> <span data-ttu-id="d8b7b-117">有关这些命令所支持的选项的详细信息，请参阅[新建和更新命令选项](#new-and-update-command-options)以及[签名命令选项](#sign-command-options)。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-117">For more information about the options supported by these commands, see [New and Update command options](#new-and-update-command-options) and [Sign command options](#sign-command-options).</span></span>

|<span data-ttu-id="d8b7b-118">命令</span><span class="sxs-lookup"><span data-stu-id="d8b7b-118">Command</span></span>|<span data-ttu-id="d8b7b-119">说明</span><span class="sxs-lookup"><span data-stu-id="d8b7b-119">Description</span></span>|
|-------------|-----------------|
|<span data-ttu-id="d8b7b-120">**-cc, ClearApplicationCache**</span><span class="sxs-lookup"><span data-stu-id="d8b7b-120">**-cc, ClearApplicationCache**</span></span>|<span data-ttu-id="d8b7b-121">清除所有仅联机应用程序的已下载应用程序缓存。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-121">Clears the downloaded application cache of all online-only applications.</span></span>|
|<span data-ttu-id="d8b7b-122">-n, -New fileType [newOptions]</span><span class="sxs-lookup"><span data-stu-id="d8b7b-122">**-n, -New** *fileType [newOptions]*</span></span>|<span data-ttu-id="d8b7b-123">创建给定类型的新文件。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-123">Creates a new file of the given type.</span></span> <span data-ttu-id="d8b7b-124">有效类型是：</span><span class="sxs-lookup"><span data-stu-id="d8b7b-124">Valid types are:</span></span><br /><br /> <span data-ttu-id="d8b7b-125">-   `Deployment`：创建新的部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-125">-   `Deployment`: Creates a new deployment manifest.</span></span><br /><span data-ttu-id="d8b7b-126">-   `Application`：创建新的应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-126">-   `Application`: Creates a new application manifest.</span></span><br /><br /> <span data-ttu-id="d8b7b-127">如果不使用此命令指定任何其他参数，此命令将使用合适的默认标记和特性值创建合适的类型的文件。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-127">If you do not specify any additional parameters with this command, it will create a file of the appropriate type, with appropriate default tags and attribute values.</span></span><br /><br /> <span data-ttu-id="d8b7b-128">使用 **-ToFile** 选项（如下表所示）可指定新文件的文件名和路径。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-128">Use the **-ToFile** option (see in the following table) to specify the file name and path of the new file.</span></span><br /><br /> <span data-ttu-id="d8b7b-129">使用“-FromDirectory”选项（如下表所示）可创建一个应用程序清单，应用程序的所有程序集都添加到该清单的 \<dependency> 部分。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-129">Use the **-FromDirectory** option (see in the following table) to create an application manifest with all of the assemblies for an application added to the \<dependency> section of the manifest.</span></span>|
|<span data-ttu-id="d8b7b-130">-u, -Update [filePath] [updateOptions]</span><span class="sxs-lookup"><span data-stu-id="d8b7b-130">**-u, -Update** *[filePath] [updateOptions]*</span></span>|<span data-ttu-id="d8b7b-131">对清单文件进行一项或多项更改。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-131">Makes one or more changes to a manifest file.</span></span> <span data-ttu-id="d8b7b-132">不需要指定正在编辑的文件的类型。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-132">You do not have to specify the type of file that you are editing.</span></span> <span data-ttu-id="d8b7b-133">Mage.exe 将使用一组试探法检查该文件，并确定该文件是部署清单还是应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-133">Mage.exe will examine the file by using a set of heuristics and determine whether it is a deployment manifest or an application manifest.</span></span><br /><br /> <span data-ttu-id="d8b7b-134">如果已经使用证书对某个文件进行签名， **-Update** 将会移除密钥签名块。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-134">If you have already signed a file with a certificate, **-Update** will remove the key signature block.</span></span> <span data-ttu-id="d8b7b-135">这是因为，密钥签名包含该文件的哈希，修改该文件会呈现无效的哈希。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-135">This is because the key signature contains a hash of the file, and modifying the file renders the hash invalid.</span></span><br /><br /> <span data-ttu-id="d8b7b-136">使用 **-ToFile** 选项（如下表所示）可指定新文件名和路径，而不是覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-136">Use the **-ToFile** option (see in the following table) to specify a new file name and path instead of overwriting the existing file.</span></span>|
|<span data-ttu-id="d8b7b-137">-s, -Sign `[signOptions]`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-137">**-s, -Sign** `[signOptions]`</span></span>|<span data-ttu-id="d8b7b-138">使用密钥对或 X509 证书对文件签名。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-138">Uses a key pair or X509 certificate to sign a file.</span></span> <span data-ttu-id="d8b7b-139">签名将作为 XML 元素插入文件内。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-139">Signatures are inserted as XML elements inside of the files.</span></span><br /><br /> <span data-ttu-id="d8b7b-140">在为指定 **-TimestampUri** 值的清单签名时，必须连接到 Internet。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-140">You must be connected to the Internet when signing a manifest that specifies a **-TimestampUri** value.</span></span>|
|<span data-ttu-id="d8b7b-141">-ver, -Verify [manifest-filename]</span><span class="sxs-lookup"><span data-stu-id="d8b7b-141">**-ver, -Verify** *[manifest-filename]*</span></span>|<span data-ttu-id="d8b7b-142">验证清单是否已正确签名。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-142">Verifies that the manifest is signed correctly.</span></span> <span data-ttu-id="d8b7b-143">不能与其他命令结合使用。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-143">Cannot be combined with other commands.</span></span> <br/><br/><span data-ttu-id="d8b7b-144">**可在 .NET Framework 4.7 及更高版本中使用。**</span><span class="sxs-lookup"><span data-stu-id="d8b7b-144">**Available in .NET Framework 4.7 and later versions.**</span></span>|
|<span data-ttu-id="d8b7b-145">-h, -?, -Help [verbose]</span><span class="sxs-lookup"><span data-stu-id="d8b7b-145">**-h, -?, -Help** *[verbose]*</span></span>|<span data-ttu-id="d8b7b-146">描述所有可用的命令及其选项。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-146">Describes all of the available commands and their options.</span></span> <span data-ttu-id="d8b7b-147">指定 `verbose` 可获得详细的帮助。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-147">Specify `verbose` to get detailed help.</span></span>|

## <a name="new-and-update-command-options"></a><span data-ttu-id="d8b7b-148">新建和更新命令选项</span><span class="sxs-lookup"><span data-stu-id="d8b7b-148">New and Update command options</span></span>

<span data-ttu-id="d8b7b-149">下表显示了 `-New` 和 `-Update` 命令支持的选项：</span><span class="sxs-lookup"><span data-stu-id="d8b7b-149">The following table shows the options supported by the `-New` and `-Update` commands:</span></span>

|<span data-ttu-id="d8b7b-150">选项</span><span class="sxs-lookup"><span data-stu-id="d8b7b-150">Options</span></span>|<span data-ttu-id="d8b7b-151">默认值</span><span class="sxs-lookup"><span data-stu-id="d8b7b-151">Default Value</span></span>|<span data-ttu-id="d8b7b-152">适用于</span><span class="sxs-lookup"><span data-stu-id="d8b7b-152">Applies To</span></span>|<span data-ttu-id="d8b7b-153">描述</span><span class="sxs-lookup"><span data-stu-id="d8b7b-153">Description</span></span>|
|-------------|-------------------|----------------|-----------------|
|<span data-ttu-id="d8b7b-154">**-a, -Algorithm**</span><span class="sxs-lookup"><span data-stu-id="d8b7b-154">**-a, -Algorithm**</span></span>|<span data-ttu-id="d8b7b-155">sha1RSA</span><span class="sxs-lookup"><span data-stu-id="d8b7b-155">sha1RSA</span></span>|<span data-ttu-id="d8b7b-156">应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-156">Application manifests.</span></span><br /><br /> <span data-ttu-id="d8b7b-157">部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-157">Deployment manifests.</span></span>|<span data-ttu-id="d8b7b-158">指定用来生成依赖项摘要的算法。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-158">Specifies the algorithm to generate dependency digests with.</span></span> <span data-ttu-id="d8b7b-159">值必须为“sha256RSA”或“sha1RSA。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-159">Value must be "sha256RSA" or "sha1RSA.</span></span><br /><br /> <span data-ttu-id="d8b7b-160">与“-Update”选项一起使用。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-160">Use with the "-Update" option.</span></span> <span data-ttu-id="d8b7b-161">在使用“-Sign”选项卡时，此选项将被忽略。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-161">This option is ignored when using the "-Sign" option</span></span>|
|<span data-ttu-id="d8b7b-162">-appc, -AppCodeBase `manifestReference`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-162">**-appc, -AppCodeBase** `manifestReference`</span></span>||<span data-ttu-id="d8b7b-163">部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-163">Deployment manifests.</span></span>|<span data-ttu-id="d8b7b-164">插入对应用程序清单文件的 URL 或文件路径引用。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-164">Inserts a URL or file path reference to the application manifest file.</span></span> <span data-ttu-id="d8b7b-165">此值必须是应用程序清单的完整路径。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-165">This value must be the full path to the application manifest.</span></span>|
|<span data-ttu-id="d8b7b-166">-appm, -AppManifest `manifestPath`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-166">**-appm, -AppManifest** `manifestPath`</span></span>||<span data-ttu-id="d8b7b-167">部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-167">Deployment manifests.</span></span>|<span data-ttu-id="d8b7b-168">将对部署的应用程序清单的引用插入其部署清单中。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-168">Inserts a reference to a deployment's application manifest into its deployment manifest.</span></span><br /><br /> <span data-ttu-id="d8b7b-169">`manifestPath` 指示的文件必须存在，否则，Mage.exe 将会发出一个错误。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-169">The file indicated by `manifestPath` must exist, or *Mage.exe* will issue an error.</span></span> <span data-ttu-id="d8b7b-170">如果 `manifestPath` 引用的文件不是应用程序清单，Mage.exe 将会发出一个错误。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-170">If the file referenced by `manifestPath` is not an application manifest, *Mage.exe* will issue an error.</span></span>|
|<span data-ttu-id="d8b7b-171">-cf, -CertFile `filePath`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-171">**-cf, -CertFile** `filePath`</span></span>||<span data-ttu-id="d8b7b-172">所有文件类型。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-172">All file types.</span></span>|<span data-ttu-id="d8b7b-173">指定用于签署清单或许可证文件的 X509 数字证书的位置。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-173">Specifies the location of an X509 digital certificate for signing a manifest or license file.</span></span> <span data-ttu-id="d8b7b-174">如果该证书需要个人信息交换 (PFX) 文件的密码，此选项可以与“-Password”选项结合使用。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-174">This option can be used in conjunction with the **-Password** option if the certificate requires a password for Personal Information Exchange (PFX) files.</span></span> <span data-ttu-id="d8b7b-175">自 .NET Framework 4.7 开始，如果文件不包含私钥，则需要结合使用 -CryptoProvider 和 -KeyContainer 选项。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-175">Starting with .NET Framework 4.7, if the file does not contain a private key, a combination of the **-CryptoProvider** and **-KeyContainer** options is required.</span></span><br/><br/><span data-ttu-id="d8b7b-176">自 .NET Framework 4.6.2 起，Mage.exe 使用 CNG 和 CAPI 证书对清单进行签名。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-176">Starting with .NET Framework 4.6.2, *Mage.exe* signs manifests with CNG as well as CAPI certificates.</span></span>|
|<span data-ttu-id="d8b7b-177">-ch, -CertHash `hashSignature`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-177">**-ch, -CertHash** `hashSignature`</span></span>||<span data-ttu-id="d8b7b-178">所有文件类型。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-178">All file types.</span></span>|<span data-ttu-id="d8b7b-179">存储在客户端计算机的个人证书存储中的数字证书的哈希。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-179">The hash of a digital certificate stored in the personal certificate store of the client computer.</span></span> <span data-ttu-id="d8b7b-180">此哈希对应于在 Windows 证书控制台中查看的数字证书的指纹字符串。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-180">This corresponds to the Thumbprint string of a digital certificate viewed in the Windows Certificates Console.</span></span><br /><br /> <span data-ttu-id="d8b7b-181">`hashSignature` 可以大写或小写，可以作为单个字符串提供，或者与指纹的每个八进制数一起提供（指纹的每个八进制数用空格分隔，并且整个指纹用引号引起来）。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-181">`hashSignature` can be either uppercase or lowercase, and can be supplied either as a single string, or with each octet of the Thumbprint separated by spaces and the entire Thumbprint enclosed in quotation marks.</span></span>|
|<span data-ttu-id="d8b7b-182">-csp, -CryptoProvider `provider-name`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-182">**-csp, -CryptoProvider** `provider-name`</span></span>||<span data-ttu-id="d8b7b-183">所有文件类型。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-183">All file types.</span></span>|<span data-ttu-id="d8b7b-184">指定包含私钥容器的加密服务提供程序 (CSP) 的名称。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-184">Specifies the name of a cryptographic service provider (CSP) that contains the private key container.</span></span> <span data-ttu-id="d8b7b-185">此选项需要 -KeyContainer 选项。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-185">This option requires the **-KeyContainer** option.</span></span><br/><br/><span data-ttu-id="d8b7b-186">自 .NET Framework 4.7 起，可以使用此选项。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-186">This option is available starting with .NET Framework 4.7.</span></span>|
|<span data-ttu-id="d8b7b-187">-fd, -FromDirectory `directoryPath`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-187">**-fd, -FromDirectory** `directoryPath`</span></span>||<span data-ttu-id="d8b7b-188">应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-188">Application manifests.</span></span>|<span data-ttu-id="d8b7b-189">使用 `directoryPath`（包括所有子目录）中的所有程序集和文件的说明填充应用程序清单，其中 `directoryPath` 是包含要部署的应用程序的目录。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-189">Populates the application manifest with descriptions of all assemblies and files found in `directoryPath`, including all subdirectories, where `directoryPath` is the directory that contains the application that you want to deploy.</span></span> <span data-ttu-id="d8b7b-190">对于该目录中的每个文件，Mage.exe 将确定该文件是程序集还是静态文件。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-190">For each file in the directory, *Mage.exe* decides whether the file is an assembly or a static file.</span></span> <span data-ttu-id="d8b7b-191">如果该文件是程序集，它将向应用程序添加 `<dependency>` 标记和 `installFrom` 特性以及程序集的名称、基本代码和版本。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-191">If it is an assembly, it adds a `<dependency>` tag and `installFrom` attribute to the application with the assembly's name, code base, and version.</span></span> <span data-ttu-id="d8b7b-192">如果该文件是静态文件，它将添加 `<file>` 标记。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-192">If it is a static file, it adds a `<file>` tag.</span></span> <span data-ttu-id="d8b7b-193">另外，Mage.exe 将通过一组简单的试探法检测应用程序的主要可执行文件，并在清单中将其标记为 ClickOnce 应用程序的入口点。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-193">*Mage.exe* will also use a simple set of heuristics to detect the main executable for the application, and will mark it as the ClickOnce application's entry point in the manifest.</span></span><br /><br /> <span data-ttu-id="d8b7b-194">Mage.exe 永远不会将某个文件自动标记为“数据”文件。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-194">*Mage.exe* will never automatically mark a file as a "data" file.</span></span> <span data-ttu-id="d8b7b-195">此项操作必须手动完成。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-195">You must do this manually.</span></span> <span data-ttu-id="d8b7b-196">有关详细信息，请参阅[如何：将数据文件添加到 ClickOnce 应用程序中](/visualstudio/deployment/how-to-include-a-data-file-in-a-clickonce-application)。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-196">For more information, see [How to: Include a Data File in a ClickOnce Application](/visualstudio/deployment/how-to-include-a-data-file-in-a-clickonce-application).</span></span><br /><br /> <span data-ttu-id="d8b7b-197">Mage.exe 还可以根据每个文件的大小为其生成哈希。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-197">*Mage.exe* also generates a hash for each file based on its size.</span></span> <span data-ttu-id="d8b7b-198">ClickOnce 使用这些哈希确保自创建清单以来无人篡改部署文件。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-198">ClickOnce uses these hashes to ensure that no one has tampered with the deployment's files since the manifest was created.</span></span> <span data-ttu-id="d8b7b-199">如果部署中的任何文件发生更改，可以将 Mage.exe 与“-Update”命令和“-FromDirectory”选项一起运行，Mage.exe 将更新所有引用文件的哈希和程序集版本 。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-199">If any of the files in your deployment change, you can run *Mage.exe* with the **-Update** command and the **-FromDirectory** option, and it will update the hashes and assembly versions of all referenced files.</span></span><br /><br /> <span data-ttu-id="d8b7b-200">**-FromDirectory** 将包括 `directoryPath`内所有子目录中的全部文件。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-200">**-FromDirectory** will include all files in all subdirectories found within `directoryPath`.</span></span><br /><br /> <span data-ttu-id="d8b7b-201">如果将“-FromDirectory”与“-Update”命令结合使用，Mage.exe 会从应用程序清单中移除该目录中不再存在的所有文件 。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-201">If you use **-FromDirectory** with the **-Update** command, *Mage.exe* will remove any files in the application manifest that no longer exist in the directory.</span></span>|
|<span data-ttu-id="d8b7b-202">-if, -IconFile  `filePath`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-202">**-if, -IconFile**  `filePath`</span></span>||<span data-ttu-id="d8b7b-203">应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-203">Application manifests.</span></span>|<span data-ttu-id="d8b7b-204">指定 .ICO 图标文件的完整路径。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-204">Specifies the full path to an .ICO icon file.</span></span> <span data-ttu-id="d8b7b-205">此图标显示在“开始”菜单中你的应用程序名称的旁边以及其对应的“添加或删除程序”项中。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-205">This icon appears beside your application name in the start menu, and in its Add-or-Remove Programs entry.</span></span> <span data-ttu-id="d8b7b-206">如果未提供图标，则使用默认图标。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-206">If no icon is provided, a default icon is used.</span></span>|
|<span data-ttu-id="d8b7b-207">-ip, -IncludeProviderURL  `url`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-207">**-ip, -IncludeProviderURL**  `url`</span></span>|<span data-ttu-id="d8b7b-208">true</span><span class="sxs-lookup"><span data-stu-id="d8b7b-208">true</span></span>|<span data-ttu-id="d8b7b-209">部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-209">Deployment manifests.</span></span>|<span data-ttu-id="d8b7b-210">指示部署清单是否包含由 **-ProviderURL** 设置的更新位置值。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-210">Indicates whether the deployment manifest includes the update location value set by **-ProviderURL**.</span></span>|
|<span data-ttu-id="d8b7b-211">-i, -Install `willInstall`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-211">**-i, -Install** `willInstall`</span></span>|<span data-ttu-id="d8b7b-212">true</span><span class="sxs-lookup"><span data-stu-id="d8b7b-212">true</span></span>|<span data-ttu-id="d8b7b-213">部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-213">Deployment manifests.</span></span>|<span data-ttu-id="d8b7b-214">指示 ClickOnce 应用程序是否应该安装到本地计算机上，或者该应用程序是否应通过 Web 运行。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-214">Indicates whether or not the ClickOnce application should install onto the local computer, or whether it should run from the Web.</span></span> <span data-ttu-id="d8b7b-215">安装某个应用程序后，该应用程序将会显示在 Windows 的 **“开始”** 菜单中。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-215">Installing an application gives that application a presence in the Windows **Start** menu.</span></span> <span data-ttu-id="d8b7b-216">有效值为“true”或“t”以及“false”或“f”。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-216">Valid values are "true" or "t", and "false" or "f".</span></span><br /><br /> <span data-ttu-id="d8b7b-217">如果指定 **-MinVersion** 选项，并且用户安装的版本低于 **-MinVersion** ，则无论向 **-Install** 传递何值，该选项都会强制安装应用程序。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-217">If you specify the **-MinVersion** option, and a user has a version less than **-MinVersion** installed, it will force the application to install, regardless of the value that you pass to **-Install**.</span></span><br /><br /> <span data-ttu-id="d8b7b-218">此选项不能与 **-BrowserHosted** 选项一起使用。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-218">This option cannot be used with the **-BrowserHosted** option.</span></span> <span data-ttu-id="d8b7b-219">尝试为同一清单同时指定这两个选项将会导致错误。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-219">Attempting to specify both for the same manifest will result in an error.</span></span>|
|<span data-ttu-id="d8b7b-220">-kc, -KeyContainer `name`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-220">**-kc, -KeyContainer** `name`</span></span>||<span data-ttu-id="d8b7b-221">所有文件类型。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-221">All file types.</span></span>|<span data-ttu-id="d8b7b-222">指定包含私钥名称的密钥容器。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-222">Specifies the key container that contains the name of the private key.</span></span> <span data-ttu-id="d8b7b-223">此选项需要 CyproProvider 选项。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-223">This option requires the **CryptoProvider** option.</span></span><br/><br/><span data-ttu-id="d8b7b-224">自 .NET Framework 4.7 起，可以使用此选项。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-224">This option is available starting with .NET Framework 4.7.</span></span>|
|<span data-ttu-id="d8b7b-225">-mv, -MinVersion  `[version]`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-225">**-mv, -MinVersion**  `[version]`</span></span>|<span data-ttu-id="d8b7b-226">由 **-Version** 标志指定的在 ClickOnce 部署清单中列出的版本。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-226">The version listed in the ClickOnce deployment manifest as specified by the **-Version** flag.</span></span>|<span data-ttu-id="d8b7b-227">部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-227">Deployment manifests.</span></span>|<span data-ttu-id="d8b7b-228">用户可以运行的此应用程序的最低版本。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-228">The minimum version of this application a user can run.</span></span> <span data-ttu-id="d8b7b-229">此标志使得你的应用程序的命名版本成为必需的更新。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-229">This flag makes the named version of your application a required update.</span></span> <span data-ttu-id="d8b7b-230">如果发布的产品版本存在对重大更改或严重的安全漏洞的更新，则可以使用此标志指定必须安装此更新，而且用户不能继续运行早期版本。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-230">If you release a version of your product with an update to a breaking change or a critical security flaw, you can use this flag to specify that this update must be installed, and that the user cannot continue to run earlier versions.</span></span><br /><br /> <span data-ttu-id="d8b7b-231">`version` 与 **-Version** 标志的自变量的语义相同。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-231">`version` has the same semantics as the argument to the **-Version** flag.</span></span>|
|<span data-ttu-id="d8b7b-232">-n, -Name `nameString`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-232">**-n, -Name** `nameString`</span></span>|<span data-ttu-id="d8b7b-233">部署</span><span class="sxs-lookup"><span data-stu-id="d8b7b-233">Deploy</span></span>|<span data-ttu-id="d8b7b-234">所有文件类型。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-234">All file types.</span></span>|<span data-ttu-id="d8b7b-235">用于标识应用程序的名称。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-235">The name that is used to identify the application.</span></span> <span data-ttu-id="d8b7b-236">ClickOnce 将使用此名称在“开始”菜单（如果应用程序配置为自行安装）和“权限提升”对话框中标识应用程序。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-236">ClickOnce will use this name to identify the application in the **Start** menu (if the application is configured to install itself) and in Permission Elevation dialog boxes.</span></span> <span data-ttu-id="d8b7b-237">注意：如果要更新现有的清单，并且未使用此选项指定发布服务器的名称，则 Mage.exe 将使用计算机上定义的组织名称更新清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-237">**Note:**  If you are updating an existing manifest and you do not specify a publisher name with this option, *Mage.exe* updates the manifest with the organization name defined on the computer.</span></span> <span data-ttu-id="d8b7b-238">要使用不同的名称，请确保使用此选项，并指定所需的发布服务器名称。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-238">To use a different name, make sure to use this option and specify the desired publisher name.</span></span>|
|<span data-ttu-id="d8b7b-239">-pwd, -Password `passwd`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-239">**-pwd, -Password** `passwd`</span></span>||<span data-ttu-id="d8b7b-240">所有文件类型。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-240">All file types.</span></span>|<span data-ttu-id="d8b7b-241">使用数字证书对清单进行签名时所用的密码。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-241">The password that is used for signing a manifest with a digital certificate.</span></span> <span data-ttu-id="d8b7b-242">必须与 **-CertFile** 选项结合使用。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-242">Must be used in conjunction with the **-CertFile** option.</span></span>|
|<span data-ttu-id="d8b7b-243">-p, Processor `processorValue`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-243">**-p, Processor** `processorValue`</span></span>|<span data-ttu-id="d8b7b-244">Msil</span><span class="sxs-lookup"><span data-stu-id="d8b7b-244">Msil</span></span>|<span data-ttu-id="d8b7b-245">应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-245">Application manifests.</span></span><br /><br /> <span data-ttu-id="d8b7b-246">部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-246">Deployment manifests.</span></span>|<span data-ttu-id="d8b7b-247">可用于运行此分发的微处理器体系结构。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-247">The microprocessor architecture on which this distribution will run.</span></span> <span data-ttu-id="d8b7b-248">如果你准备的一个或多个安装的程序集已针对特定微处理器进行了预编译，则此值是必需的。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-248">This value is required if you are preparing one or more installations whose assemblies have been precompiled for a specific microprocessor.</span></span> <span data-ttu-id="d8b7b-249">有效值包括 `msil`、 `x86`、 `ia64`和 `amd64`。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-249">Valid values include `msil`, `x86`, `ia64`, and `amd64`.</span></span> <span data-ttu-id="d8b7b-250">`msil` 是 Microsoft 中间语言，这表示所有程序集都与平台无关，并且首次运行应用程序时，公共语言运行时 (CLR) 将会对所有程序集进行实时编译。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-250">`msil` is Microsoft intermediate language, which means all of your assemblies are platform-independent, and the common language runtime (CLR) will just-in-time compile them when your application is first run.</span></span>|
|<span data-ttu-id="d8b7b-251">-pu, -ProviderURL `url` </span><span class="sxs-lookup"><span data-stu-id="d8b7b-251">**-pu,** **-ProviderURL** `url`</span></span>||<span data-ttu-id="d8b7b-252">部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-252">Deployment manifests.</span></span>|<span data-ttu-id="d8b7b-253">指定 ClickOnce 要检查是否存在应用程序更新的 URL。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-253">Specifies the URL which ClickOnce will examine for application updates.</span></span>|
|<span data-ttu-id="d8b7b-254">-pub, -Publisher `publisherName`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-254">**-pub, -Publisher** `publisherName`</span></span>||<span data-ttu-id="d8b7b-255">应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-255">Application manifests.</span></span><br /><br /> <span data-ttu-id="d8b7b-256">部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-256">Deployment manifests.</span></span>|<span data-ttu-id="d8b7b-257">将发布服务器名称添加到部署清单或应用程序清单的描述元素中。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-257">Adds the publisher name to the description element of either the deployment or application manifest.</span></span> <span data-ttu-id="d8b7b-258">在应用程序清单中使用时，还必须使用值 “true” 或 “t” 来指定 **-UseManifestForTrust** ，否则此参数将引发错误。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-258">When used on an application manifest, **-UseManifestForTrust** must also be specified with a value of "true" or "t"; otherwise, this parameter will raise an error.</span></span>|
|<span data-ttu-id="d8b7b-259">-s, -SupportURL  `url`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-259">**-s, -SupportURL**  `url`</span></span>||<span data-ttu-id="d8b7b-260">应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-260">Application manifests.</span></span><br /><br /> <span data-ttu-id="d8b7b-261">部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-261">Deployment manifests.</span></span>|<span data-ttu-id="d8b7b-262">指定在“添加或删除程序”对话框中为 ClickOnce 应用程序显示的链接。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-262">Specifies the link that appears in Add or Remove Programs for the ClickOnce application.</span></span>|
|<span data-ttu-id="d8b7b-263">-ti, -TimestampUri `uri`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-263">**-ti, -TimestampUri** `uri`</span></span>||<span data-ttu-id="d8b7b-264">应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-264">Application manifests.</span></span><br /><br /> <span data-ttu-id="d8b7b-265">部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-265">Deployment manifests.</span></span>|<span data-ttu-id="d8b7b-266">数字时间戳服务的 URL。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-266">The URL of a digital timestamping service.</span></span> <span data-ttu-id="d8b7b-267">如果数字证书在部署应用程序的下一个版本之前过期，为清单加盖时间戳可以让你不必对清单进行重新签名。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-267">Timestamping the manifests prevents you from having to re-sign the manifests should your digital certificate expire before you deploy the next version of your application.</span></span> <span data-ttu-id="d8b7b-268">有关详细信息，请参阅 [Windows 根证书计划成员](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn265983(v=ws.11))。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-268">For more information, see [Windows root certificate program members](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn265983(v=ws.11)).</span></span>|
|<span data-ttu-id="d8b7b-269">-t, -ToFile `filePath`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-269">**-t, -ToFile** `filePath`</span></span>|<span data-ttu-id="d8b7b-270">-   新建：</span><span class="sxs-lookup"><span data-stu-id="d8b7b-270">-   New:</span></span><br /><span data-ttu-id="d8b7b-271">-   部署：deploy.application</span><span class="sxs-lookup"><span data-stu-id="d8b7b-271">-   Deployment: deploy.application</span></span><br /><span data-ttu-id="d8b7b-272">-   应用程序：application.exe.manifest</span><span class="sxs-lookup"><span data-stu-id="d8b7b-272">-   Application: application.exe.manifest</span></span><br /><span data-ttu-id="d8b7b-273">-   更新：</span><span class="sxs-lookup"><span data-stu-id="d8b7b-273">-   Update:</span></span><br /><span data-ttu-id="d8b7b-274">-   输入文件。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-274">-   The input file.</span></span>|<span data-ttu-id="d8b7b-275">所有文件类型。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-275">All file types.</span></span>|<span data-ttu-id="d8b7b-276">指定已经创建或修改的文件的输出路径。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-276">Specifies the output path of the file that has been created or modified.</span></span><br /><br /> <span data-ttu-id="d8b7b-277">如果使用 **-New** 时未提供 **-ToFile**，则输出将写入到当前工作目录。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-277">If **-ToFile** is not supplied when you use **-New**, the output is written to the current working directory.</span></span> <span data-ttu-id="d8b7b-278">如果使用“-Update”时未提供“-ToFile”，Mage.exe 会将该文件写回到输入文件中 。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-278">If **-ToFile** is not supplied when you use **-Update**, *Mage.exe* will write the file back to the input file.</span></span>|
|<span data-ttu-id="d8b7b-279">-tr, -TrustLevel `level`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-279">**-tr, -TrustLevel** `level`</span></span>|<span data-ttu-id="d8b7b-280">基于应用程序 URL 所在的区域。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-280">Based on the zone in which the application URL resides.</span></span>|<span data-ttu-id="d8b7b-281">应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-281">Application manifests.</span></span>|<span data-ttu-id="d8b7b-282">要为客户端计算机上的应用程序授予的信任级别。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-282">The level of trust to grant the application on client computers.</span></span> <span data-ttu-id="d8b7b-283">值包括“Internet”、“Intranet”和“FullTrust”。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-283">Values include "Internet", "Intranet", and "FullTrust".</span></span>|
|<span data-ttu-id="d8b7b-284">-um, -UseManifestForTrust `willUseForTrust`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-284">**-um, -UseManifestForTrust** `willUseForTrust`</span></span>|<span data-ttu-id="d8b7b-285">False</span><span class="sxs-lookup"><span data-stu-id="d8b7b-285">False</span></span>|<span data-ttu-id="d8b7b-286">应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-286">Application manifests.</span></span>|<span data-ttu-id="d8b7b-287">指定当应用程序在客户端上运行时，是否使用应用程序清单的数字签名来做出信任决定。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-287">Specifies whether the digital signature of the application manifest will be used for making trust decisions when the application runs on the client.</span></span> <span data-ttu-id="d8b7b-288">如果指定“true”或“t”，则指示将使用应用程序清单来做出信任决定。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-288">Specifying "true" or "t" indicates that the application manifest will be used for trust decisions.</span></span> <span data-ttu-id="d8b7b-289">如果指定“false”或“f”，则指示将使用部署清单的签名。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-289">Specifying "false" or "f" indicates that the signature of the deployment manifest will be used.</span></span>|
|<span data-ttu-id="d8b7b-290">-v, -Version `versionNumber`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-290">**-v, -Version** `versionNumber`</span></span>|<span data-ttu-id="d8b7b-291">1.0.0.0</span><span class="sxs-lookup"><span data-stu-id="d8b7b-291">1.0.0.0</span></span>|<span data-ttu-id="d8b7b-292">应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-292">Application manifests.</span></span><br /><br /> <span data-ttu-id="d8b7b-293">部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-293">Deployment manifests.</span></span>|<span data-ttu-id="d8b7b-294">部署的版本。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-294">The version of the deployment.</span></span> <span data-ttu-id="d8b7b-295">参数必须是格式为“*N.N.N.N*”的有效版本字符串，其中，“*N*”是一个无符号的 32 位整数。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-295">The argument must be a valid version string of the format "*N.N.N.N*", where "*N*" is an unsigned 32-bit integer.</span></span>|
|<span data-ttu-id="d8b7b-296">-wpf, -WPFBrowserApp  `isWPFApp`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-296">**-wpf, -WPFBrowserApp**  `isWPFApp`</span></span>|<span data-ttu-id="d8b7b-297">false</span><span class="sxs-lookup"><span data-stu-id="d8b7b-297">false</span></span>|<span data-ttu-id="d8b7b-298">应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-298">Application manifests.</span></span><br /><br /> <span data-ttu-id="d8b7b-299">部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-299">Deployment manifests.</span></span>|<span data-ttu-id="d8b7b-300">仅当应用程序是将在 Internet Explorer 内承载的 Windows Presentation Foundation (WPF) 应用程序且不是独立的可执行文件时，才使用此标志。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-300">Use this flag only if the application is a Windows Presentation Foundation (WPF) application that will be hosted inside of Internet Explorer, and is not a stand-alone executable.</span></span> <span data-ttu-id="d8b7b-301">有效值为“true”或“t”以及“false”或“f”。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-301">Valid values are "true" or "t", and "false" or "f".</span></span><br /><br /> <span data-ttu-id="d8b7b-302">对于应用程序清单，请在应用程序清单的 `hostInBrowser` 元素下插入 `entryPoint` 特性。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-302">For application manifests, inserts the `hostInBrowser` attribute under the `entryPoint` element of the application manifest.</span></span><br /><br /> <span data-ttu-id="d8b7b-303">对于部署清单，请将 `install` 元素上的 `deployment` 特性设置为 false，并使用 .xbap 扩展名保存部署清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-303">For deployment manifests, sets the `install` attribute on the `deployment` element to false, and saves the deployment manifest with a .xbap extension.</span></span> <span data-ttu-id="d8b7b-304">同时指定此自变量与 **-Install** 自变量将产生一个错误，因为浏览器承载的应用程序不可以是已安装的脱机应用程序。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-304">Specifying this argument along with the **-Install** argument produces an error, because a browser-hosted application cannot be an installed, offline application.</span></span>|

## <a name="sign-command-options"></a><span data-ttu-id="d8b7b-305">签名命令选项</span><span class="sxs-lookup"><span data-stu-id="d8b7b-305">Sign command options</span></span>

<span data-ttu-id="d8b7b-306">下表显示了 `-Sign` 命令支持的选项。该命令适用于所有类型的文件。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-306">The following table shows the options supported by the `-Sign` command, which apply to all types of files.</span></span>

|<span data-ttu-id="d8b7b-307">选项</span><span class="sxs-lookup"><span data-stu-id="d8b7b-307">Options</span></span>|<span data-ttu-id="d8b7b-308">描述</span><span class="sxs-lookup"><span data-stu-id="d8b7b-308">Description</span></span>|
|-------------|-----------------|
|<span data-ttu-id="d8b7b-309">-cf, -CertFile `filePath`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-309">**-cf, -CertFile** `filePath`</span></span>|<span data-ttu-id="d8b7b-310">指定用于对清单进行签名的数字证书的位置。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-310">Specifies The location of a digital certificate for signing a manifest.</span></span> <span data-ttu-id="d8b7b-311">如果该证书需要个人信息交换 (PFX) 文件的密码，此选项可以与“-Password”选项结合使用。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-311">This option can be used in conjunction with the **-Password** option if the certificate requires a password for Personal Information Exchange (PFX) files.</span></span> <span data-ttu-id="d8b7b-312">自 .NET Framework 4.7 开始，如果文件不包含私钥，则需要结合使用 -CryptoProvider 和 -KeyContainer 选项。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-312">Starting with .NET Framework 4.7, if the file does not contain a private key, a combination of the **-CryptoProvider** and **-KeyContainer** options is required.</span></span><br/><br/><span data-ttu-id="d8b7b-313">自 .NET Framework 4.6.2 起，Mage.exe 使用 CNG 和 CAPI 证书对清单进行签名。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-313">Starting with .NET Framework 4.6.2, *Mage.exe* signs manifests with CNG as well as CAPI certificates.</span></span>|
|<span data-ttu-id="d8b7b-314">-ch, -CertHash `hashSignature`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-314">**-ch, -CertHash** `hashSignature`</span></span>|<span data-ttu-id="d8b7b-315">存储在客户端计算机的个人证书存储中的数字证书的哈希。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-315">The hash of a digital certificate stored in the personal certificate store of the client computer.</span></span> <span data-ttu-id="d8b7b-316">此哈希对应于在 Windows 证书控制台中查看的数字证书的指纹属性。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-316">This corresponds to the Thumbprint property of a digital certificate viewed in the Windows Certificates Console.</span></span><br /><br /> <span data-ttu-id="d8b7b-317">`hashSignature` 可以大写或小写，可以作为单个字符串提供，或者与指纹的每个八进制数一起提供（指纹的每个八进制数用空格分隔，并且整个指纹用引号引起来）。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-317">`hashSignature` can be either uppercase or lowercase, and can be supplied either as a single string or with each octet of the Thumbprint separated by spaces and the entire Thumbprint enclosed in quotation marks.</span></span>|
<span data-ttu-id="d8b7b-318">-csp, -CryptoProvider `provider-name`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-318">**-csp, -CryptoProvider** `provider-name`</span></span>|<span data-ttu-id="d8b7b-319">指定包含私钥容器的加密服务提供程序 (CSP) 的名称。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-319">Specifies the name of a cryptographic service provider (CSP) that contains the private key container.</span></span> <span data-ttu-id="d8b7b-320">此选项需要 -KeyContainer 选项。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-320">This option requires the **-KeyContainer** option.</span></span><br/><br/><span data-ttu-id="d8b7b-321">自 .NET Framework 4.7 起，可以使用此选项。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-321">This option is available starting with .NET Framework 4.7.</span></span>|
|<span data-ttu-id="d8b7b-322">-kc, -KeyContainer `name`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-322">**-kc, -KeyContainer** `name`</span></span>|<span data-ttu-id="d8b7b-323">指定包含私钥名称的密钥容器。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-323">Specifies the key container that contains the name of the private key.</span></span> <span data-ttu-id="d8b7b-324">此选项需要 CyproProvider 选项。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-324">This option requires the **CryptoProvider** option.</span></span><br/><br/><span data-ttu-id="d8b7b-325">自 .NET Framework 4.7 起，可以使用此选项。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-325">This option is available starting with .NET Framework 4.7.</span></span>|
|<span data-ttu-id="d8b7b-326">-pwd, -Password `passwd`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-326">**-pwd, -Password** `passwd`</span></span>|<span data-ttu-id="d8b7b-327">使用数字证书对清单进行签名时所用的密码。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-327">The password that is used for signing a manifest with a digital certificate.</span></span> <span data-ttu-id="d8b7b-328">必须与 **-CertFile** 选项结合使用。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-328">Must be used in conjunction with the **-CertFile** option.</span></span>|
|<span data-ttu-id="d8b7b-329">-t, -ToFile `filePath`</span><span class="sxs-lookup"><span data-stu-id="d8b7b-329">**-t, -ToFile** `filePath`</span></span>|<span data-ttu-id="d8b7b-330">指定已经创建或修改的文件的输出路径。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-330">Specifies the output path of the file that has been created or modified.</span></span>|

## <a name="remarks"></a><span data-ttu-id="d8b7b-331">备注</span><span class="sxs-lookup"><span data-stu-id="d8b7b-331">Remarks</span></span>

<span data-ttu-id="d8b7b-332">Mage.exe 的所有参数区分大小写。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-332">All arguments to *Mage.exe* are case-insensitive.</span></span> <span data-ttu-id="d8b7b-333">命令和选项的前缀可以是短划线 (-) 或正斜杠 (/)。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-333">Commands and options can be prefixed with a dash (-) or a forward slash (/).</span></span>

<span data-ttu-id="d8b7b-334">与 **-Sign** 命令结合使用的所有自变量也可以随时与 **-New** 或 **-Update** 命令结合使用。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-334">All of the arguments used with the **-Sign** command can be used at any time with the **-New** or **-Update** commands as well.</span></span> <span data-ttu-id="d8b7b-335">以下命令是等效的。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-335">The following commands are equivalent.</span></span>

```console
mage -Sign c:\HelloWorldDeployment\HelloWorld.deploy -CertFile cert.pfx
mage -Update c:\HelloWorldDeployment\HelloWorld.deploy -CertFile cert.pfx
```

> [!NOTE]
> <span data-ttu-id="d8b7b-336">从版本 .NET Framework 4.6.2 开始，还支持 CNG 证书。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-336">Beginning with .NET Framework version 4.6.2, CNG certificates are also supported.</span></span>

 <span data-ttu-id="d8b7b-337">签名是应该执行的最后一项任务，因为签名的文档使用文件的哈希验证签名是否为文档的有效签名。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-337">Signing is the last task you should perform, because a signed document uses a hash of the file to verify that the signature is valid for the document.</span></span> <span data-ttu-id="d8b7b-338">如果对签名的文件做出任何更改，则必须重新对该文件进行签名。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-338">If you make any changes to a signed file, you must sign it again.</span></span> <span data-ttu-id="d8b7b-339">如果对以前已经签名的文档进行签名，Mage.exe 将会使用新的签名替换原有的签名。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-339">If you sign a document that was previously signed, *Mage.exe* will replace the old signature with the new.</span></span>

 <span data-ttu-id="d8b7b-340">使用“-AppManifest”选项填充某个部署清单时，Mage.exe 会假定应用程序清单与部署清单位于同一个目录中（在一个用当前部署版本命名的子目录中），并对部署清单进行相应地配置。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-340">When you use the **-AppManifest** option to populate a deployment manifest, *Mage.exe* will assume that your application manifest will reside in the same directory as the deployment manifest within a subdirectory named after the current deployment version, and will configure your deployment manifest appropriately.</span></span> <span data-ttu-id="d8b7b-341">如果应用程序清单驻留在其他位置，请使用 **-AppCodeBase** 选项设置替代位置。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-341">If your application manifest will reside elsewhere, use the **-AppCodeBase** option to set the alternate location.</span></span>

 <span data-ttu-id="d8b7b-342">部署清单和应用程序清单必须在部署应用程序之前进行签名。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-342">Your deployment and application manifest must be signed before you deploy your application.</span></span> <span data-ttu-id="d8b7b-343">有关清单签名的指导，请参见 [Trusted Application Deployment Overview](/visualstudio/deployment/trusted-application-deployment-overview)。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-343">For guidance about signing manifests, see [Trusted Application Deployment Overview](/visualstudio/deployment/trusted-application-deployment-overview).</span></span>

 <span data-ttu-id="d8b7b-344">应用程序清单的 **-TrustLevel** 选项描述了应用程序在客户端计算机上运行时所需的权限集。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-344">The **-TrustLevel** option for application manifests describes the permission set an application requires to run on the client computer.</span></span> <span data-ttu-id="d8b7b-345">默认情况下，将根据应用程序的 URL 所在的 *区域* 指派应用程序的信任级别。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-345">By default, applications are assigned a trust level based on the *zone* in which their URL resides.</span></span> <span data-ttu-id="d8b7b-346">通过公司网络部署的应用程序一般放置在 Intranet 区域中，而那些通过 Internet 部署的应用程序放置在 Internet 区域中。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-346">Applications deployed over a corporate network are generally placed in the Intranet zone, while those deployed over the Internet are placed in the Internet zone.</span></span> <span data-ttu-id="d8b7b-347">这两个安全区域都会限制应用程序对本地资源的访问，Intranet 区域比 Internet 区域的权限稍大。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-347">Both security zones place restrictions on the application's access to local resources, with the Intranet zone slightly more permissive than the Internet zone.</span></span> <span data-ttu-id="d8b7b-348">FullTrust 区域授予应用程序对计算机本地资源的完全访问权限。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-348">The FullTrust zone gives applications complete access to a computer's local resources.</span></span> <span data-ttu-id="d8b7b-349">如果使用 -TrustLevel 选项将某个应用程序放置在此区域中，CLR 的信任关系管理器组件将会提示用户确定是否授予这种更高的信任级别。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-349">If you use the **-TrustLevel** option to place an application in this zone, the Trust Manager component of the CLR will prompt the user to decide whether they want to grant this higher level of trust.</span></span> <span data-ttu-id="d8b7b-350">如果通过公司网络部署应用程序，则可以使用“受信任的应用程序部署”提升该应用程序的信任级别，而无需对用户做出提示。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-350">If you are deploying your application over a corporate network, you can use Trusted Application Deployment to raise the trust level of the application without prompting the user.</span></span>

 <span data-ttu-id="d8b7b-351">应用程序清单还支持自定义信任部分。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-351">Application manifests also support custom trust sections.</span></span> <span data-ttu-id="d8b7b-352">这有助于应用程序遵守请求最低权限的安全原则，这是因为你可以对清单进行配置，使其只需要应用程序运行所需的那些特定权限。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-352">This helps your application obey the security principle of requesting least permission, as you can configure the manifest to demand only those specific permissions that the application requires in order to execute.</span></span> <span data-ttu-id="d8b7b-353">Mage.exe 不直接支持添加自定义信任部分。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-353">*Mage.exe* does not directly support adding a custom trust section.</span></span> <span data-ttu-id="d8b7b-354">可以使用文本编辑器、XML 分析器或图形工具 MageUI.exe 添加自定义信任部分。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-354">You can add one using a text editor, an XML parser, or the graphical tool *MageUI.exe*.</span></span> <span data-ttu-id="d8b7b-355">有关如何使用 MageUI.exe 添加自定义信任部分的详细信息，请参阅 [MageUI.exe（图形化客户端中的清单生成和编辑工具）](mageui-exe-manifest-generation-and-editing-tool-graphical-client.md)。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-355">For more information about how to use *MageUI.exe* to add custom trust sections, see [MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)](mageui-exe-manifest-generation-and-editing-tool-graphical-client.md).</span></span>

<span data-ttu-id="d8b7b-356">Visual Studio 2017 包括 4.6.1 版 Mage.exe。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-356">Visual Studio 2017 includes version 4.6.1 of *Mage.exe*.</span></span> <span data-ttu-id="d8b7b-357">使用此版本的 Mage.exe 创建的清单适用于 .NET Framework 4。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-357">Manifests created with this version of *Mage.exe* target .NET Framework 4.</span></span> <span data-ttu-id="d8b7b-358">若要以早期版本的 .NET Framework 为目标，请使用 Mage.exe 的早期版本。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-358">To target older versions of the .NET Framework, use an earlier version of *Mage.exe*.</span></span>

<span data-ttu-id="d8b7b-359">在现有清单中添加或移除程序集时，或者为现有清单重新签名时，Mage.exe 不会将清单更新为针对 .NET Framework 4。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-359">When you add or remove assemblies from an existing manifest, or re-sign an existing manifest, *Mage.exe* does not update the manifest to target .NET Framework 4.</span></span>

<span data-ttu-id="d8b7b-360">下表显示了这些功能和限制：</span><span class="sxs-lookup"><span data-stu-id="d8b7b-360">The following tables show these features and restrictions:</span></span>

|<span data-ttu-id="d8b7b-361">清单版本</span><span class="sxs-lookup"><span data-stu-id="d8b7b-361">Manifest version</span></span>|<span data-ttu-id="d8b7b-362">操作</span><span class="sxs-lookup"><span data-stu-id="d8b7b-362">Operation</span></span>|<span data-ttu-id="d8b7b-363">Mage v2.0</span><span class="sxs-lookup"><span data-stu-id="d8b7b-363">Mage v2.0</span></span>|<span data-ttu-id="d8b7b-364">Mage v4.0</span><span class="sxs-lookup"><span data-stu-id="d8b7b-364">Mage v4.0</span></span>|
|----------------------|---------------|---------------|---------------|
|<span data-ttu-id="d8b7b-365">面向 .NET Framework 2.0 版或 3.x. 版的应用程序的清单</span><span class="sxs-lookup"><span data-stu-id="d8b7b-365">Manifest for applications targeting version 2.0 or 3.x of the .NET Framework</span></span>|<span data-ttu-id="d8b7b-366">打开</span><span class="sxs-lookup"><span data-stu-id="d8b7b-366">Open</span></span>|<span data-ttu-id="d8b7b-367">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-367">OK</span></span>|<span data-ttu-id="d8b7b-368">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-368">OK</span></span>|
||<span data-ttu-id="d8b7b-369">关闭</span><span class="sxs-lookup"><span data-stu-id="d8b7b-369">Close</span></span>|<span data-ttu-id="d8b7b-370">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-370">OK</span></span>|<span data-ttu-id="d8b7b-371">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-371">OK</span></span>|
||<span data-ttu-id="d8b7b-372">保存</span><span class="sxs-lookup"><span data-stu-id="d8b7b-372">Save</span></span>|<span data-ttu-id="d8b7b-373">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-373">OK</span></span>|<span data-ttu-id="d8b7b-374">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-374">OK</span></span>|
||<span data-ttu-id="d8b7b-375">重新签名</span><span class="sxs-lookup"><span data-stu-id="d8b7b-375">Re-sign</span></span>|<span data-ttu-id="d8b7b-376">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-376">OK</span></span>|<span data-ttu-id="d8b7b-377">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-377">OK</span></span>|
||<span data-ttu-id="d8b7b-378">新建</span><span class="sxs-lookup"><span data-stu-id="d8b7b-378">New</span></span>|<span data-ttu-id="d8b7b-379">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-379">OK</span></span>|<span data-ttu-id="d8b7b-380">不支持</span><span class="sxs-lookup"><span data-stu-id="d8b7b-380">Not supported</span></span>|
||<span data-ttu-id="d8b7b-381">更新（如下所示）</span><span class="sxs-lookup"><span data-stu-id="d8b7b-381">Update (see below)</span></span>|<span data-ttu-id="d8b7b-382">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-382">OK</span></span>|<span data-ttu-id="d8b7b-383">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-383">OK</span></span>|
|<span data-ttu-id="d8b7b-384">面向 .NET Framework 版本 4 的应用程序的清单</span><span class="sxs-lookup"><span data-stu-id="d8b7b-384">Manifest for applications targeting version 4 of the .NET Framework</span></span>|<span data-ttu-id="d8b7b-385">打开</span><span class="sxs-lookup"><span data-stu-id="d8b7b-385">Open</span></span>|<span data-ttu-id="d8b7b-386">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-386">OK</span></span>|<span data-ttu-id="d8b7b-387">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-387">OK</span></span>|
||<span data-ttu-id="d8b7b-388">关闭</span><span class="sxs-lookup"><span data-stu-id="d8b7b-388">Close</span></span>|<span data-ttu-id="d8b7b-389">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-389">OK</span></span>|<span data-ttu-id="d8b7b-390">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-390">OK</span></span>|
||<span data-ttu-id="d8b7b-391">保存</span><span class="sxs-lookup"><span data-stu-id="d8b7b-391">Save</span></span>|<span data-ttu-id="d8b7b-392">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-392">OK</span></span>|<span data-ttu-id="d8b7b-393">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-393">OK</span></span>|
||<span data-ttu-id="d8b7b-394">重新签名</span><span class="sxs-lookup"><span data-stu-id="d8b7b-394">Re-sign</span></span>|<span data-ttu-id="d8b7b-395">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-395">OK</span></span>|<span data-ttu-id="d8b7b-396">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-396">OK</span></span>|
||<span data-ttu-id="d8b7b-397">新建</span><span class="sxs-lookup"><span data-stu-id="d8b7b-397">New</span></span>|<span data-ttu-id="d8b7b-398">不支持</span><span class="sxs-lookup"><span data-stu-id="d8b7b-398">Not supported</span></span>|<span data-ttu-id="d8b7b-399">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-399">OK</span></span>|
||<span data-ttu-id="d8b7b-400">更新（如下所示）</span><span class="sxs-lookup"><span data-stu-id="d8b7b-400">Update (see below)</span></span>|<span data-ttu-id="d8b7b-401">不支持</span><span class="sxs-lookup"><span data-stu-id="d8b7b-401">Not supported</span></span>|<span data-ttu-id="d8b7b-402">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-402">OK</span></span>|

|<span data-ttu-id="d8b7b-403">清单版本</span><span class="sxs-lookup"><span data-stu-id="d8b7b-403">Manifest version</span></span>|<span data-ttu-id="d8b7b-404">更新操作详细信息</span><span class="sxs-lookup"><span data-stu-id="d8b7b-404">Update Operation Details</span></span>|<span data-ttu-id="d8b7b-405">Mage v2.0</span><span class="sxs-lookup"><span data-stu-id="d8b7b-405">Mage v2.0</span></span>|<span data-ttu-id="d8b7b-406">Mage v4.0</span><span class="sxs-lookup"><span data-stu-id="d8b7b-406">Mage v4.0</span></span>|
|----------------------|------------------------------|---------------|---------------|
|<span data-ttu-id="d8b7b-407">面向 .NET Framework 2.0 版或 3.x. 版的应用程序的清单</span><span class="sxs-lookup"><span data-stu-id="d8b7b-407">Manifest for applications targeting version 2.0 or 3.x of the .NET Framework</span></span>|<span data-ttu-id="d8b7b-408">修改程序集</span><span class="sxs-lookup"><span data-stu-id="d8b7b-408">Modify an assembly</span></span>|<span data-ttu-id="d8b7b-409">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-409">OK</span></span>|<span data-ttu-id="d8b7b-410">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-410">OK</span></span>|
||<span data-ttu-id="d8b7b-411">添加程序集</span><span class="sxs-lookup"><span data-stu-id="d8b7b-411">Add an assembly</span></span>|<span data-ttu-id="d8b7b-412">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-412">OK</span></span>|<span data-ttu-id="d8b7b-413">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-413">OK</span></span>|
||<span data-ttu-id="d8b7b-414">删除程序集</span><span class="sxs-lookup"><span data-stu-id="d8b7b-414">Remove an assembly</span></span>|<span data-ttu-id="d8b7b-415">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-415">OK</span></span>|<span data-ttu-id="d8b7b-416">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-416">OK</span></span>|
|<span data-ttu-id="d8b7b-417">面向 .NET Framework 版本 4 的应用程序的清单</span><span class="sxs-lookup"><span data-stu-id="d8b7b-417">Manifest for applications targeting version 4 of the .NET Framework</span></span>|<span data-ttu-id="d8b7b-418">修改程序集</span><span class="sxs-lookup"><span data-stu-id="d8b7b-418">Modify an assembly</span></span>|<span data-ttu-id="d8b7b-419">不支持</span><span class="sxs-lookup"><span data-stu-id="d8b7b-419">Not supported</span></span>|<span data-ttu-id="d8b7b-420">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-420">OK</span></span>|
||<span data-ttu-id="d8b7b-421">添加程序集</span><span class="sxs-lookup"><span data-stu-id="d8b7b-421">Add an assembly</span></span>|<span data-ttu-id="d8b7b-422">不支持</span><span class="sxs-lookup"><span data-stu-id="d8b7b-422">Not supported</span></span>|<span data-ttu-id="d8b7b-423">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-423">OK</span></span>|
||<span data-ttu-id="d8b7b-424">删除程序集</span><span class="sxs-lookup"><span data-stu-id="d8b7b-424">Remove an assembly</span></span>|<span data-ttu-id="d8b7b-425">不支持</span><span class="sxs-lookup"><span data-stu-id="d8b7b-425">Not supported</span></span>|<span data-ttu-id="d8b7b-426">确定</span><span class="sxs-lookup"><span data-stu-id="d8b7b-426">OK</span></span>|

 <span data-ttu-id="d8b7b-427">Mage.exe 创建以 .NET Framework 4 Client Profile 为目标的新清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-427">Mage.exe creates new manifests that target the .NET Framework 4 Client Profile.</span></span> <span data-ttu-id="d8b7b-428">以 .NET Framework 4 Client Profile 为目标的 ClickOnce 应用程序可同时在 .NET Framework 4 Client Profile 和完整版的 .NET Framework 4 上运行。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-428">ClickOnce applications that target the .NET Framework 4 Client Profile can run on both the .NET Framework 4 Client Profile and the full version of the .NET Framework 4.</span></span> <span data-ttu-id="d8b7b-429">如果你的应用程序面向完整版的 .NET Framework 4 并且不能在 .NET Framework 4 Client Profile 上运行，请通过使用文本编辑器并对清单重新签名来删除客户端 `<framework>` 元素。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-429">If your application targets the full version of the .NET Framework 4 and cannot run on the .NET Framework 4 Client Profile, remove the client `<framework>` element by using a text editor and re-sign the manifest.</span></span>

<span data-ttu-id="d8b7b-430">下面是一个面向 .NET Framework 4 Client Profile 的示例 `<framework>` 元素：</span><span class="sxs-lookup"><span data-stu-id="d8b7b-430">The following is a sample `<framework>` element that targets the .NET Framework 4 Client Profile:</span></span>

```xml
<framework targetVersion="4.0" profile="client" supportedRuntime="4.0.20506" />
```

## <a name="examples"></a><span data-ttu-id="d8b7b-431">示例</span><span class="sxs-lookup"><span data-stu-id="d8b7b-431">Examples</span></span>

<span data-ttu-id="d8b7b-432">下面的示例将打开 Mage (MageUI.exe) 的用户界面。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-432">The following example opens the user interface for Mage (*MageUI.exe*).</span></span>

```console
mage
```

<span data-ttu-id="d8b7b-433">下面的示例将创建默认的部署清单和应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-433">The following examples create a default deployment manifest and application manifest.</span></span> <span data-ttu-id="d8b7b-434">这两个文件都在当前的工作目录中创建，并且分别命名为 deploy.application 和 application.exe.manifest。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-434">These files are all created in the current working directory and are named deploy.application and application.exe.manifest, respectively.</span></span>

```console
mage -New Deployment
mage -New Application
```

<span data-ttu-id="d8b7b-435">下面的示例将创建使用当前目录中的所有程序集和资源文件填充的应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-435">The following example creates an application manifest populated with all of the assemblies and resource files from the current directory.</span></span>

```console
mage -New Application -FromDirectory . -Version 1.0.0.0
```

<span data-ttu-id="d8b7b-436">下面的示例通过指定部署名称和目标微处理器继续前面的示例。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-436">The following example continues the previous example by specifying the deployment name and target microprocessor.</span></span> <span data-ttu-id="d8b7b-437">它还指定了 ClickOnce 检查更新时应该依据的 URL。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-437">It also specifies a URL against which ClickOnce should check for updates.</span></span>

```console
mage -New Application -FromDirectory . -Name "Hello, World! Application" -Version 1.0.0.0 -Processor "x86" -ProviderUrl http://internalserver/HelloWorld/
```

<span data-ttu-id="d8b7b-438">下面的示例演示如何创建一对清单，用于部署将在 Internet Explorer 中承载的 WPF 应用程序。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-438">The following example demonstrates how to create a pair of manifests for deploying a WPF application that will be hosted in Internet Explorer.</span></span>

```console
mage -New Application -FromDirectory . -Version 1.0.0.0 -WPFBrowserApp true
mage -New Deployment -AppManifest 1.0.0.0\application.manifest -WPFBrowserApp true
```

<span data-ttu-id="d8b7b-439">下面的示例将创建使用当前目录和签名中的所有程序集和资源文件填充的应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-439">The following example creates an application manifest populated with all of the assemblies and resource files from the current directory and signs.</span></span>

```console
mage -New Application -FromDirectory . -Version 1.0.0.0 -KeyContainer keypair.snk -CryptoProvider "Microsoft Enhanced Cryptographic Provider v1.0"
```

<span data-ttu-id="d8b7b-440">下面的示例使用应用程序清单中的信息更新部署清单，并为应用程序清单的位置设置基本代码。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-440">The following example updates a deployment manifest with information from an application manifest, and sets the code base for the location of the application manifest.</span></span>

```console
mage -Update HelloWorld.deploy -AppManifest 1.0.0.0\application.manifest -AppCodeBase http://internalserver/HelloWorld.deploy
```

<span data-ttu-id="d8b7b-441">下面的示例对部署清单进行编辑，以便强制更新用户已安装的版本。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-441">The following example edits the deployment manifest to force an update of the user's installed version.</span></span>

```console
mage -Update c:\HelloWorldDeployment\HelloWorld.deploy -MinVersion 1.1.0.0
```

<span data-ttu-id="d8b7b-442">下面的示例指示部署清单从其他目录中检索应用程序清单。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-442">The following example tells the deployment manifest to retrieve the application manifest from another directory.</span></span>

```console
mage -Update HelloWorld.deploy -AppCodeBase http://anotherserver/HelloWorld/1.1.0.0/
```

<span data-ttu-id="d8b7b-443">下面的示例使用当前工作目录中的数字证书对现有的部署清单进行签名。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-443">The following example signs an existing deployment manifest using a digital certificate in the current working directory.</span></span>

```console
mage -Sign deploy.application -CertFile cert.pfx -Password <passwd>
```

<span data-ttu-id="d8b7b-444">下面的示例使用当前工作目录中的数字证书和私钥对现有的部署清单进行签名。</span><span class="sxs-lookup"><span data-stu-id="d8b7b-444">The following example signs an existing deployment manifest using a digital certificate and private key in the current working directory.</span></span>

```console
mage -Sign deploy.application -CertFile cert.pfx -KeyContainer keyfile.snk -CryptoProvider "Microsoft Enhanced Cryptographic Provider v1.0"
```

## <a name="see-also"></a><span data-ttu-id="d8b7b-445">请参阅</span><span class="sxs-lookup"><span data-stu-id="d8b7b-445">See also</span></span>

- [<span data-ttu-id="d8b7b-446">ClickOnce 安全和部署</span><span class="sxs-lookup"><span data-stu-id="d8b7b-446">ClickOnce Security and Deployment</span></span>](/visualstudio/deployment/clickonce-security-and-deployment)
- [<span data-ttu-id="d8b7b-447">演练：手动部署 ClickOnce 应用程序</span><span class="sxs-lookup"><span data-stu-id="d8b7b-447">Walkthrough: Manually Deploying a ClickOnce Application</span></span>](/visualstudio/deployment/walkthrough-manually-deploying-a-clickonce-application)
- [<span data-ttu-id="d8b7b-448">受信任的应用程序部署概述</span><span class="sxs-lookup"><span data-stu-id="d8b7b-448">Trusted Application Deployment Overview</span></span>](/visualstudio/deployment/trusted-application-deployment-overview)
- [<span data-ttu-id="d8b7b-449">MageUI.exe（图形化客户端中的清单生成和编辑工具）</span><span class="sxs-lookup"><span data-stu-id="d8b7b-449">MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)</span></span>](mageui-exe-manifest-generation-and-editing-tool-graphical-client.md)
- [<span data-ttu-id="d8b7b-450">开发人员命令行 shell</span><span class="sxs-lookup"><span data-stu-id="d8b7b-450">Developer command-line shells</span></span>](/visualstudio/ide/reference/command-prompt-powershell)

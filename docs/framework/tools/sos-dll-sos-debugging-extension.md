---
title: SOS.dll（SOS 调试扩展）
description: 使用 SOS.dll（SOS 调试扩展）。 通过获取有关内部 CLR 环境的信息，在 Visual Studio 和 WinDbg.exe 中调试托管程序。
ms.date: 03/30/2017
helpviewer_keywords:
- debugging extensions
- SOS debugging extensions
- SOS.dll
ms.assetid: 9ac1b522-77ab-4cdc-852a-20fcdc9ae498
ms.openlocfilehash: 33f75003e18abce95778ddea8e3163211e3bfa5c
ms.sourcegitcommit: 1dbe25ff484a02025d5c34146e517c236f7161fb
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/19/2021
ms.locfileid: "104653629"
---
# <a name="sosdll-sos-debugging-extension"></a><span data-ttu-id="46b76-104">SOS.dll（SOS 调试扩展）</span><span class="sxs-lookup"><span data-stu-id="46b76-104">SOS.dll (SOS debugging extension)</span></span>

<span data-ttu-id="46b76-105">SOS 调试扩展 (SOS.dll) 通过提供有关内部公共语言运行时 (CLR) 环境的信息，帮助你在 Visual Studio 和 Windows 调试器 (WinDbg.exe) 中调试托管程序。</span><span class="sxs-lookup"><span data-stu-id="46b76-105">The SOS Debugging Extension (SOS.dll) helps you debug managed programs in Visual Studio and in the Windows debugger (WinDbg.exe) by providing information about the internal Common Language Runtime (CLR) environment.</span></span> <span data-ttu-id="46b76-106">此工具需要你启用项目的非托管调试。</span><span class="sxs-lookup"><span data-stu-id="46b76-106">This tool requires your project to have unmanaged debugging enabled.</span></span> <span data-ttu-id="46b76-107">SOS.dll 自动随 .NET Framework 一起安装。</span><span class="sxs-lookup"><span data-stu-id="46b76-107">SOS.dll is automatically installed with .NET Framework.</span></span> <span data-ttu-id="46b76-108">若要在 Visual Studio 中使用 SOS.dll，请安装 [Windows 驱动程序工具包 (WDK)](/windows-hardware/drivers/download-the-wdk)。</span><span class="sxs-lookup"><span data-stu-id="46b76-108">To use SOS.dll in Visual Studio, install the [Windows Driver Kit (WDK)](/windows-hardware/drivers/download-the-wdk).</span></span>

## <a name="syntax"></a><span data-ttu-id="46b76-109">语法</span><span class="sxs-lookup"><span data-stu-id="46b76-109">Syntax</span></span>

```console
![command] [options]
```

## <a name="commands"></a><span data-ttu-id="46b76-110">命令</span><span class="sxs-lookup"><span data-stu-id="46b76-110">Commands</span></span>

|<span data-ttu-id="46b76-111">命令</span><span class="sxs-lookup"><span data-stu-id="46b76-111">Command</span></span>|<span data-ttu-id="46b76-112">说明</span><span class="sxs-lookup"><span data-stu-id="46b76-112">Description</span></span>|
|-------------|-----------------|
|<span data-ttu-id="46b76-113">**AnalyzeOOM** (**ao**)</span><span class="sxs-lookup"><span data-stu-id="46b76-113">**AnalyzeOOM** (**ao**)</span></span>|<span data-ttu-id="46b76-114">显示对垃圾回收堆进行分配请求时发生的最后一次内存不足 (OOM) 的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-114">Displays the information for the last out of memory (OOM) that occurred on an allocation request to the garbage collection heap.</span></span> <span data-ttu-id="46b76-115">（在服务器垃圾回收中，它将在每个垃圾回收堆上显示 OOM（如果有））。</span><span class="sxs-lookup"><span data-stu-id="46b76-115">(In server garbage collection, it displays OOM, if any, on each garbage collection heap.)</span></span>|
|<span data-ttu-id="46b76-116">**BPMD** [ **-nofuturemodule**] [\<*module name*> \<*method name*>] [ **-md** <`MethodDesc`>] **-list** **-clear** \<*pending breakpoint number*> **-clearall**</span><span class="sxs-lookup"><span data-stu-id="46b76-116">**BPMD** [**-nofuturemodule**] [\<*module name*> \<*method name*>] [**-md** <`MethodDesc`>] **-list** **-clear** \<*pending breakpoint number*> **-clearall**</span></span>|<span data-ttu-id="46b76-117">在指定模块中的指定方法处创建断点。</span><span class="sxs-lookup"><span data-stu-id="46b76-117">Creates a breakpoint at the specified method in the specified module.</span></span><br /><br /> <span data-ttu-id="46b76-118">如果尚未加载指定的模块和方法，则此命令将在创建断点之前等待已加载并进行实时 (JIT) 编译的模块的通知。</span><span class="sxs-lookup"><span data-stu-id="46b76-118">If the specified module and method have not been loaded, this command waits for a notification that the module was loaded and just-in-time (JIT) compiled before creating a breakpoint.</span></span><br /><br /> <span data-ttu-id="46b76-119">可以通过使用 **-list**、 **-clear** 和 **-clearall** 选项来管理挂起断点的列表：</span><span class="sxs-lookup"><span data-stu-id="46b76-119">You can manage the list of pending breakpoints by using the **-list**, **-clear**, and **-clearall** options:</span></span><br /><br /> <span data-ttu-id="46b76-120">该 **-list** 选项生成所有挂起断点的列表。</span><span class="sxs-lookup"><span data-stu-id="46b76-120">The **-list** option generates a list of all the pending breakpoints.</span></span> <span data-ttu-id="46b76-121">如果挂起断点有一个非零模块 ID，则该断点特定于该特定已加载模块中的函数。</span><span class="sxs-lookup"><span data-stu-id="46b76-121">If a pending breakpoint has a non-zero module ID, that breakpoint is specific to a function in that particular loaded module.</span></span> <span data-ttu-id="46b76-122">如果挂起断点有一个零模块 ID，则该断点适用于尚未加载的模块。</span><span class="sxs-lookup"><span data-stu-id="46b76-122">If the pending breakpoint has a zero module ID, that breakpoint applies to modules that have not yet been loaded.</span></span><br /><br /> <span data-ttu-id="46b76-123">使用 **-clear** 或 **-clearall** 选项可从该列表中移除挂起断点。</span><span class="sxs-lookup"><span data-stu-id="46b76-123">Use the **-clear** or **-clearall** option to remove pending breakpoints from the list.</span></span>|
|<span data-ttu-id="46b76-124">**CLRStack** [ **-a**] [ **-l**] [ **-p**] [ **-n**]</span><span class="sxs-lookup"><span data-stu-id="46b76-124">**CLRStack** [**-a**] [**-l**] [**-p**] [**-n**]</span></span>|<span data-ttu-id="46b76-125">仅提供托管代码的堆栈跟踪。</span><span class="sxs-lookup"><span data-stu-id="46b76-125">Provides a stack trace of managed code only.</span></span><br /><br /> <span data-ttu-id="46b76-126">**-p** 选项显示托管函数的自变量。</span><span class="sxs-lookup"><span data-stu-id="46b76-126">The **-p** option shows arguments to the managed function.</span></span><br /><br /> <span data-ttu-id="46b76-127">**-l** 选项显示有关帧中的局部变量的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-127">The **-l** option shows information on local variables in a frame.</span></span> <span data-ttu-id="46b76-128">SOS 调试扩展无法检索本地名称，因此本地名称的输出采用的格式为 \<*local address*> **=** \<*value*>。</span><span class="sxs-lookup"><span data-stu-id="46b76-128">The SOS Debugging Extension cannot retrieve local names, so the output for local names is in the format \<*local address*> **=** \<*value*>.</span></span><br /><br /> <span data-ttu-id="46b76-129">-a（全部）选项是 -l 和 -p 组合的快捷方式。</span><span class="sxs-lookup"><span data-stu-id="46b76-129">The **-a**(all) option is a shortcut for **-l** and **-p** combined.</span></span><br /><br /> <span data-ttu-id="46b76-130">**-n** 选项禁止显示源文件名和行号。</span><span class="sxs-lookup"><span data-stu-id="46b76-130">The **-n** option disables the display of source file names and line numbers.</span></span> <span data-ttu-id="46b76-131">如果调试器已指定选项 SYMOPT_LOAD_LINES，则 SOS 将查找每个托管帧的符号，如果成功，则将显示对应的源文件名和行号。</span><span class="sxs-lookup"><span data-stu-id="46b76-131">If the debugger has the option SYMOPT_LOAD_LINES specified, SOS will look up the symbols for every managed frame and if successful will display the corresponding source file name and line number.</span></span> <span data-ttu-id="46b76-132">可以指定 **-n**（无行号）参数来禁用此行为。</span><span class="sxs-lookup"><span data-stu-id="46b76-132">The **-n** (No line numbers) parameter can be specified to disable this behavior.</span></span><br /><br /> <span data-ttu-id="46b76-133">在基于 x64 和 IA-64 的平台上，SOS 调试扩展不显示过渡帧。</span><span class="sxs-lookup"><span data-stu-id="46b76-133">The SOS Debugging Extension does not display transition frames on x64 and IA-64-based platforms.</span></span>|
|<span data-ttu-id="46b76-134">**COMState**</span><span class="sxs-lookup"><span data-stu-id="46b76-134">**COMState**</span></span>|<span data-ttu-id="46b76-135">列出每个线程的 COM 单元模型和 `Context` 指针（如果可用）。</span><span class="sxs-lookup"><span data-stu-id="46b76-135">Lists the COM apartment model for each thread and a `Context` pointer, if available.</span></span>|
|<span data-ttu-id="46b76-136">**DumpArray** [ **-start** \<*startIndex*>] [ **-length** \<*length*>] [ **-details**] [ **-nofields**] \<*array object address*></span><span class="sxs-lookup"><span data-stu-id="46b76-136">**DumpArray** [**-start** \<*startIndex*>] [**-length** \<*length*>] [**-details**] [**-nofields**] \<*array object address*></span></span><br /><br /> <span data-ttu-id="46b76-137">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="46b76-137">-or-</span></span><br /><br /> <span data-ttu-id="46b76-138">**DA** [ **-start** \<*startIndex*>] [ **-length** \<*length*>] [ **-detail**] [ **-nofields**] *array object address*></span><span class="sxs-lookup"><span data-stu-id="46b76-138">**DA** [**-start** \<*startIndex*>] [**-length** \<*length*>] [**-detail**] [**-nofields**] *array object address*></span></span>|<span data-ttu-id="46b76-139">检查数组对象的元素。</span><span class="sxs-lookup"><span data-stu-id="46b76-139">Examines elements of an array object.</span></span><br /><br /> <span data-ttu-id="46b76-140">**-start** 选项指定开始显示元素的起始索引。</span><span class="sxs-lookup"><span data-stu-id="46b76-140">The **-start** option specifies the starting index at which to display elements.</span></span><br /><br /> <span data-ttu-id="46b76-141">**-length** 选项指定要显示的元素数量。</span><span class="sxs-lookup"><span data-stu-id="46b76-141">The **-length** option specifies how many elements to show.</span></span><br /><br /> <span data-ttu-id="46b76-142">**-details** 选项使用 **DumpObj** 和 **DumpVC** 格式显示元素的详细信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-142">The **-details** option displays details of the element using the **DumpObj** and **DumpVC** formats.</span></span><br /><br /> <span data-ttu-id="46b76-143">**-nofields** 选项可阻止显示数组。</span><span class="sxs-lookup"><span data-stu-id="46b76-143">The **-nofields** option prevents arrays from displaying.</span></span> <span data-ttu-id="46b76-144">此选项仅在指定 **-detail** 选项后可用。</span><span class="sxs-lookup"><span data-stu-id="46b76-144">This option is available only when the **-detail** option is specified.</span></span>|
|<span data-ttu-id="46b76-145">**DumpAssembly** \<*assembly address*></span><span class="sxs-lookup"><span data-stu-id="46b76-145">**DumpAssembly** \<*assembly address*></span></span>|<span data-ttu-id="46b76-146">显示有关程序集的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-146">Displays information about an assembly.</span></span><br /><br /> <span data-ttu-id="46b76-147">**DumpAssembly** 命令将列出多个模块（如果存在）。</span><span class="sxs-lookup"><span data-stu-id="46b76-147">The **DumpAssembly** command lists multiple modules, if they exist.</span></span><br /><br /> <span data-ttu-id="46b76-148">可以通过使用 **DumpDomain** 命令获取程序集地址。</span><span class="sxs-lookup"><span data-stu-id="46b76-148">You can get an assembly address by using the **DumpDomain** command.</span></span>|
|<span data-ttu-id="46b76-149">**DumpClass** \<*EEClass address*></span><span class="sxs-lookup"><span data-stu-id="46b76-149">**DumpClass** \<*EEClass address*></span></span>|<span data-ttu-id="46b76-150">显示有关与类型关联的 `EEClass` 结构的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-150">Displays information about the `EEClass` structure associated with a type.</span></span><br /><br /> <span data-ttu-id="46b76-151">**DumpClass** 命令显示静态字段值，但不显示非静态字段值。</span><span class="sxs-lookup"><span data-stu-id="46b76-151">The **DumpClass** command displays static field values but does not display nonstatic field values.</span></span><br /><br /> <span data-ttu-id="46b76-152">使用 **DumpMT**、**DumpObj**、**Name2EE** 或 **Token2EE** 命令获取 `EEClass` 结构地址。</span><span class="sxs-lookup"><span data-stu-id="46b76-152">Use the **DumpMT**, **DumpObj**, **Name2EE**, or **Token2EE** command to get an `EEClass` structure address.</span></span>|
|<span data-ttu-id="46b76-153">**DumpDomain** [\<*domain address*>]</span><span class="sxs-lookup"><span data-stu-id="46b76-153">**DumpDomain** [\<*domain address*>]</span></span>|<span data-ttu-id="46b76-154">枚举在指定的 <xref:System.Reflection.Assembly> 对象地址内加载的每个 <xref:System.AppDomain> 对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-154">Enumerates each <xref:System.Reflection.Assembly> object that is loaded within the specified <xref:System.AppDomain> object address.</span></span>  <span data-ttu-id="46b76-155">若在调用 DumpDomain 命令时不提供任何参数，则将列出过程中的所有 <xref:System.AppDomain> 对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-155">When called with no parameters, the **DumpDomain** command lists all <xref:System.AppDomain> objects in a process.</span></span>|
|<span data-ttu-id="46b76-156">**DumpHeap** [ **-stat**] [ **-strings**] [ **-short**] [ **-min** \<*size*>] [ **-max** \<*size*>] [ **-thinlock**] [ **-startAtLowerBound**] [ **-mt** \<*MethodTable address*>] [ **-type** \<*partial type name*>][*start* [*end*]]</span><span class="sxs-lookup"><span data-stu-id="46b76-156">**DumpHeap** [**-stat**] [**-strings**] [**-short**] [**-min** \<*size*>] [**-max** \<*size*>] [**-thinlock**] [**-startAtLowerBound**] [**-mt** \<*MethodTable address*>] [**-type** \<*partial type name*>][*start* [*end*]]</span></span>|<span data-ttu-id="46b76-157">显示有关垃圾回收堆的信息和有关对象的收集统计信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-157">Displays information about the garbage-collected heap and collection statistics about objects.</span></span><br /><br /> <span data-ttu-id="46b76-158">如果 **DumpHeap** 命令在垃圾回收器堆中检测到过多碎片，将会显示警告。</span><span class="sxs-lookup"><span data-stu-id="46b76-158">The **DumpHeap** command displays a warning if it detects excessive fragmentation in the garbage collector heap.</span></span><br /><br /> <span data-ttu-id="46b76-159">**-stat** 选项将输出限制为统计类型摘要。</span><span class="sxs-lookup"><span data-stu-id="46b76-159">The **-stat** option restricts the output to the statistical type summary.</span></span><br /><br /> <span data-ttu-id="46b76-160">**-strings** 选项将输出限制为统计字符串值摘要。</span><span class="sxs-lookup"><span data-stu-id="46b76-160">The **-strings** option restricts the output to a statistical string value summary.</span></span><br /><br /> <span data-ttu-id="46b76-161">**-short** 选项将输出限制为只是每个对象的地址。</span><span class="sxs-lookup"><span data-stu-id="46b76-161">The **-short** option limits output to just the address of each object.</span></span> <span data-ttu-id="46b76-162">这使你能够轻松地以管道方式将输出从该命令转移到另一个调试器命令以实现自动化。</span><span class="sxs-lookup"><span data-stu-id="46b76-162">This lets you easily pipe output from the command to another debugger command for automation.</span></span><br /><br /> <span data-ttu-id="46b76-163">**-min** 选项忽略小于 `size` 参数指定的大小（以字节为单位）的对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-163">The **-min** option ignores objects that are less than the `size` parameter, specified in bytes.</span></span><br /><br /> <span data-ttu-id="46b76-164">**-max** 选项忽略大于 `size` 参数指定的大小（以字节为单位）的对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-164">The **-max** option ignores objects that are larger than the `size` parameter, specified in bytes.</span></span><br /><br /> <span data-ttu-id="46b76-165">**-thinlock** 选项报告 ThinLocks。</span><span class="sxs-lookup"><span data-stu-id="46b76-165">The **-thinlock** option reports ThinLocks.</span></span>  <span data-ttu-id="46b76-166">有关详细信息，请参阅 **SyncBlk** 命令。</span><span class="sxs-lookup"><span data-stu-id="46b76-166">For more information, see the **SyncBlk** command.</span></span><br /><br /> <span data-ttu-id="46b76-167">`-startAtLowerBound` 选项将强制在提供的地址范围的下限开始堆审核。</span><span class="sxs-lookup"><span data-stu-id="46b76-167">The `-startAtLowerBound` option forces the heap walk to begin at the lower bound of a supplied address range.</span></span> <span data-ttu-id="46b76-168">在计划阶段，堆通常不可移动，因为对象正在移动。</span><span class="sxs-lookup"><span data-stu-id="46b76-168">During the planning phase, the heap is often not walkable because objects are being moved.</span></span> <span data-ttu-id="46b76-169">此选项将强制 **DumpHeap** 在指定的下限开始其审核。</span><span class="sxs-lookup"><span data-stu-id="46b76-169">This option forces **DumpHeap** to begin its walk at the specified lower bound.</span></span> <span data-ttu-id="46b76-170">你必须提供有效的对象的地址作为使此选项工作的下限。</span><span class="sxs-lookup"><span data-stu-id="46b76-170">You must supply the address of a valid object as the lower bound for this option to work.</span></span> <span data-ttu-id="46b76-171">你可以显示错误对象的地址的内存来手动寻找下一个方法表。</span><span class="sxs-lookup"><span data-stu-id="46b76-171">You can display memory at the address of a bad object to manually find the next method table.</span></span> <span data-ttu-id="46b76-172">如果垃圾回收当前处于对 `memcopy` 的调用中，则你还可以通过将大小添加到作为参数提供的起始地址中来查找下一个对象的地址。</span><span class="sxs-lookup"><span data-stu-id="46b76-172">If the garbage collection is currently in a call to `memcopy`, you may also be able to find the address of the next object by adding the size to the start address, which is supplied as a parameter.</span></span><br /><br /> <span data-ttu-id="46b76-173">**-mt** 选项仅列出与指定的 `MethodTable` 结构对应的那些对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-173">The **-mt** option lists only those objects that correspond to the specified `MethodTable` structure.</span></span><br /><br /> <span data-ttu-id="46b76-174">**-type** 选项仅列出其类型名称为指定字符串的子字符串匹配项的那些对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-174">The **-type** option lists only those objects whose type name is a substring match of the specified string.</span></span><br /><br /> <span data-ttu-id="46b76-175">`start` 参数从指定的地址处开始列出。</span><span class="sxs-lookup"><span data-stu-id="46b76-175">The `start` parameter begins listing from the specified address.</span></span><br /><br /> <span data-ttu-id="46b76-176">`end` 参数在指定的地址处停止列出。</span><span class="sxs-lookup"><span data-stu-id="46b76-176">The `end` parameter stops listing at the specified address.</span></span>|
|<span data-ttu-id="46b76-177">**DumpIL** \<*Managed DynamicMethod object*> &#124;       \<*DynamicMethodDesc pointer*> &#124;        \<*MethodDesc pointer*></span><span class="sxs-lookup"><span data-stu-id="46b76-177">**DumpIL** \<*Managed DynamicMethod object*> &#124;       \<*DynamicMethodDesc pointer*> &#124;        \<*MethodDesc pointer*></span></span>|<span data-ttu-id="46b76-178">显示与托管方法关联的 Microsoft 中间语言 (MSIL)。</span><span class="sxs-lookup"><span data-stu-id="46b76-178">Displays the Microsoft intermediate language (MSIL) that is associated with a managed method.</span></span><br /><br /> <span data-ttu-id="46b76-179">请注意，发出的动态 MSIL 与从程序集加载的 MSIL 不同。</span><span class="sxs-lookup"><span data-stu-id="46b76-179">Note that dynamic MSIL is emitted differently than MSIL that is loaded from an assembly.</span></span> <span data-ttu-id="46b76-180">动态 MSIL 引用托管对象数组中的对象而不是引用元数据标记。</span><span class="sxs-lookup"><span data-stu-id="46b76-180">Dynamic MSIL refers to objects in a managed object array rather than to metadata tokens.</span></span>|
|<span data-ttu-id="46b76-181">**DumpLog** [ **-addr** \<*addressOfStressLog*>] [<*Filenam*`e`>]</span><span class="sxs-lookup"><span data-stu-id="46b76-181">**DumpLog** [**-addr** \<*addressOfStressLog*>] [<*Filenam*`e`>]</span></span>|<span data-ttu-id="46b76-182">将内存中压力日志的内容写入到指定文件。</span><span class="sxs-lookup"><span data-stu-id="46b76-182">Writes the contents of an in-memory stress log to the specified file.</span></span> <span data-ttu-id="46b76-183">如果你不指定名称，则此命令将在当前目录中创建一个名为 StressLog.txt 的文件。</span><span class="sxs-lookup"><span data-stu-id="46b76-183">If you do not specify a name, this command creates a file called StressLog.txt in the current directory.</span></span><br /><br /> <span data-ttu-id="46b76-184">内存中压力日志可帮助你在不使用锁或 I/O 的情况下诊断压力故障。</span><span class="sxs-lookup"><span data-stu-id="46b76-184">The in-memory stress log helps you diagnose stress failures without using locks or I/O.</span></span> <span data-ttu-id="46b76-185">若要启用压力日志，请在 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\\.NETFramework 下设置以下注册表项：</span><span class="sxs-lookup"><span data-stu-id="46b76-185">To enable the stress log, set the following registry keys under HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\\.NETFramework:</span></span><br /><br /> <span data-ttu-id="46b76-186">(DWORD) StressLog = 1</span><span class="sxs-lookup"><span data-stu-id="46b76-186">(DWORD) StressLog = 1</span></span><br /><br /> <span data-ttu-id="46b76-187">(DWORD) LogFacility = 0xffffffff</span><span class="sxs-lookup"><span data-stu-id="46b76-187">(DWORD) LogFacility = 0xffffffff</span></span><br /><br /> <span data-ttu-id="46b76-188">(DWORD) StressLogSize = 65536</span><span class="sxs-lookup"><span data-stu-id="46b76-188">(DWORD) StressLogSize = 65536</span></span><br /><br /> <span data-ttu-id="46b76-189">利用可选的 `-addr` 选项，你可以指定压力日志而非默认日志。</span><span class="sxs-lookup"><span data-stu-id="46b76-189">The optional `-addr` option lets you specify a stress log other than the default log.</span></span>|
|<span data-ttu-id="46b76-190">**DumpMD** \<*MethodDesc address*></span><span class="sxs-lookup"><span data-stu-id="46b76-190">**DumpMD** \<*MethodDesc address*></span></span>|<span data-ttu-id="46b76-191">显示有关指定地址处的 `MethodDesc` 结构的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-191">Displays information about a `MethodDesc` structure at the specified address.</span></span><br /><br /> <span data-ttu-id="46b76-192">可以使用 **IP2MD** 命令从托管函数中获取 `MethodDesc` 结构地址。</span><span class="sxs-lookup"><span data-stu-id="46b76-192">You can use the **IP2MD** command to get the `MethodDesc` structure address from a managed function.</span></span>|
|<span data-ttu-id="46b76-193">**DumpMT** [ **-MD**] \<*MethodTable address*></span><span class="sxs-lookup"><span data-stu-id="46b76-193">**DumpMT** [**-MD**] \<*MethodTable address*></span></span>|<span data-ttu-id="46b76-194">显示有关指定地址处的方法表的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-194">Displays information about a method table at the specified address.</span></span> <span data-ttu-id="46b76-195">指定 **-MD** 选项将显示与对象一起定义的所有方法的列表。</span><span class="sxs-lookup"><span data-stu-id="46b76-195">Specifying the **-MD** option displays a list of all methods defined with the object.</span></span><br /><br /> <span data-ttu-id="46b76-196">每个托管对象均包含一个方法表指针。</span><span class="sxs-lookup"><span data-stu-id="46b76-196">Each managed object contains a method table pointer.</span></span>|
|<span data-ttu-id="46b76-197">**DumpMethodSig** \<*sigaddr*> <*moduleadd*`r`></span><span class="sxs-lookup"><span data-stu-id="46b76-197">**DumpMethodSig** \<*sigaddr*> <*moduleadd*`r`></span></span>|<span data-ttu-id="46b76-198">显示有关指定地址处的 `MethodSig` 结构的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-198">Displays information about a `MethodSig` structure at the specified address.</span></span>|
|<span data-ttu-id="46b76-199">**DumpModule** [ **-mt**] \<*Module address*></span><span class="sxs-lookup"><span data-stu-id="46b76-199">**DumpModule** [**-mt**] \<*Module address*></span></span>|<span data-ttu-id="46b76-200">显示有关指定地址处的模块的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-200">Displays information about a module at the specified address.</span></span> <span data-ttu-id="46b76-201">**-mt** 选项显示模块中定义的类型和模块所引用的类型</span><span class="sxs-lookup"><span data-stu-id="46b76-201">The **-mt** option displays the types defined in a module and the types referenced by the module</span></span><br /><br /> <span data-ttu-id="46b76-202">可以使用 **DumpDomain** 或 **DumpAssembly** 命令检索模块的地址。</span><span class="sxs-lookup"><span data-stu-id="46b76-202">You can use the **DumpDomain** or **DumpAssembly** command to retrieve a module's address.</span></span>|
|<span data-ttu-id="46b76-203">**DumpObj** [ **-nofields**] \<*object address*></span><span class="sxs-lookup"><span data-stu-id="46b76-203">**DumpObj** [**-nofields**] \<*object address*></span></span><br /><br /> <span data-ttu-id="46b76-204">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="46b76-204">-or-</span></span><br /><br /> <span data-ttu-id="46b76-205">**DO** \<*object address*></span><span class="sxs-lookup"><span data-stu-id="46b76-205">**DO** \<*object address*></span></span>|<span data-ttu-id="46b76-206">显示有关指定地址处的对象的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-206">Displays information about an object at the specified address.</span></span> <span data-ttu-id="46b76-207">**DumpObj** 命令显示对象的字段、`EEClass` 结构信息、方法表和大小。</span><span class="sxs-lookup"><span data-stu-id="46b76-207">The **DumpObj** command displays the fields, the `EEClass` structure information, the method table, and the size of the object.</span></span><br /><br /> <span data-ttu-id="46b76-208">可以使用 **DumpStackObjects** 命令检索对象的地址。</span><span class="sxs-lookup"><span data-stu-id="46b76-208">You can use the **DumpStackObjects** command to retrieve an object's address.</span></span><br /><br /> <span data-ttu-id="46b76-209">请注意，可以对 `CLASS` 类型的字段运行 **DumpObj** 命令，因为这些字段也是对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-209">Note that you can run the **DumpObj** command on fields of type `CLASS` because they are also objects.</span></span><br /><br /> <span data-ttu-id="46b76-210">`-`**nofields** 选项可阻止显示对象的字段，它对 String 这样的对象很有用。</span><span class="sxs-lookup"><span data-stu-id="46b76-210">The `-`**nofields** option prevents fields of the object being displayed, it is useful for objects like String.</span></span>|
|<span data-ttu-id="46b76-211">**DumpRuntimeTypes**</span><span class="sxs-lookup"><span data-stu-id="46b76-211">**DumpRuntimeTypes**</span></span>|<span data-ttu-id="46b76-212">显示垃圾回收器堆中的运行时类型对象并列出其关联的类型名称和方法表。</span><span class="sxs-lookup"><span data-stu-id="46b76-212">Displays the runtime type objects in the garbage collector heap and lists their associated type names and method tables.</span></span>|
|<span data-ttu-id="46b76-213">**DumpStack** [ **-EE**] [ **-n**] [`top` *stack* [`bottom` *stac*`k`]]</span><span class="sxs-lookup"><span data-stu-id="46b76-213">**DumpStack** [**-EE**] [**-n**] [`top` *stack* [`bottom` *stac*`k`]]</span></span>|<span data-ttu-id="46b76-214">显示堆栈跟踪。</span><span class="sxs-lookup"><span data-stu-id="46b76-214">Displays a stack trace.</span></span><br /><br /> <span data-ttu-id="46b76-215">**-EE** 选项使 **DumpStack** 命令仅显示托管函数。</span><span class="sxs-lookup"><span data-stu-id="46b76-215">The **-EE** option causes the **DumpStack** command to display only managed functions.</span></span> <span data-ttu-id="46b76-216">使用 `top` 和 `bottom` 参数可限制 x86 平台上显示的堆栈帧。</span><span class="sxs-lookup"><span data-stu-id="46b76-216">Use the `top` and `bottom` parameters to limit the stack frames displayed on x86 platforms.</span></span><br /><br /> <span data-ttu-id="46b76-217">**-n** 选项禁止显示源文件名和行号。</span><span class="sxs-lookup"><span data-stu-id="46b76-217">The **-n** option disables the display of source file names and line numbers.</span></span> <span data-ttu-id="46b76-218">如果调试器已指定选项 SYMOPT_LOAD_LINES，则 SOS 将查找每个托管帧的符号，如果成功，则将显示对应的源文件名和行号。</span><span class="sxs-lookup"><span data-stu-id="46b76-218">If the debugger has the option SYMOPT_LOAD_LINES specified, SOS will look up the symbols for every managed frame and if successful will display the corresponding source file name and line number.</span></span> <span data-ttu-id="46b76-219">可以指定 **-n**（无行号）参数来禁用此行为。</span><span class="sxs-lookup"><span data-stu-id="46b76-219">The **-n** (No line numbers) parameter can be specified to disable this behavior.</span></span><br /><br /> <span data-ttu-id="46b76-220">在 x86 和 x64 平台上，**DumpStack** 命令将创建详细的堆栈跟踪。</span><span class="sxs-lookup"><span data-stu-id="46b76-220">On x86 and x64 platforms, the **DumpStack** command creates a verbose stack trace.</span></span><br /><br /> <span data-ttu-id="46b76-221">在基于 IA-64 的平台上，**DumpStack** 命令模拟调试器的 **K** 命令。</span><span class="sxs-lookup"><span data-stu-id="46b76-221">On IA-64-based platforms, the **DumpStack** command mimics the debugger's **K** command.</span></span> <span data-ttu-id="46b76-222">在基于 IA-64 的平台上，将忽略 `top` 和 `bottom` 参数。</span><span class="sxs-lookup"><span data-stu-id="46b76-222">The `top` and `bottom` parameters are ignored on IA-64-based platforms.</span></span>|
|<span data-ttu-id="46b76-223">**DumpSig** \<*sigaddr*> \<*moduleaddr*></span><span class="sxs-lookup"><span data-stu-id="46b76-223">**DumpSig** \<*sigaddr*> \<*moduleaddr*></span></span>|<span data-ttu-id="46b76-224">显示有关指定地址处的 `Sig` 结构的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-224">Displays information about a `Sig` structure at the specified address.</span></span>|
|<span data-ttu-id="46b76-225">**DumpSigElem** \<*sigaddr*> \<*moduleaddr*></span><span class="sxs-lookup"><span data-stu-id="46b76-225">**DumpSigElem** \<*sigaddr*> \<*moduleaddr*></span></span>|<span data-ttu-id="46b76-226">显示签名对象的单个元素。</span><span class="sxs-lookup"><span data-stu-id="46b76-226">Displays a single element of a signature object.</span></span> <span data-ttu-id="46b76-227">大多数情况下，应使用 **DumpSig** 查看单个签名对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-227">In most cases, you should use **DumpSig** to look at individual signature objects.</span></span> <span data-ttu-id="46b76-228">但是，如果签名已在某种程度上被损坏，则可使用 **DumpSigElem** 读取它的有效部分。</span><span class="sxs-lookup"><span data-stu-id="46b76-228">However, if a signature has been corrupted in some way, you can use **DumpSigElem** to read the valid portions of it.</span></span>|
|<span data-ttu-id="46b76-229">**DumpStackObjects** [ **-verify**] [`top` *stack* [`bottom` *stack*]]</span><span class="sxs-lookup"><span data-stu-id="46b76-229">**DumpStackObjects** [**-verify**] [`top` *stack* [`bottom` *stack*]]</span></span><br /><br /> <span data-ttu-id="46b76-230">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="46b76-230">-or-</span></span><br /><br /> <span data-ttu-id="46b76-231">**DSO** [ **-verify**] [`top` *stack* [`bottom` *stack*]]</span><span class="sxs-lookup"><span data-stu-id="46b76-231">**DSO** [**-verify**] [`top` *stack* [`bottom` *stack*]]</span></span>|<span data-ttu-id="46b76-232">显示在当前堆栈的边界内找到的所有托管对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-232">Displays all managed objects found within the bounds of the current stack.</span></span><br /><br /> <span data-ttu-id="46b76-233">**-verify** 选项验证对象字段的每个非静态 `CLASS` 字段。</span><span class="sxs-lookup"><span data-stu-id="46b76-233">The **-verify** option validates each non-static `CLASS` field of an object field.</span></span><br /><br /> <span data-ttu-id="46b76-234">将 **DumpStackObject** 命令与堆栈跟踪命令（如 **K** 命令和 **CLRStack** 命令）一起使用以确定局部变量和参数的值。</span><span class="sxs-lookup"><span data-stu-id="46b76-234">Use the **DumpStackObject** command with stack tracing commands such as the **K** command and the **CLRStack** command to determine the values of local variables and parameters.</span></span>|
|<span data-ttu-id="46b76-235">**DumpVC** \<*MethodTable address*> \<*Address*></span><span class="sxs-lookup"><span data-stu-id="46b76-235">**DumpVC** \<*MethodTable address*> \<*Address*></span></span>|<span data-ttu-id="46b76-236">显示有关指定地址处的值类字段的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-236">Displays information about the fields of a value class at the specified address.</span></span><br /><br /> <span data-ttu-id="46b76-237">**MethodTable** 参数使 **DumpVC** 命令可以正确解释字段。</span><span class="sxs-lookup"><span data-stu-id="46b76-237">The **MethodTable** parameter allows the **DumpVC** command to correctly interpret fields.</span></span> <span data-ttu-id="46b76-238">值类不将方法表作为其第一个字段。</span><span class="sxs-lookup"><span data-stu-id="46b76-238">Value classes do not have a method table as their first field.</span></span>|
|<span data-ttu-id="46b76-239">**EEHeap** [ **-gc**] [ **-loader**]</span><span class="sxs-lookup"><span data-stu-id="46b76-239">**EEHeap** [**-gc**] [**-loader**]</span></span>|<span data-ttu-id="46b76-240">显示有关内部 CLR 数据结构所使用的进程内存的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-240">Displays information about process memory consumed by internal CLR data structures.</span></span><br /><br /> <span data-ttu-id="46b76-241">**-gc** 和 **-loader** 选项将此命令的输出限制为垃圾回收器或加载程序数据结构。</span><span class="sxs-lookup"><span data-stu-id="46b76-241">The **-gc** and **-loader** options limit the output of this command to garbage collector or loader data structures.</span></span><br /><br /> <span data-ttu-id="46b76-242">有关垃圾回收器的信息列出了托管堆中每个段的范围。</span><span class="sxs-lookup"><span data-stu-id="46b76-242">The information for the garbage collector lists the ranges of each segment in the managed heap.</span></span>  <span data-ttu-id="46b76-243">如果指针落在由 **-gc** 给定的段范围内，则该指针是一个对象指针。</span><span class="sxs-lookup"><span data-stu-id="46b76-243">If the pointer falls within a segment range given by **-gc**, the pointer is an object pointer.</span></span>|
|<span data-ttu-id="46b76-244">**EEStack** [ **-short**] [ **-EE**]</span><span class="sxs-lookup"><span data-stu-id="46b76-244">**EEStack** [**-short**] [**-EE**]</span></span>|<span data-ttu-id="46b76-245">对一个进程中的所有线程运行 **DumpStack** 命令。</span><span class="sxs-lookup"><span data-stu-id="46b76-245">Runs the **DumpStack** command on all threads in the process.</span></span><br /><br /> <span data-ttu-id="46b76-246">将 **-EE** 选项直接传递给 **DumpStack** 命令。</span><span class="sxs-lookup"><span data-stu-id="46b76-246">The **-EE** option is passed directly to the **DumpStack** command.</span></span> <span data-ttu-id="46b76-247">**-short** 参数将输出限制为以下类型的线程：</span><span class="sxs-lookup"><span data-stu-id="46b76-247">The **-short** parameter limits the output to the following kinds of threads:</span></span><br /><br /> <span data-ttu-id="46b76-248">已获取锁的线程。</span><span class="sxs-lookup"><span data-stu-id="46b76-248">Threads that have taken a lock.</span></span><br /><br /> <span data-ttu-id="46b76-249">己停止运行以允许垃圾回收的线程。</span><span class="sxs-lookup"><span data-stu-id="46b76-249">Threads that have been stalled in order to allow a garbage collection.</span></span><br /><br /> <span data-ttu-id="46b76-250">当前在托管代码中的线程。</span><span class="sxs-lookup"><span data-stu-id="46b76-250">Threads that are currently in managed code.</span></span>|
|<span data-ttu-id="46b76-251">**EEVersion**</span><span class="sxs-lookup"><span data-stu-id="46b76-251">**EEVersion**</span></span>|<span data-ttu-id="46b76-252">显示 CLR 版本。</span><span class="sxs-lookup"><span data-stu-id="46b76-252">Displays the CLR version.</span></span>|
|<span data-ttu-id="46b76-253">**EHInfo** [\<*MethodDesc address*>] [\<*Code address*>]</span><span class="sxs-lookup"><span data-stu-id="46b76-253">**EHInfo** [\<*MethodDesc address*>] [\<*Code address*>]</span></span>|<span data-ttu-id="46b76-254">显示指定方法中的异常处理块。</span><span class="sxs-lookup"><span data-stu-id="46b76-254">Displays the exception handling blocks in a specified method.</span></span>  <span data-ttu-id="46b76-255">此命令显示子句块（`try` 块）和处理程序块（`catch` 块）的代码地址和偏移量。</span><span class="sxs-lookup"><span data-stu-id="46b76-255">This command displays the code addresses and offsets for the clause block (the `try` block) and the handler block (the `catch` block).</span></span>|
|<span data-ttu-id="46b76-256">**常见问题解答**</span><span class="sxs-lookup"><span data-stu-id="46b76-256">**FAQ**</span></span>|<span data-ttu-id="46b76-257">显示常见问题。</span><span class="sxs-lookup"><span data-stu-id="46b76-257">Displays frequently asked questions.</span></span>|
|<span data-ttu-id="46b76-258">**FinalizeQueue** [ **-detail**] &#124; [ **-allReady**] [ **-short**]</span><span class="sxs-lookup"><span data-stu-id="46b76-258">**FinalizeQueue** [**-detail**] &#124; [**-allReady**] [**-short**]</span></span>|<span data-ttu-id="46b76-259">显示所有已进行终结注册的对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-259">Displays all objects registered for finalization.</span></span><br /><br /> <span data-ttu-id="46b76-260">**-detail** 选项显示有关需要清理的任何 `SyncBlocks` 的额外信息，以及有关等待清理的任何 `RuntimeCallableWrappers` (RCW) 的额外信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-260">The **-detail** option displays extra information about any `SyncBlocks` that need to be cleaned up, and any `RuntimeCallableWrappers` (RCWs) that await cleanup.</span></span> <span data-ttu-id="46b76-261">这两种数据结构都由终结器线程在运行时进行缓存和清理。</span><span class="sxs-lookup"><span data-stu-id="46b76-261">Both of these data structures are cached and cleaned up by the finalizer thread when it runs.</span></span><br /><br /> <span data-ttu-id="46b76-262">`-allReady` 选项显示所有准备终止的对象，无论它们已被垃圾回收标记成这样，还是将被下一个垃圾回收标记。</span><span class="sxs-lookup"><span data-stu-id="46b76-262">The `-allReady` option displays all objects that are ready for finalization, regardless of whether they are already marked by the garbage collection as such, or will be marked by the next garbage collection.</span></span> <span data-ttu-id="46b76-263">“准备终止”列表中的对象为不再为根的可终止对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-263">The objects that are in the "ready for finalization" list are finalizable objects that are no longer rooted.</span></span> <span data-ttu-id="46b76-264">此选项可能耗费大量资源，因为它验证可终止队列中的所有对象是否仍然为根对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-264">This option can be very expensive, because it verifies whether all the objects in the finalizable queues are still rooted.</span></span><br /><br /> <span data-ttu-id="46b76-265">`-short` 选项将输出限制为每个对象的地址。</span><span class="sxs-lookup"><span data-stu-id="46b76-265">The `-short` option limits the output to the address of each object.</span></span> <span data-ttu-id="46b76-266">如果将此选项与 **-allReady** 一起使用，则将枚举具有不再为根的终结器的所有对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-266">If it is used in conjunction with **-allReady**, it enumerates all objects that have a finalizer that are no longer rooted.</span></span> <span data-ttu-id="46b76-267">如果单独使用此选项，则将列出终结和“准备终结”队列中的所有对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-267">If it is used independently, it lists all objects in the finalizable and "ready for finalization" queues.</span></span>|
|<span data-ttu-id="46b76-268">**FindAppDomain** \<*Object address*></span><span class="sxs-lookup"><span data-stu-id="46b76-268">**FindAppDomain** \<*Object address*></span></span>|<span data-ttu-id="46b76-269">确定指定地址处的对象的应用程序域。</span><span class="sxs-lookup"><span data-stu-id="46b76-269">Determines the application domain of an object at the specified address.</span></span>|
|<span data-ttu-id="46b76-270">**FindRoots** **-gen** \<*N*> &#124; **-gen any** &#124;\<*object address*></span><span class="sxs-lookup"><span data-stu-id="46b76-270">**FindRoots** **-gen** \<*N*> &#124; **-gen any** &#124;\<*object address*></span></span>|<span data-ttu-id="46b76-271">导致调试器在指定生成的下次回收时在调试对象中中断。</span><span class="sxs-lookup"><span data-stu-id="46b76-271">Causes the debugger to break in the debuggee on the next collection of the specified generation.</span></span> <span data-ttu-id="46b76-272">在中断发生时立即重置该效果。</span><span class="sxs-lookup"><span data-stu-id="46b76-272">The effect is reset as soon as the break occurs.</span></span> <span data-ttu-id="46b76-273">若要在下一个集合中断，你必须重新发出该命令。</span><span class="sxs-lookup"><span data-stu-id="46b76-273">To break on the next collection, you have to reissue the command.</span></span> <span data-ttu-id="46b76-274">此命令的 *\<object address>* 形式在 -gen 或 -gen any 引起的中断发生后使用。</span><span class="sxs-lookup"><span data-stu-id="46b76-274">The *\<object address>* form of this command is used after the break caused by the **-gen** or **-gen any** has occurred.</span></span> <span data-ttu-id="46b76-275">此时，调试对象处于正确的状态，以便 **FindRoots** 从当前已报废的生成中识别出对象的根。</span><span class="sxs-lookup"><span data-stu-id="46b76-275">At that time, the debuggee is in the right state for **FindRoots** to identify roots for objects from the current condemned generations.</span></span>|
|<span data-ttu-id="46b76-276">**GCHandles** [ **-perdomain**]</span><span class="sxs-lookup"><span data-stu-id="46b76-276">**GCHandles** [**-perdomain**]</span></span>|<span data-ttu-id="46b76-277">显示有关进程中的垃圾回收器句柄的统计信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-277">Displays statistics about garbage collector handles in the process.</span></span><br /><br /> <span data-ttu-id="46b76-278">**-perdomain** 选项将按应用程序域排列统计信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-278">The **-perdomain** option arranges the statistics by application domain.</span></span><br /><br /> <span data-ttu-id="46b76-279">使用 **GCHandles** 命令可查找由垃圾回收器句柄泄漏导致的内存泄漏。</span><span class="sxs-lookup"><span data-stu-id="46b76-279">Use the **GCHandles** command to find memory leaks caused by garbage collector handle leaks.</span></span> <span data-ttu-id="46b76-280">例如，当代码由于强垃圾回收器句柄仍指向一个大型数组而保留该数组时，若不释放句柄就将其放弃，则会发生内存泄漏。</span><span class="sxs-lookup"><span data-stu-id="46b76-280">For example, a memory leak occurs when code retains a large array because a strong garbage collector handle still points to it, and the handle is discarded without freeing it.</span></span>|
|<span data-ttu-id="46b76-281">**GCHandleLeaks**</span><span class="sxs-lookup"><span data-stu-id="46b76-281">**GCHandleLeaks**</span></span>|<span data-ttu-id="46b76-282">在内存中搜索进程中的对强垃圾回收器句柄和固定垃圾回收器句柄的任何引用并显示结果。</span><span class="sxs-lookup"><span data-stu-id="46b76-282">Searches memory for any references to strong and pinned garbage collector handles in the process and displays the results.</span></span> <span data-ttu-id="46b76-283">如果找到某个句柄，**GCHandleLeaks** 命令将显示相应的引用地址。</span><span class="sxs-lookup"><span data-stu-id="46b76-283">If a handle is found, the **GCHandleLeaks** command displays the address of the reference.</span></span> <span data-ttu-id="46b76-284">如果在内存中找不到句柄，此命令将显示一个通知。</span><span class="sxs-lookup"><span data-stu-id="46b76-284">If a handle is not found in memory, this command displays a notification.</span></span>|
|<span data-ttu-id="46b76-285">**GCInfo** \<*MethodDesc address*>\<*Code address*></span><span class="sxs-lookup"><span data-stu-id="46b76-285">**GCInfo** \<*MethodDesc address*>\<*Code address*></span></span>|<span data-ttu-id="46b76-286">显示指示寄存器或堆栈位置何时包含托管对象的数据。</span><span class="sxs-lookup"><span data-stu-id="46b76-286">Displays data that indicates when registers or stack locations contain managed objects.</span></span> <span data-ttu-id="46b76-287">如果发生垃圾回收，回收器必须知道对象引用的位置，以便可以使用新的对象指针值更新相应的对象引用。</span><span class="sxs-lookup"><span data-stu-id="46b76-287">If a garbage collection occurs, the collector must know the locations of references to objects so it can update them with new object pointer values.</span></span>|
|<span data-ttu-id="46b76-288">**GCRoot** [ **-nostacks**] \<*Object address*></span><span class="sxs-lookup"><span data-stu-id="46b76-288">**GCRoot** [**-nostacks**] \<*Object address*></span></span>|<span data-ttu-id="46b76-289">显示有关对指定地址处的对象的引用（或根）的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-289">Displays information about references (or roots) to an object at the specified address.</span></span><br /><br /> <span data-ttu-id="46b76-290">**GCRoot** 命令将检查整个托管堆和句柄表以查找其他对象内的句柄和堆栈上的句柄。</span><span class="sxs-lookup"><span data-stu-id="46b76-290">The **GCRoot** command examines the entire managed heap and the handle table for handles within other objects and handles on the stack.</span></span> <span data-ttu-id="46b76-291">然后，在每个堆栈中搜索对象的指针，同时还搜索终结器队列。</span><span class="sxs-lookup"><span data-stu-id="46b76-291">Each stack is then searched for pointers to objects, and the finalizer queue is also searched.</span></span><br /><br /> <span data-ttu-id="46b76-292">此命令无法确定堆栈根是有效的还是已丢弃。</span><span class="sxs-lookup"><span data-stu-id="46b76-292">This command does not determine whether a stack root is valid or is discarded.</span></span> <span data-ttu-id="46b76-293">使用 **CLRStack** 和 **U** 命令可对本地或自变量值所属的帧进行反汇编，以便确定堆栈根是否仍在使用中。</span><span class="sxs-lookup"><span data-stu-id="46b76-293">Use the **CLRStack** and **U** commands to disassemble the frame that the local or argument value belongs to in order to determine if the stack root is still in use.</span></span><br /><br /> <span data-ttu-id="46b76-294">-nostacks 选项将搜索限制为垃圾回收器句柄和 reachable 对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-294">The **-nostacks** option restricts the search to garbage collector handles and reachable objects.</span></span>|
|<span data-ttu-id="46b76-295">**GCWhere**  *\<object address>*</span><span class="sxs-lookup"><span data-stu-id="46b76-295">**GCWhere**  *\<object address>*</span></span>|<span data-ttu-id="46b76-296">显示垃圾回收堆中自变量传入的位置和大小。</span><span class="sxs-lookup"><span data-stu-id="46b76-296">Displays the location and size in the garbage collection heap of the argument passed in.</span></span> <span data-ttu-id="46b76-297">如果自变量位于托管堆中，但不是有效的对象地址，则大小显示为 0（零）。</span><span class="sxs-lookup"><span data-stu-id="46b76-297">When the argument lies in the managed heap but is not a valid object address, the size is displayed as 0 (zero).</span></span>|
|<span data-ttu-id="46b76-298">**help** [\<*command*>] [`faq`]</span><span class="sxs-lookup"><span data-stu-id="46b76-298">**help** [\<*command*>] [`faq`]</span></span>|<span data-ttu-id="46b76-299">在未指定参数时显示所有可用命令，或者显示有关指定命令的详细帮助信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-299">Displays all available commands when no parameter is specified, or displays detailed help information about the specified command.</span></span><br /><br /> <span data-ttu-id="46b76-300">`faq` 参数显示常见问题的答案。</span><span class="sxs-lookup"><span data-stu-id="46b76-300">The `faq` parameter displays answers to frequently asked questions.</span></span>|
|<span data-ttu-id="46b76-301">**HeapStat** [ **-inclUnrooted** &#124; **-iu**]</span><span class="sxs-lookup"><span data-stu-id="46b76-301">**HeapStat** [**-inclUnrooted** &#124; **-iu**]</span></span>|<span data-ttu-id="46b76-302">显示每个堆的生成大小及每个堆上各生成的可用空间总量。</span><span class="sxs-lookup"><span data-stu-id="46b76-302">Displays the generation sizes for each heap and the total free space in each generation on each heap.</span></span> <span data-ttu-id="46b76-303">如果指定 -**inclUnrooted** 选项，则报告将包括有关不再为根的垃圾回收堆中的托管对象的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-303">If the -**inclUnrooted** option is specified, the report includes information about the managed objects from the garbage collection heap that is no longer rooted.</span></span>|
|<span data-ttu-id="46b76-304">**HistClear**</span><span class="sxs-lookup"><span data-stu-id="46b76-304">**HistClear**</span></span>|<span data-ttu-id="46b76-305">释放由 `Hist` 命令系列使用的任何资源。</span><span class="sxs-lookup"><span data-stu-id="46b76-305">Releases any resources used by the family of `Hist` commands.</span></span><br /><br /> <span data-ttu-id="46b76-306">通常，你不必显式调用 `HistClear`，因为每个 `HistInit` 都会清理以前的资源。</span><span class="sxs-lookup"><span data-stu-id="46b76-306">Generally, you do not have to explicitly call `HistClear`, because each `HistInit` cleans up the previous resources.</span></span>|
|<span data-ttu-id="46b76-307">**HistInit**</span><span class="sxs-lookup"><span data-stu-id="46b76-307">**HistInit**</span></span>|<span data-ttu-id="46b76-308">从保存在调试对象中的压力日志初始化 SOS 结构。</span><span class="sxs-lookup"><span data-stu-id="46b76-308">Initializes the SOS structures from the stress log saved in the debuggee.</span></span>|
|<span data-ttu-id="46b76-309">**HistObj** *\<obj_address>*</span><span class="sxs-lookup"><span data-stu-id="46b76-309">**HistObj** *\<obj_address>*</span></span>|<span data-ttu-id="46b76-310">检查所有压力日志的重定位记录，并显示可能已将地址作为自变量传入的垃圾回收重定位链。</span><span class="sxs-lookup"><span data-stu-id="46b76-310">Examines all stress log relocation records and displays the chain of garbage collection relocations that may have led to the address passed in as an argument.</span></span>|
|<span data-ttu-id="46b76-311">**HistObjFind**  *\<obj_address>*</span><span class="sxs-lookup"><span data-stu-id="46b76-311">**HistObjFind**  *\<obj_address>*</span></span>|<span data-ttu-id="46b76-312">显示在指定地址处引用对象的所有日志项。</span><span class="sxs-lookup"><span data-stu-id="46b76-312">Displays all the log entries that reference an object at the specified address.</span></span>|
|<span data-ttu-id="46b76-313">**HistRoot** *\<root>*</span><span class="sxs-lookup"><span data-stu-id="46b76-313">**HistRoot** *\<root>*</span></span>|<span data-ttu-id="46b76-314">显示与指定根的提升和重定位相关的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-314">Displays information related to both promotions and relocations of the specified root.</span></span><br /><br /> <span data-ttu-id="46b76-315">根值可用于通过垃圾回收来跟踪对象的移动。</span><span class="sxs-lookup"><span data-stu-id="46b76-315">The root value can be used to track the movement of an object through the garbage collections.</span></span>|
|<span data-ttu-id="46b76-316">**IP2MD** \<*Code address*></span><span class="sxs-lookup"><span data-stu-id="46b76-316">**IP2MD** \<*Code address*></span></span>|<span data-ttu-id="46b76-317">显示已 JIT 编译的代码中指定地址处的 `MethodDesc` 结构。</span><span class="sxs-lookup"><span data-stu-id="46b76-317">Displays the `MethodDesc` structure at the specified address in code that has been JIT-compiled.</span></span>|
|<span data-ttu-id="46b76-318">`ListNearObj` (`lno`) *\<obj_address>*</span><span class="sxs-lookup"><span data-stu-id="46b76-318">`ListNearObj` (`lno`) *\<obj_address>*</span></span>|<span data-ttu-id="46b76-319">显示指定地址之前和之后的对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-319">Displays the objects preceding and following the specified address.</span></span> <span data-ttu-id="46b76-320">该命令在垃圾回收堆和自变量地址之后的对象中寻找地址，而该垃圾回收堆看上去像托管对象（基于有效的方法表）的有效开头。</span><span class="sxs-lookup"><span data-stu-id="46b76-320">The command looks for the address in the garbage collection heap that looks like a valid beginning of a managed object (based on a valid method table) and the object following the argument address.</span></span>|
|<span data-ttu-id="46b76-321">**MinidumpMode** [**0**] [**1**]</span><span class="sxs-lookup"><span data-stu-id="46b76-321">**MinidumpMode** [**0**] [**1**]</span></span>|<span data-ttu-id="46b76-322">防止在使用小型转储时运行不安全的命令。</span><span class="sxs-lookup"><span data-stu-id="46b76-322">Prevents running unsafe commands when using a minidump.</span></span><br /><br /> <span data-ttu-id="46b76-323">传递 **0** 禁用此功能，或传递 **1** 启用此功能。</span><span class="sxs-lookup"><span data-stu-id="46b76-323">Pass **0** to disable this feature or **1** to enable this feature.</span></span> <span data-ttu-id="46b76-324">默认情况下，**MinidumpMode** 值设置为 **0**。</span><span class="sxs-lookup"><span data-stu-id="46b76-324">By default, the **MinidumpMode** value is set to **0**.</span></span><br /><br /> <span data-ttu-id="46b76-325">使用 **.dump /m** 命令或 **.dump** 命令创建的小型转储具有有限的 CLR 特定数据，允许只正确地运行一小部分 SOS 命令。</span><span class="sxs-lookup"><span data-stu-id="46b76-325">Minidumps created with the **.dump /m** command or **.dump** command have limited CLR-specific data and allow you to run only a subset of SOS commands correctly.</span></span> <span data-ttu-id="46b76-326">有些命令可能会因错误而失败，因为所需的内存区域未被映射或仅被部分映射。</span><span class="sxs-lookup"><span data-stu-id="46b76-326">Some commands may fail with unexpected errors because required areas of memory are not mapped or are only partially mapped.</span></span> <span data-ttu-id="46b76-327">此选项可防止你对小型转储运行不安全的命令。</span><span class="sxs-lookup"><span data-stu-id="46b76-327">This option protects you from running unsafe commands against minidumps.</span></span>|
|<span data-ttu-id="46b76-328">**Name2EE** \<*module name*> \<*type or method name*></span><span class="sxs-lookup"><span data-stu-id="46b76-328">**Name2EE** \<*module name*> \<*type or method name*></span></span><br /><br /> <span data-ttu-id="46b76-329">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="46b76-329">-or-</span></span><br /><br /> <span data-ttu-id="46b76-330">**Name2EE** \<*module name*> **!** \<*type or method name*></span><span class="sxs-lookup"><span data-stu-id="46b76-330">**Name2EE** \<*module name*>**!**\<*type or method name*></span></span>|<span data-ttu-id="46b76-331">显示指定模块中的指定类型或方法的 `MethodTable` 结构和 `EEClass` 结构。</span><span class="sxs-lookup"><span data-stu-id="46b76-331">Displays the `MethodTable` structure and `EEClass` structure for the specified type or method in the specified module.</span></span><br /><br /> <span data-ttu-id="46b76-332">在进程中必须加载指定的模块。</span><span class="sxs-lookup"><span data-stu-id="46b76-332">The specified module must be loaded in the process.</span></span><br /><br /> <span data-ttu-id="46b76-333">若要获取正确的类型名称，请通过使用 [Ildasm.exe（IL 反汇编程序）](ildasm-exe-il-disassembler.md)浏览模块。</span><span class="sxs-lookup"><span data-stu-id="46b76-333">To get the proper type name, browse the module by using the [Ildasm.exe (IL Disassembler)](ildasm-exe-il-disassembler.md).</span></span> <span data-ttu-id="46b76-334">也可以将 `*` 作为模块名参数传递以搜索所有已加载的托管模块。</span><span class="sxs-lookup"><span data-stu-id="46b76-334">You can also pass `*` as the module name parameter to search all loaded managed modules.</span></span> <span data-ttu-id="46b76-335">*module name* 参数也可以是模块的调试器名称，如 `mscorlib` 或 `image00400000`。</span><span class="sxs-lookup"><span data-stu-id="46b76-335">The *module name* parameter can also be the debugger's name for a module, such as `mscorlib` or `image00400000`.</span></span><br /><br /> <span data-ttu-id="46b76-336">此命令支持 <`module`>`!`<`type`> 的 Windows 调试器语法。</span><span class="sxs-lookup"><span data-stu-id="46b76-336">This command supports the Windows debugger syntax of <`module`>`!`<`type`>.</span></span> <span data-ttu-id="46b76-337">类型必须是完全限定的。</span><span class="sxs-lookup"><span data-stu-id="46b76-337">The type must be fully qualified.</span></span>|
|<span data-ttu-id="46b76-338">**ObjSize** [\<*Object address*>] &#124; [ **-aggregate**] [ **-stat**]</span><span class="sxs-lookup"><span data-stu-id="46b76-338">**ObjSize** [\<*Object address*>] &#124; [**-aggregate**] [**-stat**]</span></span>|<span data-ttu-id="46b76-339">显示指定对象的大小。</span><span class="sxs-lookup"><span data-stu-id="46b76-339">Displays the size of the specified object.</span></span> <span data-ttu-id="46b76-340">如果未指定任何参数，则 **ObjSize** 命令将显示在托管线程上找到的所有对象的大小，显示进程中的所有垃圾回收器句柄，并对这些句柄指向的任何对象的大小进行合计。</span><span class="sxs-lookup"><span data-stu-id="46b76-340">If you do not specify any parameters, the **ObjSize** command displays the size of all objects found on managed threads, displays all garbage collector handles in the process, and totals the size of any objects pointed to by those handles.</span></span> <span data-ttu-id="46b76-341">除父对象之外，**ObjSize** 命令还包括所有子对象的大小。</span><span class="sxs-lookup"><span data-stu-id="46b76-341">The **ObjSize** command includes the size of all child objects in addition to the parent.</span></span><br /><br /> <span data-ttu-id="46b76-342">**-aggregate** 选项能够与 **-stat** 参数一起使用，以获得仍为根类型的类型的详细视图。</span><span class="sxs-lookup"><span data-stu-id="46b76-342">The **-aggregate** option can be used in conjunction with the **-stat** argument to get a detailed view of the types that are still rooted.</span></span> <span data-ttu-id="46b76-343">通过使用 **!dumpheap -stat** 和 **!objsize -aggregate -stat**，可以确定不再为根的对象并诊断各种内存问题。</span><span class="sxs-lookup"><span data-stu-id="46b76-343">By using **!dumpheap -stat** and **!objsize -aggregate -stat**, you can determine which objects are no longer rooted and diagnose various memory issues.</span></span>|
|<span data-ttu-id="46b76-344">**PrintException** [ **-nested**] [ **-lines**] [\<*Exception object address*>]</span><span class="sxs-lookup"><span data-stu-id="46b76-344">**PrintException** [**-nested**] [**-lines**] [\<*Exception object address*>]</span></span><br /><br /> <span data-ttu-id="46b76-345">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="46b76-345">-or-</span></span><br /><br /> <span data-ttu-id="46b76-346">**PE** [ **-nested**] [\<*Exception object address*>]</span><span class="sxs-lookup"><span data-stu-id="46b76-346">**PE** [**-nested**] [\<*Exception object address*>]</span></span>|<span data-ttu-id="46b76-347">显示从指定地址处的 <xref:System.Exception> 类派生的任何对象的字段并设置这些字段的格式。</span><span class="sxs-lookup"><span data-stu-id="46b76-347">Displays and formats fields of any object derived from the <xref:System.Exception> class at the specified address.</span></span> <span data-ttu-id="46b76-348">如果不指定地址，**PrintException** 命令将显示在当前线程上引发的最后一个异常。</span><span class="sxs-lookup"><span data-stu-id="46b76-348">If you do not specify an address, the **PrintException** command displays the last exception thrown on the current thread.</span></span><br /><br /> <span data-ttu-id="46b76-349">**-nested** 选项显示有关嵌套异常对象的详细信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-349">The **-nested** option displays details about nested exception objects.</span></span><br /><br /> <span data-ttu-id="46b76-350">**-lines** 选项显示源信息（如果可用）。</span><span class="sxs-lookup"><span data-stu-id="46b76-350">The **-lines** option displays source information, if available.</span></span><br /><br /> <span data-ttu-id="46b76-351">可以使用此命令设置 `_stackTrace` 字段的格式并查看该字段（它是一个二进制数组）。</span><span class="sxs-lookup"><span data-stu-id="46b76-351">You can use this command to format and view the `_stackTrace` field, which is a binary array.</span></span>|
|<span data-ttu-id="46b76-352">**ProcInfo** [ **-env**] [ **-time**] [ **-mem**]</span><span class="sxs-lookup"><span data-stu-id="46b76-352">**ProcInfo** [**-env**] [**-time**] [**-mem**]</span></span>|<span data-ttu-id="46b76-353">显示进程的环境变量、内核 CPU 时间和内存使用统计信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-353">Displays environment variables for the process, kernel CPU time, and memory usage statistics.</span></span>|
|<span data-ttu-id="46b76-354">**RCWCleanupList** \<*RCWCleanupList address*></span><span class="sxs-lookup"><span data-stu-id="46b76-354">**RCWCleanupList** \<*RCWCleanupList address*></span></span>|<span data-ttu-id="46b76-355">显示在指定地址处等待清理的运行时可调用包装器的列表。</span><span class="sxs-lookup"><span data-stu-id="46b76-355">Displays the list of runtime callable wrappers at the specified address that are awaiting cleanup.</span></span>|
|<span data-ttu-id="46b76-356">**SaveModule** \<*Base address*> \<*Filename*></span><span class="sxs-lookup"><span data-stu-id="46b76-356">**SaveModule** \<*Base address*> \<*Filename*></span></span>|<span data-ttu-id="46b76-357">将加载到内存中指定地址的图像写入指定文件。</span><span class="sxs-lookup"><span data-stu-id="46b76-357">Writes an image, which is loaded in memory at the specified address, to the specified file.</span></span>|
|<span data-ttu-id="46b76-358">**SOSFlush**</span><span class="sxs-lookup"><span data-stu-id="46b76-358">**SOSFlush**</span></span>|<span data-ttu-id="46b76-359">刷新内部 SOS 缓存。</span><span class="sxs-lookup"><span data-stu-id="46b76-359">Flushes an internal SOS cache.</span></span>|
|<span data-ttu-id="46b76-360">**StopOnException** [ **-derived**] [ **-create** &#124; **-create2**] \<*Exception*> \<*Pseudo-register number*></span><span class="sxs-lookup"><span data-stu-id="46b76-360">**StopOnException** [**-derived**] [**-create** &#124; **-create2**] \<*Exception*> \<*Pseudo-register number*></span></span>|<span data-ttu-id="46b76-361">使调试器在引发指定异常时停止，但在引发其他异常时继续运行。</span><span class="sxs-lookup"><span data-stu-id="46b76-361">Causes the debugger to stop when the specified exception is thrown, but to continue running when other exceptions are thrown.</span></span><br /><br /> <span data-ttu-id="46b76-362">**-derived** 选项用于捕获指定异常以及从指定异常派生的每个异常。</span><span class="sxs-lookup"><span data-stu-id="46b76-362">The **-derived** option catches the specified exception and every exception that derives from the specified exception.</span></span>|
|<span data-ttu-id="46b76-363">**SyncBlk** [ **-all** &#124; \<*syncblk number*>]</span><span class="sxs-lookup"><span data-stu-id="46b76-363">**SyncBlk** [**-all** &#124; \<*syncblk number*>]</span></span>|<span data-ttu-id="46b76-364">显示指定的 `SyncBlock` 结构或所有 `SyncBlock` 结构。</span><span class="sxs-lookup"><span data-stu-id="46b76-364">Displays the specified `SyncBlock` structure or all `SyncBlock` structures.</span></span>  <span data-ttu-id="46b76-365">如果不传递任何自变量，**SyncBlk** 命令将显示与一个线程拥有的对象对应的 `SyncBlock` 结构。</span><span class="sxs-lookup"><span data-stu-id="46b76-365">If you do not pass any arguments, the **SyncBlk** command displays the `SyncBlock` structure corresponding to objects that are owned by a thread.</span></span><br /><br /> <span data-ttu-id="46b76-366">`SyncBlock` 结构是一个容器，用于存放无需为每个对象创建的额外信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-366">A `SyncBlock` structure is a container for extra information that does not need to be created for every object.</span></span> <span data-ttu-id="46b76-367">它可以存放 COM 互操作数据、哈希代码和用于线程安全操作的锁定信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-367">It can hold COM interop data, hash codes, and locking information for thread-safe operations.</span></span>|
|<span data-ttu-id="46b76-368">**ThreadPool**</span><span class="sxs-lookup"><span data-stu-id="46b76-368">**ThreadPool**</span></span>|<span data-ttu-id="46b76-369">显示有关托管线程池的信息，包括队列中工作请求的数目、完成端口线程的数目和计时器的数目。</span><span class="sxs-lookup"><span data-stu-id="46b76-369">Displays information about the managed thread pool, including the number of work requests in the queue, the number of completion port threads, and the number of timers.</span></span>|
|<span data-ttu-id="46b76-370">**Token2EE** \<*module name*> \<*token*></span><span class="sxs-lookup"><span data-stu-id="46b76-370">**Token2EE** \<*module name*> \<*token*></span></span>|<span data-ttu-id="46b76-371">将指定模块中的指定元数据标记转换成 `MethodTable` 结构或 `MethodDesc` 结构。</span><span class="sxs-lookup"><span data-stu-id="46b76-371">Turns the specified metadata token in the specified module into a `MethodTable` structure or `MethodDesc` structure.</span></span><br /><br /> <span data-ttu-id="46b76-372">可以传递 `*` 作为模块名参数，以便在每个已加载的托管模块中查找该标记映射到的内容。</span><span class="sxs-lookup"><span data-stu-id="46b76-372">You can pass `*` for the module name parameter to find what that token maps to in every loaded managed module.</span></span> <span data-ttu-id="46b76-373">也可以传递某个模块的调试器名称，如 `mscorlib` 或 `image00400000`。</span><span class="sxs-lookup"><span data-stu-id="46b76-373">You can also pass the debugger's name for a module, such as `mscorlib` or `image00400000`.</span></span>|
|<span data-ttu-id="46b76-374">**Threads** [ **-live**] [ **-special**]</span><span class="sxs-lookup"><span data-stu-id="46b76-374">**Threads** [**-live**] [**-special**]</span></span>|<span data-ttu-id="46b76-375">显示进程中的所有托管线程。</span><span class="sxs-lookup"><span data-stu-id="46b76-375">Displays all managed threads in the process.</span></span><br /><br /> <span data-ttu-id="46b76-376">Threads 命令显示调试程序速记 ID、CLR 线程 ID 以及操作系统线程 ID。</span><span class="sxs-lookup"><span data-stu-id="46b76-376">The **Threads** command displays the debugger shorthand ID, the CLR thread ID, and the operating system thread ID.</span></span>  <span data-ttu-id="46b76-377">此外，**Threads** 命令还会显示“Domain”列、“APT”列和“Exception”列，这三列分别用于指示正在执行某线程的应用程序域、显示 COM 单元模式以及显示该线程中引发的上一个异常。</span><span class="sxs-lookup"><span data-stu-id="46b76-377">Additionally, the **Threads** command displays a Domain column that indicates the application domain in which a thread is executing, an APT column that displays the COM apartment mode, and an Exception column that displays the last exception thrown in the thread.</span></span><br /><br /> <span data-ttu-id="46b76-378">**-live** 选项显示与活动线程关联的线程。</span><span class="sxs-lookup"><span data-stu-id="46b76-378">The **-live** option displays threads associated with a live thread.</span></span><br /><br /> <span data-ttu-id="46b76-379"> 选项显示由 CLR 创建的所有特殊线程。</span><span class="sxs-lookup"><span data-stu-id="46b76-379">The **-special** option displays all special threads created by the CLR.</span></span> <span data-ttu-id="46b76-380">特殊线程包括垃圾回收线程（在并发垃圾回收和服务器垃圾回收中）、调试器帮助程序线程、终结器线程、<xref:System.AppDomain> 卸载线程和线程池计时器线程。</span><span class="sxs-lookup"><span data-stu-id="46b76-380">Special threads include garbage collection threads (in concurrent and server garbage collection), debugger helper threads, finalizer threads, <xref:System.AppDomain> unload threads, and thread pool timer threads.</span></span>|
|<span data-ttu-id="46b76-381">**ThreadState \<** *State value field* **>**</span><span class="sxs-lookup"><span data-stu-id="46b76-381">**ThreadState \<** *State value field* **>**</span></span>|<span data-ttu-id="46b76-382">显示线程的状态。</span><span class="sxs-lookup"><span data-stu-id="46b76-382">Displays the state of the thread.</span></span> <span data-ttu-id="46b76-383">`value` 参数为 **Threads** 报告输出中的 `State` 字段的值。</span><span class="sxs-lookup"><span data-stu-id="46b76-383">The `value` parameter is the value of the `State` field in the **Threads** report output.</span></span><br /><br /> <span data-ttu-id="46b76-384">示例：</span><span class="sxs-lookup"><span data-stu-id="46b76-384">Example:</span></span><br /><br /> `0:003> !Threads     ThreadCount:      2     UnstartedThread:  0     BackgroundThread: 1     PendingThread:    0     DeadThread:       0     Hosted Runtime:   no                                           PreEmptive   GC Alloc           Lock            ID OSID ThreadOBJ    State     GC       Context       Domain   Count APT Exception        0    1  250 0019b068      a020 Disabled 02349668:02349fe8 0015def0     0 MTA        2    2  944 001a6020      b220 Enabled  00000000:00000000 0015def0     0 MTA (Finalizer)     0:003> !ThreadState b220         Legal to Join         Background         CLR Owns         CoInitialized         In Multi Threaded Apartment`|
|<span data-ttu-id="46b76-385">**TraverseHeap** [ **-xml**] \<*filename*></span><span class="sxs-lookup"><span data-stu-id="46b76-385">**TraverseHeap** [**-xml**] \<*filename*></span></span>|<span data-ttu-id="46b76-386">以 CLR 探查器能够识别的格式将堆信息写入指定文件。</span><span class="sxs-lookup"><span data-stu-id="46b76-386">Writes heap information to the specified file in a format understood by the CLR profiler.</span></span> <span data-ttu-id="46b76-387">**-xml** 选项使 **TraverseHeap** 命令将文件格式化为 XML。</span><span class="sxs-lookup"><span data-stu-id="46b76-387">The **-xml** option causes the **TraverseHeap** command to format the file as XML.</span></span><br /><br /> <span data-ttu-id="46b76-388">可以从 [Microsoft 下载中心](https://go.microsoft.com/fwlink/?LinkID=67325)下载 CLR 探查器。</span><span class="sxs-lookup"><span data-stu-id="46b76-388">You can download the CLR Profiler from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?LinkID=67325).</span></span>|
|<span data-ttu-id="46b76-389">**U** [ **-gcinfo**] [ **-ehinfo**] [ **-n**] \<*MethodDesc address*> &#124; \<*Code address*></span><span class="sxs-lookup"><span data-stu-id="46b76-389">**U** [**-gcinfo**] [**-ehinfo**] [**-n**] \<*MethodDesc address*> &#124; \<*Code address*></span></span>|<span data-ttu-id="46b76-390">显示由方法的 `MethodDesc` 结构指针或方法体内的代码地址指定的托管方法的反汇编（带有批注）。</span><span class="sxs-lookup"><span data-stu-id="46b76-390">Displays an annotated disassembly of a managed method specified either by a `MethodDesc` structure pointer for the method or by a code address within the method body.</span></span> <span data-ttu-id="46b76-391">**U** 命令将从开始到结束显示整个方法，并带有将元数据标记转换为名称的批注。</span><span class="sxs-lookup"><span data-stu-id="46b76-391">The **U** command displays the entire method from start to finish, with annotations that convert metadata tokens to names.</span></span><br /><br /> <span data-ttu-id="46b76-392">**-gcinfo** 选项使 **U** 命令显示方法的 `GCInfo` 结构。</span><span class="sxs-lookup"><span data-stu-id="46b76-392">The **-gcinfo** option causes the **U** command to display the `GCInfo` structure for the method.</span></span><br /><br /> <span data-ttu-id="46b76-393">**-ehinfo** 选项显示方法的异常信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-393">The **-ehinfo** option displays exception information for the method.</span></span> <span data-ttu-id="46b76-394">也可以使用 **EHInfo** 命令获取此信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-394">You can also obtain this information with the **EHInfo** command.</span></span><br /><br /> <span data-ttu-id="46b76-395">**-n** 选项禁止显示源文件名和行号。</span><span class="sxs-lookup"><span data-stu-id="46b76-395">The **-n** option disables the display of source file names and line numbers.</span></span> <span data-ttu-id="46b76-396">如果调试器已指定选项 SYMOPT_LOAD_LINES，则 SOS 将查找每个托管帧的符号，如果成功，则将显示对应的源文件名和行号。</span><span class="sxs-lookup"><span data-stu-id="46b76-396">If the debugger has the option SYMOPT_LOAD_LINES specified, SOS looks up the symbols for every managed frame and, if successful, displays the corresponding source file name and line number.</span></span> <span data-ttu-id="46b76-397">可以指定 **-n** 选项来禁用此行为。</span><span class="sxs-lookup"><span data-stu-id="46b76-397">You can specify the **-n** option to disable this behavior.</span></span>|
|<span data-ttu-id="46b76-398">**VerifyHeap**</span><span class="sxs-lookup"><span data-stu-id="46b76-398">**VerifyHeap**</span></span>|<span data-ttu-id="46b76-399">检查垃圾回收器堆中是否有损坏迹象，并显示找到的任何错误。</span><span class="sxs-lookup"><span data-stu-id="46b76-399">Checks the garbage collector heap for signs of corruption and displays any errors found.</span></span><br /><br /> <span data-ttu-id="46b76-400">错误构造的平台调用可能导致堆损坏。</span><span class="sxs-lookup"><span data-stu-id="46b76-400">Heap corruptions can be caused by platform invoke calls that are constructed incorrectly.</span></span>|
|<span data-ttu-id="46b76-401">**VerifyObj** \<*object address*></span><span class="sxs-lookup"><span data-stu-id="46b76-401">**VerifyObj** \<*object address*></span></span>|<span data-ttu-id="46b76-402">检查作为自变量传递的对象是否有损坏迹象。</span><span class="sxs-lookup"><span data-stu-id="46b76-402">Checks the object that is passed as an argument for signs of corruption.</span></span>|
|<span data-ttu-id="46b76-403">**VMMap**</span><span class="sxs-lookup"><span data-stu-id="46b76-403">**VMMap**</span></span>|<span data-ttu-id="46b76-404">遍历虚拟地址空间并显示应用于每个区域的保护类型。</span><span class="sxs-lookup"><span data-stu-id="46b76-404">Traverses the virtual address space and displays the type of protection applied to each region.</span></span>|
|<span data-ttu-id="46b76-405">**VMStat**</span><span class="sxs-lookup"><span data-stu-id="46b76-405">**VMStat**</span></span>|<span data-ttu-id="46b76-406">提供虚拟地址空间的摘要视图，并按应用于该内存的每种保护类型（可用、已保留、已提交、私有、已映射和映像）排序。</span><span class="sxs-lookup"><span data-stu-id="46b76-406">Provides a summary view of the virtual address space, ordered by each type of protection applied to that memory (free, reserved, committed, private, mapped, image).</span></span> <span data-ttu-id="46b76-407">“TOTAL”列显示“AVERAGE”列乘以“BLK COUNT”列的结果。</span><span class="sxs-lookup"><span data-stu-id="46b76-407">The TOTAL column displays the result of the AVERAGE column multiplied by the BLK COUNT column.</span></span>|

## <a name="remarks"></a><span data-ttu-id="46b76-408">备注</span><span class="sxs-lookup"><span data-stu-id="46b76-408">Remarks</span></span>

<span data-ttu-id="46b76-409">SOS 调试扩展允许你查看有关在 CLR 内运行的代码的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-409">The SOS Debugging Extension lets you view information about code that is running inside the CLR.</span></span> <span data-ttu-id="46b76-410">例如，可以使用 SOS 调试扩展显示有关托管堆的信息、查找堆损坏情况、显示运行时所使用的内部数据类型以及查看有关在运行时内运行的所有托管代码的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-410">For example, you can use the SOS Debugging Extension to display information about the managed heap, look for heap corruptions, display internal data types used by the runtime, and view information about all managed code running inside the runtime.</span></span>

<span data-ttu-id="46b76-411">若要在 Visual Studio 中使用 SOS 调试扩展，请安装 [Windows 驱动程序工具包 (WDK)](/windows-hardware/drivers/download-the-wdk)。</span><span class="sxs-lookup"><span data-stu-id="46b76-411">To use the SOS Debugging Extension in Visual Studio, install the [Windows Driver Kit (WDK)](/windows-hardware/drivers/download-the-wdk).</span></span> <span data-ttu-id="46b76-412">有关 Visual Studio 中的集成调试环境的信息，请参阅[调试环境](/windows-hardware/drivers/debugger/debuggers-in-the-debugging-tools-for-windows-package)。</span><span class="sxs-lookup"><span data-stu-id="46b76-412">For information about the integrated debugging environment in Visual Studio, see [Debugging Environments](/windows-hardware/drivers/debugger/debuggers-in-the-debugging-tools-for-windows-package).</span></span>

<span data-ttu-id="46b76-413">还可以通过将 SOS 调试扩展加载到 [WinDbg.exe 调试器](/windows-hardware/drivers/debugger/debugger-download-tools)中并在 WinDbg.exe 中执行命令来使用此扩展。</span><span class="sxs-lookup"><span data-stu-id="46b76-413">You can also use the SOS Debugging Extension by loading it into the [WinDbg.exe debugger](/windows-hardware/drivers/debugger/debugger-download-tools) and executing commands within WinDbg.exe.</span></span>

<span data-ttu-id="46b76-414">若要将 SOS 调试扩展加载到 WinDbg.exe 调试器中，请在工具中运行以下命令：</span><span class="sxs-lookup"><span data-stu-id="46b76-414">To load the SOS Debugging Extension into the WinDbg.exe debugger, run the following command in the tool:</span></span>

```console
.loadby sos clr
```

<span data-ttu-id="46b76-415">WinDbg.exe 和 Visual Studio 使用与当前使用的 Mscorwks.dll 版本对应的 SOS.dll 版本。</span><span class="sxs-lookup"><span data-stu-id="46b76-415">WinDbg.exe and Visual Studio use a version of SOS.dll that corresponds to the version of Mscorwks.dll currently in use.</span></span> <span data-ttu-id="46b76-416">默认情况下，应使用与当前版本的 Mscorwks.dll 匹配的 SOS.dll 版本。</span><span class="sxs-lookup"><span data-stu-id="46b76-416">By default, you should use the version of SOS.dll that matches the current version of Mscorwks.dll.</span></span>

<span data-ttu-id="46b76-417">若要使用在其他计算机上创建的转储文件，请确保该安装所附带的 Mscorwks.dll 文件存在于符号路径中，并加载相应的 SOS.dll 版本。</span><span class="sxs-lookup"><span data-stu-id="46b76-417">To use a dump file created on another computer, make sure that the Mscorwks.dll file that came with that installation is in your symbol path, and load the corresponding version of SOS.dll.</span></span>

<span data-ttu-id="46b76-418">若要加载特定版本的 SOS.dll，请在 Windows 调试器中键入以下命令：</span><span class="sxs-lookup"><span data-stu-id="46b76-418">To load a specific version of SOS.dll, type the following command into the Windows Debugger:</span></span>

```console
.load <full path to sos.dll>
```

## <a name="examples"></a><span data-ttu-id="46b76-419">示例</span><span class="sxs-lookup"><span data-stu-id="46b76-419">Examples</span></span>

<span data-ttu-id="46b76-420">下面的命令显示在地址 `00ad28d0` 处的数组内容。</span><span class="sxs-lookup"><span data-stu-id="46b76-420">The following command displays the contents of an array at the address `00ad28d0`.</span></span>  <span data-ttu-id="46b76-421">显示从第二个元素开始，连续显示五个元素。</span><span class="sxs-lookup"><span data-stu-id="46b76-421">The display starts from the second element and continues for five elements.</span></span>

```console
!dumparray -start 2 -length 5 -detail 00ad28d0
```

<span data-ttu-id="46b76-422">下面的命令显示在地址 `1ca248` 处的程序集的内容。</span><span class="sxs-lookup"><span data-stu-id="46b76-422">The following command displays the contents of an assembly at the address `1ca248`.</span></span>

```console
!dumpassembly 1ca248
```

<span data-ttu-id="46b76-423">下面的命令显示有关垃圾回收器堆的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-423">The following command displays information about the garbage collector heap.</span></span>

```console
!dumpheap
```

<span data-ttu-id="46b76-424">下面的命令将内存中压力日志的内容写入到当前目录中名为 StressLog.txt 的（默认）文件中。</span><span class="sxs-lookup"><span data-stu-id="46b76-424">The following command writes the contents of the in-memory stress log to a (default) file called StressLog.txt in the current directory.</span></span>

```console
!DumpLog
```

<span data-ttu-id="46b76-425">下面的命令显示在地址 `MethodDesc` 处的 `902f40` 结构。</span><span class="sxs-lookup"><span data-stu-id="46b76-425">The following command displays the `MethodDesc` structure at the address `902f40`.</span></span>

```console
!dumpmd 902f40
```

<span data-ttu-id="46b76-426">下面的命令显示有关地址 `1caa50` 处的模块的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-426">The following command displays information about a module at the address `1caa50`.</span></span>

```console
!dumpmodule 1caa50
```

<span data-ttu-id="46b76-427">下面的命令显示有关地址 `a79d40` 处的对象的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-427">The following command displays information about an object at the address `a79d40`.</span></span>

```console
!DumpObj a79d40
```

<span data-ttu-id="46b76-428">下面的命令使用地址 `00a79d9c` 处的方法表显示地址 `0090320c` 处的值类的字段。</span><span class="sxs-lookup"><span data-stu-id="46b76-428">The following command displays the fields of a value class at the address `00a79d9c` using the method table at the address `0090320c`.</span></span>

```console
!DumpVC 0090320c 00a79d9c
```

<span data-ttu-id="46b76-429">下面的命令显示垃圾回收器所使用的进程内存。</span><span class="sxs-lookup"><span data-stu-id="46b76-429">The following command displays the process memory used by the garbage collector.</span></span>

```console
!eeheap -gc
```

<span data-ttu-id="46b76-430">下面的命令显示所有已做好终结计划的对象。</span><span class="sxs-lookup"><span data-stu-id="46b76-430">The following command displays all objects scheduled for finalization.</span></span>

```console
!finalizequeue
```

<span data-ttu-id="46b76-431">下面的命令确定地址 `00a79d98` 处的对象的应用程序域。</span><span class="sxs-lookup"><span data-stu-id="46b76-431">The following command determines the application domain of an object at the address `00a79d98`.</span></span>

```console
!findappdomain 00a79d98
```

<span data-ttu-id="46b76-432">下面的命令显示当前进程中的所有垃圾回收器句柄。</span><span class="sxs-lookup"><span data-stu-id="46b76-432">The following command displays all garbage collector handles in the current process.</span></span>

```console
!gcinfo 5b68dbb8
```

<span data-ttu-id="46b76-433">下面的命令显示模块 `MethodTable` 的类 `EEClass` 中的 `Main` 方法的 `MainClass` 和 `unittest.exe` 结构。</span><span class="sxs-lookup"><span data-stu-id="46b76-433">The following command displays the `MethodTable` and `EEClass` structures for the `Main` method in the class `MainClass` in the module `unittest.exe`.</span></span>

```console
!name2ee unittest.exe MainClass.Main
```

<span data-ttu-id="46b76-434">下面的命令显示有关模块 `02000003` 中的地址 `unittest.exe` 处的元数据标记的信息。</span><span class="sxs-lookup"><span data-stu-id="46b76-434">The following command displays information about the metadata token at the address `02000003` in the module `unittest.exe`.</span></span>

```console
!token2ee unittest.exe 02000003
```

## <a name="see-also"></a><span data-ttu-id="46b76-435">请参阅</span><span class="sxs-lookup"><span data-stu-id="46b76-435">See also</span></span>

- [<span data-ttu-id="46b76-436">工具</span><span class="sxs-lookup"><span data-stu-id="46b76-436">Tools</span></span>](index.md)
- [<span data-ttu-id="46b76-437">开发人员命令行 shell</span><span class="sxs-lookup"><span data-stu-id="46b76-437">Developer command-line shells</span></span>](/visualstudio/ide/reference/command-prompt-powershell)
